#!/bin/sh

set -e

require_pick_to_be_installed() {
  command -v pick >/dev/null 2>&1 || {
    echo >&2 "pick(1) is not installed."
      exit 78
    }
}

if [ -n "$(git status --porcelain)" ]; then
  if [ -t 1 ]; then
    require_pick_to_be_installed

    git status --porcelain | pick | cut -c 4-
  else
    git status --porcelain | cut -c 4-
  fi
else
  if [ -t 1 ]; then
    require_pick_to_be_installed

    git diff origin/master..HEAD --name-status --diff-filter=d | \
      awk '{ print $NF }' | \
      pick
        else
          git diff origin/master..HEAD --name-status --diff-filter=d | awk '{ print $NF }'
        fi
      fi
