{"id":".dotfiles-0b9","title":"Fix notification database schema mismatch - missing 'action_taken' column in getRecent query","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-27T18:38:53.406366-05:00","updated_at":"2025-12-27T18:43:23.305967-05:00","closed_at":"2025-12-27T18:43:23.305967-05:00","close_reason":"Closed","labels":["database","hammerspoon"]}
{"id":".dotfiles-1aq","title":"Design multi-agent coordination protocol","description":"Define protocols for multiple AI agents working simultaneously:\n\nScenarios to Handle:\n1. **Multiple Claude Code instances** on same machine\n2. **Parallel task execution** by same agent (Task tool subagents)\n3. **Sequential handoff** between agent sessions\n\nCoordination Mechanisms:\n1. **Lock files** - .jj-workspaces/$NAME.lock with PID\n   - Check before starting work\n   - Release on session end\n   - Stale lock detection\n\n2. **Bead task claiming** - bd update --status=in_progress --assignee=agent-1\n   - Prevents double-claiming\n   - Visible to other agents via bd list\n\n3. **Workspace reservation** - Metadata in workspace\n   - Who's working here?\n   - What task?\n   - Session start time\n\n4. **Conflict detection** - Pre-work check\n   - Are other workspaces touching same files?\n   - jj diff comparison across workspaces\n\n5. **Communication channel** - Shared state file\n   - .jj-workspaces/coordination.json\n   - Agent intents and status\n\nImplementation should be lightweight - agents can coordinate without heavy infrastructure.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-29T08:45:25.789508-05:00","updated_at":"2025-12-29T08:45:25.789508-05:00","labels":["ai-workflow","concurrency","workspace"],"dependencies":[{"issue_id":".dotfiles-1aq","depends_on_id":".dotfiles-20n","type":"blocks","created_at":"2025-12-29T08:45:25.799324-05:00","created_by":"daemon"}]}
{"id":".dotfiles-1ic","title":"Create Hammerspoon reload cleanup hook","description":"Add a central cleanup mechanism in init.lua that calls cleanup() on all modules before hs.reload(). Modules should register their cleanup functions. This ensures watchers, timers, and canvases are properly released.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T18:03:13.560943-05:00","updated_at":"2025-12-27T18:03:13.560943-05:00","labels":["architecture","hammerspoon","memory-leak"]}
{"id":".dotfiles-1rd","title":"Standardize module pattern across Hammerspoon config","description":"Inconsistent module patterns: some use 'local M = {}', others use 'local obj = {}' with unused __index. Standardize on simple 'local M = {}' pattern without unnecessary metatable setup. Remove unused M.__index and M.name declarations.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-27T18:02:43.284235-05:00","updated_at":"2025-12-27T18:02:43.284235-05:00","labels":["code-quality","hammerspoon"]}
{"id":".dotfiles-20n","title":"JJ Workspaces + Bead Workflow for Concurrent AI Agent Development","description":"Enable concurrent AI agent and developer workflows using jj workspaces for VCS isolation and bead for task coordination. This epic addresses:\n\n1. **JJ Workspace Infrastructure** - Set up workspace management patterns for this repo and provide reusable patterns for other repos\n2. **Bead Integration** - Establish conventions for workspace-specific bead epics/tasks and cross-workspace synchronization  \n3. **AI Agent Workflow Rules** - Define clear protocols for agents operating in workspaces to avoid conflicts\n4. **Developer Experience** - Scripts, aliases, and documentation to make workspace workflows frictionless\n\nKey Goals:\n- Multiple AI agents can work concurrently without stomping on each other's changes\n- Each workspace gets its own bead epic/task context\n- Clear handoff protocols between workspaces and agents\n- Easy workspace lifecycle management (create, work, merge, cleanup)\n\nResearch Complete: See _docs/jj-workspaces-research.md for comprehensive findings on jj workspace architecture, lock-free concurrency model, conflict handling, and best practices.","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-29T08:43:32.746854-05:00","updated_at":"2025-12-29T08:43:32.746854-05:00","labels":["ai-workflow","bead","concurrency","epic","jj"]}
{"id":".dotfiles-32b","title":"Fix inconsistent EDITOR/VISUAL/JJ_EDITOR configuration","description":"Editor environment variables are configured in multiple conflicting places, causing tools like jj to fail when opening editors.\n\nCurrent State (broken):\n- EDITOR=nvim (just binary name)\n- VISUAL=/nix/store/.../nvim (full nix path)\n- JJ_EDITOR=(empty)\n- GIT_EDITOR=$EDITOR\n\nSources of Conflict:\n1. hosts/megabookpro.nix:61-63 - Sets EDITOR to pkgs.nvim-nightly/bin/nvim\n2. home/zsh/lib/env.zsh:93 - Sets EDITOR='nvim -O' (with -O flag!)\n3. home/programs/nvim.nix:42 - defaultEditor = true (may also set things)\n4. JJ_EDITOR - Never explicitly set\n\nProblem Discovered:\n- jj split failed because editor didn't work properly\n- Concurrent AI agent changes got wrong commit messages\n- nvim client/server mode (from notes system) may have changed expected behavior\n\nRequired Fix:\n1. Consolidate editor config in ONE place (probably nix)\n2. Remove conflicting zsh env.zsh EDITOR override\n3. Set JJ_EDITOR explicitly (may need different behavior than git)\n4. Test that all tools work: jj, git, bd, fish edit_command_buffer\n5. Ensure nvim client/server mode doesn't break interactive editing\n\nRelated: Notes \u0026 Capture system may have changed nvim startup behavior","status":"open","priority":1,"issue_type":"bug","created_at":"2025-12-29T08:54:57.499263-05:00","updated_at":"2025-12-29T08:54:57.499263-05:00","labels":["bug","dx","jj","nix","nvim"]}
{"id":".dotfiles-3ra","title":"Remove duplicate logging in notification hot path","description":"In notification.lua:382-388, both print() and U.log.nf() are called on every notification with similar format strings. Remove the print() call or consolidate to single logging approach.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-27T18:03:01.739539-05:00","updated_at":"2025-12-27T18:03:01.739539-05:00","labels":["hammerspoon","performance"]}
{"id":".dotfiles-4el","title":"Configure Hammerspoon PATH for Nix/Homebrew binaries","description":"Hammerspoon doesn't inherit shell PATH, requiring absolute paths to binaries (nvim, kitty, ghostty). Find a clean solution to inject Nix/Homebrew paths so we can use simple binary names instead of hardcoded paths like /opt/homebrew/bin/kitty or /run/current-system/sw/bin/nvim.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T11:10:46.837799-05:00","updated_at":"2025-12-26T12:23:12.803943-05:00","closed_at":"2025-12-26T12:23:12.803943-05:00","close_reason":"Implemented PATH injection via monkey-patched hs.task.new in overrides.lua. Nix generates nix_path.lua to ~/.local/share/hammerspoon/ on darwin-rebuild.","labels":["dx","hammerspoon","nix","path"]}
{"id":".dotfiles-5lx","title":"Fix obsidian.nvim deprecation warnings and API changes","description":"Fixed multiple issues: 1) Deprecated 'mappings' config replaced with 'callbacks.enter_note', 2) util module replaced with api module, 3) cursor_on_markdown_link() replaced with api.cursor_link(), 4) Added gr keybinding that works on frontmatter tags and body tags","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T17:06:58.233137-05:00","updated_at":"2025-12-27T17:07:03.819703-05:00","closed_at":"2025-12-27T17:07:03.819703-05:00","close_reason":"Fixed in config/nvim/lua/plugins/obsidian.lua and config/nvim/after/plugin/notes.lua","labels":["nvim","obsidian"]}
{"id":".dotfiles-5vb","title":"Add consistent error handling to pcall patterns","description":"Some pcall() calls properly check return values, others ignore them entirely. Example: notifier.lua:143 uses pcall without checking success. Standardize on 'local ok, err = pcall(...)' pattern and handle errors.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-27T18:02:45.083377-05:00","updated_at":"2025-12-27T18:02:45.083377-05:00","labels":["error-handling","hammerspoon"]}
{"id":".dotfiles-5y6","title":"Create bead-workspace integration pattern","description":"Design and implement patterns for integrating bead issue tracking with jj workspaces:\n\nCore Pattern:\n- Each workspace can be associated with a bead epic or task\n- Workspace creation can auto-create/link to bead task\n- Workspace cleanup can update bead task status\n\nImplementation Ideas:\n1. **Workspace metadata file**: .jj-workspace-bead.json in workspace root\n   - Contains linked bead issue ID\n   - Auto-updated by jj-ws-* scripts\n\n2. **Bead workspace label**: Add 'workspace:$NAME' label to tasks\n   - Easy filtering: bd list --labels='workspace:agent-1'\n\n3. **Auto-context injection**: bd prime could include workspace-specific context\n   - Which workspace am I in?\n   - What's my assigned task?\n\n4. **Cross-workspace task visibility**: \n   - bd list should work from any workspace\n   - Show workspace assignments in output\n\nResearch needed:\n- How does bead handle multiple concurrent readers/writers?\n- Does bead need sandbox mode in workspaces?","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-29T08:44:32.922278-05:00","updated_at":"2025-12-29T08:44:32.922278-05:00","labels":["bead","integration","jj","workspace"],"dependencies":[{"issue_id":".dotfiles-5y6","depends_on_id":".dotfiles-20n","type":"blocks","created_at":"2025-12-29T08:44:32.933147-05:00","created_by":"daemon"}]}
{"id":".dotfiles-6bp","title":"[Phase 5] Add window position persistence","description":"Save/restore notes window position via hs.settings. Handle multi-monitor and off-screen scenarios.","status":"open","priority":3,"issue_type":"task","estimated_minutes":30,"created_at":"2025-12-26T10:35:59.656222-05:00","updated_at":"2025-12-26T10:35:59.656222-05:00","labels":["hammerspoon","phase-5","polish"],"dependencies":[{"issue_id":".dotfiles-6bp","depends_on_id":".dotfiles-ca8","type":"blocks","created_at":"2025-12-26T10:35:59.657071-05:00","created_by":"daemon"},{"issue_id":".dotfiles-6bp","depends_on_id":".dotfiles-ckn","type":"blocks","created_at":"2025-12-26T20:54:09.752167-05:00","created_by":"daemon"}]}
{"id":".dotfiles-6ct","title":"Handle colocated repo workspace limitations","description":"Address known issues with jj workspaces in colocated (jj+git) repos:\n\nKnown Issues:\n1. **Secondary workspaces lack .git file** - Tools expecting git repos may fail\n2. **git commands don't work in secondary workspaces** - Must use jj only\n3. **IDE git integrations can cause stale workspaces** - Background fetches\n4. **Performance degrades with many git refs** - Need periodic jj util gc\n\nPotential Mitigations:\n1. **Disable IDE git in workspace dirs** - .vscode/settings.json, etc.\n2. **Create wrapper scripts** that warn about git usage\n3. **Add pre-command hook** to check for git command usage in workspaces\n4. **Document which tools need git** and alternatives\n\nResearch:\n- Is there a way to create .git file for secondary workspaces? (jj discussion #6286)\n- Can we symlink or stub the .git for compatibility?\n\nThis may require accepting limitations rather than full solutions.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-29T08:45:00.830762-05:00","updated_at":"2025-12-29T08:45:00.830762-05:00","labels":["git","jj","workaround","workspace"],"dependencies":[{"issue_id":".dotfiles-6ct","depends_on_id":".dotfiles-20n","type":"blocks","created_at":"2025-12-29T08:45:00.841606-05:00","created_by":"daemon"}]}
{"id":".dotfiles-7dz","title":"Define workspace naming conventions and directory structure","description":"Establish clear conventions for workspace organization:\n\nNaming Pattern: $REPO-$PURPOSE[-$AGENT]\nExamples:\n- dotfiles-auth-refactor\n- dotfiles-test-runner\n- dotfiles-agent-1\n- dotfiles-docs-update\n\nDirectory Structure:\n- Main workspace: ~/.dotfiles (contains .jj/store/)\n- Secondary workspaces: ~/.dotfiles-$NAME (siblings, not children!)\n\nWhy siblings not children:\n- Avoids nested workspace footgun (jj issue #6102)\n- Cleaner separation\n- Some tools scan subdirectories\n\nReserved names:\n- 'main' or 'default' for primary workspace\n- 'ci-*' for CI/CD workspaces\n- 'agent-*' for AI agent workspaces\n\nDocument in CLAUDE.md for AI agents to follow.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-29T08:44:30.588357-05:00","updated_at":"2025-12-29T08:44:30.588357-05:00","labels":["conventions","documentation","jj","workspace"],"dependencies":[{"issue_id":".dotfiles-7dz","depends_on_id":".dotfiles-20n","type":"blocks","created_at":"2025-12-29T08:44:30.59899-05:00","created_by":"daemon"}]}
{"id":".dotfiles-8a7","title":"Extend Hammerspoon env injection for NOTES_HOME","description":"Extended nix_path.lua to export NIX_ENV table with critical env vars (NOTES_HOME, OBSIDIAN_HOME, NVIM_DB_HOME, DOTS, XDG_*). Updated overrides.lua to inject these into spawned processes. Fixes nvim config errors when launched via Hammerspoon hotkeys.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T17:06:46.105735-05:00","updated_at":"2025-12-27T17:06:51.241449-05:00","closed_at":"2025-12-27T17:06:51.241449-05:00","close_reason":"Implemented in home/default.nix, overrides.lua, and preflight.lua","labels":["env","hammerspoon","nix"]}
{"id":".dotfiles-8uo","title":"[Phase 3] Create nvim autocmd for daily note linking","description":"BufWritePost autocmd for captures/ files. Skip empty files. Append wikilink to daily note ## Captures section.\n\nImplementation complete - pending questions before final test:\n- Different separators in description? (currently using \" Â· \")\n- Include timestamp in description?\n- Truncate description at different length? (currently 60 chars)\n- Different fallback text? (currently \"Text capture\")","status":"closed","priority":2,"issue_type":"task","estimated_minutes":45,"created_at":"2025-12-26T10:35:59.457437-05:00","updated_at":"2025-12-26T17:41:02.320001-05:00","closed_at":"2025-12-26T17:41:02.320001-05:00","close_reason":"Implemented and tested. Fixed language detection, added source context to frontmatter, smart filenames, duplicate prevention, and simplified image capture entries.","labels":["nvim","obsidian","phase-3"],"dependencies":[{"issue_id":".dotfiles-8uo","depends_on_id":".dotfiles-wpc","type":"blocks","created_at":"2025-12-26T10:35:59.458333-05:00","created_by":"daemon"}]}
{"id":".dotfiles-91b","title":"Remove dead code from bindings.lua","description":"bindings.lua has ~200 lines of commented-out code (lines 151-192, 449-480, 485-641). Delete these blocks to improve maintainability. Also remove unused assertKeyAvailable function at line 662.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T18:02:31.980637-05:00","updated_at":"2025-12-27T18:02:31.980637-05:00","labels":["cleanup","code-quality","hammerspoon"]}
{"id":".dotfiles-a1f","title":"Create jj workspace shell integration (prompt/statusline)","description":"Enhance shell prompt/statusline to show workspace context:\n\nCurrent State:\n- Statusline shows jj bookmark and change_id\n- No indication of which workspace\n\nDesired State:\n- Show workspace name when not in default workspace\n- Show stale indicator if workspace is stale\n- Show linked bead task ID\n\nImplementation Options:\n1. **Starship prompt module** - If using starship\n2. **Custom shell function** - For prompt PS1\n3. **Hammerspoon statusline** - Already have jj integration\n\nFormat suggestion: jj:workspace-name@bookmark* (change_id)\nExample: jj:agent-1@feat-auth* (abc123)\n\nAlso consider:\n- Color coding for workspace state (normal, stale, conflicted)\n- Quick command to show full workspace info","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-29T08:45:02.37166-05:00","updated_at":"2025-12-29T08:45:02.37166-05:00","labels":["dx","jj","shell","workspace"],"dependencies":[{"issue_id":".dotfiles-a1f","depends_on_id":".dotfiles-20n","type":"blocks","created_at":"2025-12-29T08:45:02.382114-05:00","created_by":"daemon"}]}
{"id":".dotfiles-b3r","title":"Improve function naming for clarity","description":"Several unclear function names: M.toggle() - toggle what?; findWindowByTitle() returns single window not list; tableCount() should use stdlib. Rename for intention-revealing names per clean code principles.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-27T18:03:00.429094-05:00","updated_at":"2025-12-27T18:03:00.429094-05:00","labels":["code-quality","hammerspoon"]}
{"id":".dotfiles-bww","title":"Fix nested timer accumulation in dismissNotification","description":"In notifier.lua:279-301, nested hs.timer.doAfter inside doUntil can orphan timers when dismissNotification is called rapidly. Store reference and cancel previous before creating new. Location: lib/notifications/notifier.lua dismissNotification()","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-27T18:02:17.898907-05:00","updated_at":"2025-12-27T18:02:17.898907-05:00","labels":["hammerspoon","memory-leak"]}
{"id":".dotfiles-c4d","title":"Create workspace management scripts (jj-ws-*)","description":"Create helper scripts for common workspace operations:\n\nScripts needed:\n1. **jj-ws-new** - Create new workspace with standard naming/location\n   - Args: workspace-name, optional base-revision\n   - Creates at ../$REPO-$NAME (outside repo tree to avoid issues)\n   - Sets up bead context for the workspace\n   \n2. **jj-ws-list** - Enhanced workspace listing\n   - Shows workspace name, path, current commit, stale status\n   - Integrates with bead to show associated epic/task\n   \n3. **jj-ws-cleanup** - Clean up completed workspace\n   - Forgets workspace\n   - Removes directory\n   - Updates bead task status if linked\n\n4. **jj-ws-switch** - Quick workspace switching\n   - Tab completion for workspace names\n   - Updates shell prompt/statusline\n\nLocation: ~/bin/ (already in PATH via nix)","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-29T08:44:29.43327-05:00","updated_at":"2025-12-29T08:44:29.43327-05:00","labels":["dx","jj","scripts","workspace"],"dependencies":[{"issue_id":".dotfiles-c4d","depends_on_id":".dotfiles-20n","type":"blocks","created_at":"2025-12-29T08:44:29.443536-05:00","created_by":"daemon"}]}
{"id":".dotfiles-ca8","title":"[Phase 3] Verify obsidian.nvim backlinks work","description":"Test obsidian.nvim backlinks between capture notes and daily notes. Verify navigation works.","status":"closed","priority":2,"issue_type":"task","estimated_minutes":15,"created_at":"2025-12-26T10:35:59.557261-05:00","updated_at":"2025-12-26T20:50:13.101087-05:00","closed_at":"2025-12-26T20:50:13.101087-05:00","close_reason":"Verified and enhanced. Added note_frontmatter_func to preserve capture metadata, picker tag mappings, smart gf/\u003ccr\u003e mappings, and unified gr keybinding for tags/links/LSP references.","labels":["nvim","obsidian","phase-3"],"dependencies":[{"issue_id":".dotfiles-ca8","depends_on_id":".dotfiles-8uo","type":"blocks","created_at":"2025-12-26T10:35:59.558086-05:00","created_by":"daemon"}]}
{"id":".dotfiles-cb1","title":"Investigate GPG signed commits not working","description":"GPG signed commits were working in the archived dotfiles-nix repo but are not working in this repo (.dotfiles).\n\nNeed to investigate:\n- Compare git config between repos (user.signingkey, commit.gpgsign, gpg.program)\n- Check if GPG key is still valid and available\n- Verify gpg-agent is running and configured correctly\n- Check if 1Password SSH agent integration is interfering\n- Compare .gitconfig or home-manager git module settings\n- Test with git log --show-signature on old repo vs this one\n\nReference: Previous working config was in dotfiles-nix repo (now archived)","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-29T09:53:50.215454-05:00","updated_at":"2025-12-29T09:53:50.215454-05:00","labels":["git","gpg"]}
{"id":".dotfiles-ckn","title":"[Phase 4] User testing and real-world usage validation","description":"Use the Notes \u0026 Capture System in daily workflow. Test:\n- Text capture from browser (verify app name, window title, language in frontmatter)\n- Text capture from terminal/nvim\n- Image capture flow\n- Daily note linking (verify no duplicates, proper formatting)\n- obsidian.nvim backlinks navigation\n- Unified gr keybinding (tags vs links vs LSP)\n- Smart \u003ccr\u003e and gf mappings\n\nReport any issues found for Phase 5 fixes.","status":"in_progress","priority":2,"issue_type":"task","created_at":"2025-12-26T20:54:01.167553-05:00","updated_at":"2025-12-26T20:54:08.411674-05:00","labels":["phase-4","testing"]}
{"id":".dotfiles-cwn","title":"Fix application watcher never stopped on reload","description":"In lib/notifications/notifier.lua:316-333, the application watcher is started on module load but never stopped. Add stop logic to cleanup function and call it before hs.reload(). Location: notifier.lua setupAppWatcher()","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-27T18:02:16.760137-05:00","updated_at":"2025-12-27T18:02:16.760137-05:00","labels":["critical","hammerspoon","memory-leak"]}
{"id":".dotfiles-d8h","title":"[Phase 2] Create lib/interop/selection.lua wrapper","description":"Lua wrapper for bin/get-selection. Call via hs.task.new(), parse JSON, handle errors gracefully.","status":"closed","priority":1,"issue_type":"task","estimated_minutes":30,"created_at":"2025-12-26T10:35:59.258017-05:00","updated_at":"2025-12-26T11:07:28.416287-05:00","closed_at":"2025-12-26T11:07:28.416287-05:00","close_reason":"Created lib/interop/selection.lua wrapper with async callback API","labels":["hammerspoon","lua","phase-2"],"dependencies":[{"issue_id":".dotfiles-d8h","depends_on_id":".dotfiles-vd5","type":"blocks","created_at":"2025-12-26T10:35:59.258897-05:00","created_by":"daemon"}]}
{"id":".dotfiles-dlr","title":"Add cleanup methods to notifier module","description":"Add M.cleanup() function to lib/notifications/notifier.lua that stops _G.notificationAppWatcher, deletes _G.notificationOverlay canvas, and clears all timer references. Critical for preventing memory leaks on reload.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-27T18:02:15.598605-05:00","updated_at":"2025-12-27T18:02:15.598605-05:00","labels":["critical","hammerspoon","memory-leak"]}
{"id":".dotfiles-dm7","title":"Notes \u0026 Capture System","description":"Unified note-taking and capture system integrating Hammerspoon, Neovim (obsidian.nvim), and a floating Kitty terminal window for seamless capture workflows across the system.\n\nGoals:\n- Quick capture of text/ideas from anywhere on the system\n- Context-aware capture (grab selected text + source metadata without clipboard pollution)\n- Floating notes window that persists and toggles cleanly\n- Integration with daily notes via obsidian.nvim\n\nArchitecture:\n- Floating notes terminal: Kitty with persistent nvim session\n- Main terminal: Ghostty (tmux) - unchanged\n- Window management: Hammerspoon toggle with previousApp restore\n- Context capture: Swift script via Accessibility API (no clipboard)\n- Note storage: Obsidian vault with obsidian.nvim","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-26T10:34:58.50616-05:00","updated_at":"2025-12-27T17:36:01.618571-05:00","closed_at":"2025-12-27T17:36:01.618571-05:00","close_reason":"Core features complete. Capture system fully functional: persistent nvim session, clipboard-free selection via Accessibility API, text/image capture workflows, daily note integration, obsidian.nvim backlinks. Phase 5 polish tasks remain open for future refinement.","labels":["hammerspoon","notes","nvim","obsidian"]}
{"id":".dotfiles-fdx","title":"Add LaunchDaemon to increase maxfiles limit for nix builds","description":"Nix builds fail with 'Too many open files' due to macOS default maxfiles limit of 256.\n\nRoot Cause:\n- macOS launchctl soft limit defaults to 256\n- Complex nix evaluations open many files (git packfiles, store paths)\n- No declarative kernel parameter config on modern macOS\n\nSolution:\n- Create LaunchDaemon via nix-darwin that runs 'launchctl limit maxfiles 524288 524288' at boot\n- This is Apple's officially recommended approach (no alternative exists)\n\nImplementation:\n- Add launchd.daemons.limit-maxfiles to modules/system.nix\n- Set both soft and hard limits to 524288 (512K)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T09:32:41.433874-05:00","updated_at":"2025-12-29T09:33:30.977042-05:00","closed_at":"2025-12-29T09:33:30.977042-05:00","close_reason":"Implemented in modules/system.nix - creates LaunchDaemon that sets maxfiles to 524288 at boot","labels":["darwin","dx","launchd","nix"]}
{"id":".dotfiles-hr2","title":"Split watchers/notification.lua into smaller modules","description":"notification.lua (825 lines) has too many responsibilities. Split into: notification-observer.lua (AX observer), notification-matcher.lua (rule matching), notification-actions.lua (dismiss/redirect). Each module should have single responsibility.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-27T18:03:11.640881-05:00","updated_at":"2025-12-27T18:03:11.640881-05:00","labels":["architecture","hammerspoon","refactor"]}
{"id":".dotfiles-ivz","title":"[Phase 5] Error handling and edge cases","description":"Handle: Kitty not installed, nvim socket unresponsive, get-selection fails, directory not writable, window stuck state. Add logging and graceful degradation.","status":"open","priority":3,"issue_type":"task","estimated_minutes":60,"created_at":"2025-12-26T10:35:59.870144-05:00","updated_at":"2025-12-26T10:35:59.870144-05:00","labels":["hammerspoon","phase-5","polish"],"dependencies":[{"issue_id":".dotfiles-ivz","depends_on_id":".dotfiles-ca8","type":"blocks","created_at":"2025-12-26T10:35:59.871088-05:00","created_by":"daemon"},{"issue_id":".dotfiles-ivz","depends_on_id":".dotfiles-ckn","type":"blocks","created_at":"2025-12-26T20:54:09.575095-05:00","created_by":"daemon"}]}
{"id":".dotfiles-jod","title":"[Future] Create Neovide-based toggle as Kitty alternative","description":"Native macOS window alternative to Kitty terminal. Neovide already installed. Compare reliability and performance.","status":"closed","priority":4,"issue_type":"feature","estimated_minutes":120,"created_at":"2025-12-26T10:35:59.973888-05:00","updated_at":"2025-12-26T15:14:02.918563-05:00","closed_at":"2025-12-26T15:14:02.918563-05:00","close_reason":"Abandoned after testing - neovide socket reliability issues, sticking with Kitty","labels":["future","neovide"]}
{"id":".dotfiles-lp4","title":"Extract magic numbers to config.lua","description":"Multiple magic numbers in code: minHeight=100, maxHeight=400 in notifier.lua; depth limits of 6 and 8 in notification.lua tree traversal. Move to C.notifier.canvas.* and C.notifier.axTreeMaxDepth.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-27T18:02:44.2798-05:00","updated_at":"2025-12-27T18:02:44.2798-05:00","labels":["hammerspoon","maintainability"]}
{"id":".dotfiles-m8o","title":"Define AI agent workspace workflow rules for CLAUDE.md","description":"Add comprehensive workspace workflow rules to CLAUDE.md for AI agents:\n\nRules to document:\n\n1. **Workspace Awareness**\n   - Check if in a workspace at session start\n   - Understand workspace isolation scope\n   - Know which files are shared vs isolated\n\n2. **Pre-Work Protocol**\n   - Check jj workspace list for context\n   - Check for stale workspace state\n   - Identify linked bead task\n\n3. **During Work**\n   - Stay within workspace scope\n   - Don't modify shared configs unless intentional\n   - Use jj commands exclusively (no git in workspaces)\n\n4. **Conflict Avoidance**\n   - Communicate intent before touching shared files\n   - Check if another workspace is modifying same area\n   - Prefer narrower file scopes\n\n5. **Handoff Protocol**\n   - Document work state before leaving workspace\n   - Update bead task status\n   - Note any pending conflicts for resolution\n\n6. **Merge Protocol**\n   - When workspace work is complete\n   - How to rebase onto main\n   - How to handle conflicts\n\nInclude concrete examples and error recovery procedures.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-29T08:44:58.431147-05:00","updated_at":"2025-12-29T08:44:58.431147-05:00","labels":["ai-workflow","claude","documentation","workspace"],"dependencies":[{"issue_id":".dotfiles-m8o","depends_on_id":".dotfiles-20n","type":"blocks","created_at":"2025-12-29T08:44:58.441398-05:00","created_by":"daemon"}]}
{"id":".dotfiles-mkm","title":"Image capture context enrichment via recognition/OCR","description":"Enhance image captures with intelligent context extraction:\n\n- Detect frontmost app when screenshot is taken (app name, window title)\n- OCR text visible in the screenshot for searchable content\n- Image classification/summarization for descriptive filenames\n- Pass enriched context to the capture note frontmatter\n\nThis would enable smarter naming like '20251226-1730-github-pr-review.png' instead of generic timestamps, and make captures more searchable via extracted text.","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-26T17:40:03.974062-05:00","updated_at":"2025-12-26T17:40:03.974062-05:00"}
{"id":".dotfiles-n5m","title":"Add sparse checkout patterns for large repos","description":"Document and implement sparse checkout patterns for workspace efficiency:\n\nUse Cases:\n- Monorepo with multiple packages\n- Large repos where agents only need subset of files\n- Performance optimization for workspace creation\n\nJJ Sparse Commands:\n- jj workspace add --sparse-patterns=empty - Start empty\n- jj sparse set --add 'path/to/dir/**' - Add specific paths\n- jj sparse list - View current patterns\n\nPattern Examples for Dotfiles:\n- config/hammerspoon/** - Just Hammerspoon work\n- home/programs/** - Just home-manager configs\n- modules/** - Just nix-darwin modules\n\nDocumentation:\n- When to use sparse workspaces\n- Pattern syntax\n- Caveats (some operations need full tree)\n\nLower priority - dotfiles repo is small, but valuable for other repos.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-29T08:45:27.04485-05:00","updated_at":"2025-12-29T08:45:27.04485-05:00","labels":["jj","performance","workspace"],"dependencies":[{"issue_id":".dotfiles-n5m","depends_on_id":".dotfiles-20n","type":"blocks","created_at":"2025-12-29T08:45:27.0554-05:00","created_by":"daemon"}]}
{"id":".dotfiles-ngc","title":"[Phase 5] Code cleanup and refactoring for maintainability","description":"Review and refactor the Notes \u0026 Capture System code for maintainability:\n\nPotential areas to address:\n- lib/notes.lua: Large file, may need splitting into focused modules\n- lib/interop/scratchpad.lua: Complex toggle logic, could simplify\n- config/nvim/after/plugin/notes.lua: Growing autocmd file, review organization\n- Consolidate duplicate patterns across capture workflows\n- Add documentation/comments where logic is non-obvious\n- Review error handling consistency\n- Consider extracting shared utilities\n\nGoal: Make the codebase approachable for future modifications without deep context.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-27T17:35:54.678127-05:00","updated_at":"2025-12-27T17:35:54.678127-05:00","labels":["hammerspoon","nvim","phase-5","polish"]}
{"id":".dotfiles-pvi","title":"[Phase 1] Implement persistent nvim session with --remote","description":"Change scratchpad from spawning new nvim per-launch to single persistent session. First launch: nvim --listen /tmp/notes.sock. Subsequent: nvim --server ... --remote \u003cfile\u003e.","status":"closed","priority":1,"issue_type":"task","estimated_minutes":60,"created_at":"2025-12-26T10:35:59.156162-05:00","updated_at":"2025-12-26T12:51:24.113062-05:00","closed_at":"2025-12-26T12:51:24.113062-05:00","close_reason":"Implemented persistent nvim session with --listen/--server/--remote. Ghostty macOS fix discovered (use open -na instead of direct CLI).","labels":["hammerspoon","nvim","phase-1"]}
{"id":".dotfiles-qur","title":"Cache require() calls in notification hot paths","description":"In watchers/notification.lua, require('lib.notifications.db') and require('lib.notifications.menubar') are called inside handleNotification() on every notification. Move to module-level cache to reduce overhead.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T18:02:30.371012-05:00","updated_at":"2025-12-27T18:02:30.371012-05:00","labels":["hammerspoon","performance"]}
{"id":".dotfiles-rrs","title":"Create workspace template for new repos","description":"Create reusable templates/scripts for enabling workspace workflows in any repo:\n\nComponents:\n1. **Init script** - Set up workspace-aware jj config for a repo\n   - Creates .jj-workspaces/ tracking directory (gitignored)\n   - Adds recommended jj config\n   - Sets up bead integration hooks\n\n2. **CLAUDE.md template section** - Copy-paste workspace rules\n   - AI agent workspace protocols\n   - jj workspace command reference\n   - Conflict resolution procedures\n\n3. **justfile targets** - Common workspace operations\n   - just ws-new $NAME\n   - just ws-list\n   - just ws-cleanup $NAME\n\n4. **CI/CD templates** - For workspace-aware CI\n   - GitHub Actions with workspace isolation\n   - Test matrix across workspaces\n\nLocation: Could be a separate repo or template directory in dotfiles.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-29T08:45:24.49844-05:00","updated_at":"2025-12-29T08:45:24.49844-05:00","labels":["dx","jj","template","workspace"],"dependencies":[{"issue_id":".dotfiles-rrs","depends_on_id":".dotfiles-20n","type":"blocks","created_at":"2025-12-29T08:45:24.504954-05:00","created_by":"daemon"}]}
{"id":".dotfiles-sj6","title":"[Phase 5] Add smooth toggle animations","description":"Slide-in/slide-out animations for notes window toggle. Make configurable and disable-able.","status":"open","priority":3,"issue_type":"task","estimated_minutes":45,"created_at":"2025-12-26T10:35:59.769766-05:00","updated_at":"2025-12-26T10:35:59.769766-05:00","labels":["hammerspoon","phase-5","polish"],"dependencies":[{"issue_id":".dotfiles-sj6","depends_on_id":".dotfiles-ca8","type":"blocks","created_at":"2025-12-26T10:35:59.7707-05:00","created_by":"daemon"},{"issue_id":".dotfiles-sj6","depends_on_id":".dotfiles-ckn","type":"blocks","created_at":"2025-12-26T20:54:09.66359-05:00","created_by":"daemon"}]}
{"id":".dotfiles-t5t","title":"Enable jj auto-update-stale configuration","description":"Add 'snapshot.auto-update-stale = true' to jj user config to reduce friction with stale workspace messages.\n\nWhy: When one workspace modifies a commit that another workspace has checked out, the second workspace becomes 'stale'. Without auto-update-stale, agents/developers must manually run 'jj workspace update-stale' which breaks flow.\n\nImplementation:\n- Add config to existing jj user config in dotfiles\n- Consider making this part of a jj config module for portability","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T08:44:13.446747-05:00","updated_at":"2025-12-29T10:28:00.38624-05:00","closed_at":"2025-12-29T10:28:00.38624-05:00","close_reason":"Added snapshot.auto-update-stale = true to home/programs/jujutsu.nix","labels":["config","jj","workspace"],"dependencies":[{"issue_id":".dotfiles-t5t","depends_on_id":".dotfiles-20n","type":"blocks","created_at":"2025-12-29T08:44:13.457311-05:00","created_by":"daemon"}]}
{"id":".dotfiles-u39","title":"Split lib/notifications/notifier.lua into smaller modules","description":"notifier.lua (978 lines) handles canvas creation, positioning, animation, overlay, app watching. Split into: notifier-canvas.lua (canvas building), notifier-position.lua (positioning logic), notifier-animation.lua (slide animations).","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-27T18:03:12.453317-05:00","updated_at":"2025-12-27T18:03:12.453317-05:00","labels":["architecture","hammerspoon","refactor"]}
{"id":".dotfiles-uho","title":"Reduce _G global state pollution","description":"Replace 7+ _G.* variables in notifier.lua with module-local M._state table. Also consolidate _G.C, _G.U, _G.N, _G.I, etc. in init.lua. Makes debugging easier and prevents name collisions.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T18:02:31.21514-05:00","updated_at":"2025-12-27T18:02:31.21514-05:00","labels":["code-quality","hammerspoon"]}
{"id":".dotfiles-vd5","title":"[Phase 1] Create bin/get-selection Swift script","description":"Create Swift script using macOS Accessibility API to get selected text without clipboard. Query kAXSelectedTextAttribute, return JSON with selection, app info, window title, and URL for browsers.","status":"closed","priority":1,"issue_type":"task","estimated_minutes":120,"created_at":"2025-12-26T10:35:59.055742-05:00","updated_at":"2025-12-26T11:07:25.286524-05:00","closed_at":"2025-12-26T11:07:25.286524-05:00","close_reason":"Swift script created and tested - browser, terminal detection working","labels":["accessibility","phase-1","swift"]}
{"id":".dotfiles-wg1","title":"Add type annotations to public Hammerspoon functions","description":"Many functions lack ---@param and ---@return annotations, reducing LSP usefulness. Priority files: utils.lua (most functions unannotated), notification.lua, notifier.lua. Use LuaLS annotation format.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-27T18:02:59.468479-05:00","updated_at":"2025-12-27T18:02:59.468479-05:00","labels":["documentation","hammerspoon"]}
{"id":".dotfiles-wl6","title":"Hammerspoon Config Cleanup \u0026 Refactoring","description":"Epic for cleaning up and refactoring the Hammerspoon configuration. Addresses memory leaks, code smells, anti-patterns, and maintainability issues identified in deep analysis. See child tasks for specific issues.","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-27T18:03:21.503178-05:00","updated_at":"2025-12-27T18:03:21.503178-05:00","labels":["epic","hammerspoon","refactor"]}
{"id":".dotfiles-wpc","title":"[Phase 2] Integrate selection.lua with capture workflow","description":"Replace clipboard-based context detection with selection.lua. Update lib/notes.lua and bindings.lua HYPER+shift+N flow.","status":"closed","priority":1,"issue_type":"task","estimated_minutes":45,"created_at":"2025-12-26T10:35:59.358579-05:00","updated_at":"2025-12-26T13:00:28.849405-05:00","closed_at":"2025-12-26T13:00:28.849405-05:00","close_reason":"Integrated selection.lua with capture workflow. Replaced clipboard-based fallback with Accessibility API via Swift script. Fixed getSync() event loop blocking bug.","labels":["hammerspoon","phase-2"],"dependencies":[{"issue_id":".dotfiles-wpc","depends_on_id":".dotfiles-d8h","type":"blocks","created_at":"2025-12-26T10:35:59.359376-05:00","created_by":"daemon"},{"issue_id":".dotfiles-wpc","depends_on_id":".dotfiles-pvi","type":"blocks","created_at":"2025-12-26T10:35:59.359902-05:00","created_by":"daemon"}]}
