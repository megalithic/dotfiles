{"id":".dotfiles-0b9","title":"Fix notification database schema mismatch - missing 'action_taken' column in getRecent query","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-27T18:38:53.406366-05:00","updated_at":"2025-12-27T18:43:23.305967-05:00","closed_at":"2025-12-27T18:43:23.305967-05:00","close_reason":"Closed","labels":["database","hammerspoon"]}
{"id":".dotfiles-141","title":"Shade: Rename MegaNote and implement persistent terminal wrapper","description":"Transform MegaNote into Shade - a lightweight, persistent floating terminal wrapper around libghostty.\n\n## Goals\n- Rename project from MegaNote to Shade (\"lighter than a ghost\")\n- Implement background-on-exit behavior (nvim :wq hides, doesn't quit)\n- Add emergency escape hotkey (independent of Hammerspoon)\n- Support note workflows: quick capture and daily note via IPC\n- Use XDG directories for state files\n- New IPC namespace: io.shade.*\n\n## Non-Goals (Future Phases)\n- Full global hotkey registration (Phase 2)\n- Context gathering in Shade (Phase 2)  \n- Vision/OCR integration (Phase 3)\n- Migrate daily note logic to obsidian.nvim (Phase 3)\n\n## Architecture\n```\n~/.local/state/shade/\n├── context.json    # Capture context from Hammerspoon\n├── nvim.sock       # Nvim RPC socket\n└── shade.pid       # Process management\n\nIPC: io.shade.{toggle,show,hide,quit}\n     io.shade.note.{capture,daily}\n```","status":"open","priority":1,"issue_type":"epic","created_at":"2026-01-07T09:02:22.219108-05:00","updated_at":"2026-01-07T09:02:22.219108-05:00"}
{"id":".dotfiles-141.1","title":"Rename project: MegaNote → Shade","description":"Comprehensive rename of all project artifacts.\n\n## Changes Required\n- [ ] Rename `Sources/*.swift` types: MegaAppDelegate → ShadeAppDelegate, MegaPanel → ShadePanel\n- [ ] Update Package.swift product name\n- [ ] Update binary name in justfile\n- [ ] Update README.md\n- [ ] Update LICENSE if needed\n- [ ] Update flake.nix package name\n- [ ] Update all IPC notification names: com.meganote.* → io.shade.*\n- [ ] Update Log messages\n- [ ] Update CLI help text and app description\n\n## Verification\n- `just build` succeeds\n- `just run --help` shows 'shade' branding\n- IPC notifications use new namespace","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T09:02:28.85084-05:00","updated_at":"2026-01-07T09:21:03.320158-05:00","closed_at":"2026-01-07T09:21:03.320158-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-141.1","depends_on_id":".dotfiles-141","type":"parent-child","created_at":"2026-01-07T09:02:28.851482-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-141.10","title":"[Future] Phase 2: Move global hotkeys to Shade","description":"Register Hyper+Shift+N and Hyper+Shift+O directly in Shade.\n\n## Goal\nMake Shade fully independent of Hammerspoon for note workflows.\n\n## Scope\n- Register global hotkeys via CGEvent tap\n- Hyper+Shift+N → quick capture (with context gathering)\n- Hyper+Shift+O → daily note\n- Gather context directly in Shade (port get-selection Swift logic)\n\n## Prerequisites\n- .dotfiles-141.6 (emergency hotkey) proves CGEvent approach works\n- Accessibility permissions documented\n\n## Considerations\n- Conflicts with Hammerspoon if both register same keys\n- May need config to disable Shade hotkeys if user prefers Hammerspoon\n- Hyper key detection (Cmd+Ctrl+Alt+Shift) in CGEvent\n\n## Defer Until\n- Phase 1 complete and stable\n- User confirms desire to move away from Hammerspoon","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-07T09:03:20.985527-05:00","updated_at":"2026-01-07T09:03:20.985527-05:00","dependencies":[{"issue_id":".dotfiles-141.10","depends_on_id":".dotfiles-141","type":"parent-child","created_at":"2026-01-07T09:03:20.986147-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-141.11","title":"[Future] Phase 2: Context gathering in Shade","description":"Port context gathering from Hammerspoon to Shade.\n\n## Current State\n- get-selection (Swift script) captures selected text via Accessibility API\n- interop/context.lua gathers browser URLs, nvim state, etc.\n- Hammerspoon orchestrates and writes context.json\n\n## Goal\nShade gathers context itself when quick capture is triggered.\n\n## Implementation\n- Port get-selection logic into Shade\n- Add browser URL detection (JXA or Accessibility)\n- Add nvim context via RPC (already needed for .dotfiles-141.8)\n- Write context.json for obsidian.nvim template consumption\n\n## Prerequisites\n- .dotfiles-141.8 (nvim RPC) complete\n- Phase 2 hotkeys working\n\n## Considerations\n- Accessibility permissions already required\n- May need entitlements for JXA/AppleScript\n- Some context (like browser URL) may require Hammerspoon's hs.application","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-07T09:03:26.605364-05:00","updated_at":"2026-01-08T14:32:33.042786-05:00","closed_at":"2026-01-08T14:32:33.042786-05:00","close_reason":"Implemented via shade-qji epic","dependencies":[{"issue_id":".dotfiles-141.11","depends_on_id":".dotfiles-141","type":"parent-child","created_at":"2026-01-07T09:03:26.605992-05:00","created_by":"seth","metadata":"{}"},{"issue_id":".dotfiles-141.11","depends_on_id":".dotfiles-qji","type":"parent-child","created_at":"2026-01-08T10:48:24.433866-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-141.11.1","title":"Context Gathering in Shade (Sub-Epic)","description":"Port context gathering from Hammerspoon to Shade, making Shade self-sufficient for capturing context from the frontmost app.\n\n## Background\nCurrently Hammerspoon orchestrates context gathering via:\n- `bin/get-selection` Swift script (Accessibility API)\n- `lib/interop/context.lua` (app type detection, browser JXA)\n- `lib/interop/nvim.lua` (nvim RPC for buffer info)\n- `lib/interop/shade.lua` (writes context.json)\n\n## Goal\nShade gathers context itself when quick capture is triggered, eliminating Hammerspoon as middleman.\n\n## Architecture\n```\nContextGatherer.swift\n├── AXUIElement → selectedText, windowTitle, bundleID\n├── JXABridge → browser URLs, selections  \n├── NvimAPI (existing!) → buffer info, selection\n└── AppTypeDetector → browser/terminal/editor/other\n```\n\n## Messages.app Note\nUser will use standard copy/paste for selection - no exotic clipboard monitoring needed.","status":"closed","priority":3,"issue_type":"epic","created_at":"2026-01-08T10:48:13.541665-05:00","updated_at":"2026-01-08T16:17:22.356401-05:00","closed_at":"2026-01-08T16:17:22.356401-05:00","close_reason":"Completed as part of shade-qji epic"}
{"id":".dotfiles-141.12","title":"[Future] Phase 3: Vision/OCR integration research","description":"Research and implement image-to-text for captured screenshots.\n\n## Goal\nWhen user captures a screenshot, optionally:\n1. Run OCR to extract text\n2. Run Vision/LLM to summarize content\n3. Include in capture note\n\n## Technologies to Research\n- Apple Vision framework (on-device OCR)\n- Ollama with local models (summarization)\n- VLMs for image understanding\n\n## Integration Points\n- Hammerspoon clipper.lua already handles screenshot capture\n- Could add OCR step before/after upload\n- Shade could coordinate OCR if image path passed in context\n\n## Open Questions\n- Should OCR happen in Hammerspoon, Shade, or separate service?\n- Async processing (don't block capture workflow)?\n- How to inject OCR text into note template?\n\n## Defer Until\n- Phase 2 complete\n- obsidian.nvim templating enhanced","status":"open","priority":4,"issue_type":"task","created_at":"2026-01-07T09:03:32.326018-05:00","updated_at":"2026-01-07T09:03:32.326018-05:00","dependencies":[{"issue_id":".dotfiles-141.12","depends_on_id":".dotfiles-141","type":"parent-child","created_at":"2026-01-07T09:03:32.326631-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-141.13","title":"[Future] Phase 3: Migrate daily note logic to obsidian.nvim","description":"Replace shell script daily_note with obsidian.nvim native functionality.\n\n## Current State\n- daily_note shell script handles:\n  - File creation with template\n  - Task migration from previous day\n  - Tmux session management\n- obsidian.nvim has :ObsidianToday but doesn't migrate tasks\n\n## Goal\nUse obsidian.nvim for all daily note functionality:\n- Template-based creation\n- Custom Lua to migrate tasks from previous day\n- No shell script dependency\n\n## Research Required\n- obsidian.nvim template capabilities\n- Hook into note creation event\n- Access previous day's note programmatically\n- Parse and migrate incomplete tasks\n\n## Implementation Ideas\n- obsidian.nvim callback: on_new_daily_note\n- Custom Lua function to find previous note\n- Treesitter to parse task items\n- Append migrated tasks to new note\n\n## Considerations\n- Task format: - [ ] vs - [x]\n- Which sections to migrate?\n- Handle edge cases (no previous note, weekend gaps)\n\n## Defer Until\n- Phase 2 complete\n- Research obsidian.nvim extensibility","status":"closed","priority":4,"issue_type":"task","created_at":"2026-01-07T09:03:38.533269-05:00","updated_at":"2026-01-08T10:32:43.218562-05:00","closed_at":"2026-01-08T10:32:43.218562-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-141.13","depends_on_id":".dotfiles-141","type":"parent-child","created_at":"2026-01-07T09:03:38.534024-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-141.14","title":"[Future] Native msgpack-rpc client for nvim","description":"Superseded by epic .dotfiles-plf - see that epic for detailed breakdown of tasks.","status":"closed","priority":4,"issue_type":"task","created_at":"2026-01-07T09:32:36.276013-05:00","updated_at":"2026-01-07T15:52:38.947192-05:00","closed_at":"2026-01-07T15:52:38.947192-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-141.14","depends_on_id":".dotfiles-141","type":"parent-child","created_at":"2026-01-07T09:32:36.278186-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-141.2","title":"Implement background-on-exit behavior","description":"When the child process (nvim) exits normally, hide the panel instead of terminating Shade.\n\n## Current Behavior\n- `TerminalView.hasProcessExited()` triggers `NSApp.terminate()`\n- User must re-launch Shade after every nvim session\n\n## Desired Behavior\n- nvim :wq → hide panel, keep Shade running\n- nvim killed/crashed → hide panel, keep Shade running\n- Cmd+Q in Shade → actually terminate\n- io.shade.quit IPC → actually terminate\n\n## Implementation\n- Remove/modify the termination logic in tick timer\n- On process exit: destroy surface, hide panel, await new surface creation\n- Track 'has active surface' state\n- Add quit notification handler\n\n## Edge Cases\n- Multiple rapid toggles while no surface exists\n- Surface creation failure after process exit","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T09:02:34.314821-05:00","updated_at":"2026-01-07T09:23:03.952435-05:00","closed_at":"2026-01-07T09:23:03.952435-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-141.2","depends_on_id":".dotfiles-141","type":"parent-child","created_at":"2026-01-07T09:02:34.31537-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-141.3","title":"Add XDG directory support for state files","description":"Use XDG Base Directory spec for Shade's runtime state.\n\n## Directory Structure\n```\n~/.local/state/shade/\n├── context.json    # Capture context (written by Hammerspoon)\n├── nvim.sock       # Nvim RPC socket path\n└── shade.pid       # PID file for process management\n```\n\n## Implementation\n- Create StateDirectory helper in Swift\n- Auto-create directory on launch if missing\n- Write PID file on launch, remove on clean shutdown\n- Update nvim socket path in launch command\n- Expose paths via CLI flags or environment for Hammerspoon\n\n## Considerations\n- Handle existing /tmp paths gracefully during transition\n- Document XDG paths in README","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T09:02:38.625725-05:00","updated_at":"2026-01-07T09:24:18.365254-05:00","closed_at":"2026-01-07T09:24:18.365254-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-141.3","depends_on_id":".dotfiles-141","type":"parent-child","created_at":"2026-01-07T09:02:38.626362-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-141.4","title":"Implement io.shade.note.capture IPC handler","description":"Handle quick capture requests from Hammerspoon.\n\n## IPC Flow\n1. Hammerspoon gathers context, writes to ~/.local/state/shade/context.json\n2. Hammerspoon sends io.shade.note.capture notification\n3. Shade reads context.json\n4. Shade shows panel\n5. Shade sends RPC to nvim: open new capture file (or use obsidian.nvim command)\n\n## Context JSON Schema\n```json\n{\n  \"appType\": \"browser|terminal|neovim|other\",\n  \"appName\": \"Brave Browser\",\n  \"windowTitle\": \"GitHub - ...\",\n  \"url\": \"https://...\",\n  \"filePath\": \"/path/to/file\",\n  \"selection\": \"selected text\",\n  \"detectedLanguage\": \"lua\",\n  \"timestamp\": \"2026-01-07T12:00:00Z\"\n}\n```\n\n## Implementation\n- Add notification observer for io.shade.note.capture\n- Read and parse context.json\n- If no surface exists, create one\n- Send nvim RPC command to open capture file\n- Show panel\n\n## Dependencies\n- Requires background-on-exit (surface may not exist)\n- Requires XDG directories (context.json path)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T09:02:44.269753-05:00","updated_at":"2026-01-07T09:25:53.087762-05:00","closed_at":"2026-01-07T09:25:53.087762-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-141.4","depends_on_id":".dotfiles-141","type":"parent-child","created_at":"2026-01-07T09:02:44.270385-05:00","created_by":"seth","metadata":"{}"},{"issue_id":".dotfiles-141.4","depends_on_id":".dotfiles-141.2","type":"blocks","created_at":"2026-01-07T09:03:47.725346-05:00","created_by":"seth","metadata":"{}"},{"issue_id":".dotfiles-141.4","depends_on_id":".dotfiles-141.3","type":"blocks","created_at":"2026-01-07T09:03:47.763122-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-141.5","title":"Implement io.shade.note.daily IPC handler","description":"Handle daily note requests from Hammerspoon.\n\n## IPC Flow\n1. Hammerspoon sends io.shade.note.daily notification\n2. Shade shows panel\n3. Shade sends RPC to nvim to open daily note\n\n## Implementation Options\n\n### Option A: Let obsidian.nvim handle it\n- Send nvim RPC: `nvim_command('ObsidianToday')`\n- obsidian.nvim creates file with template if needed\n- Requires obsidian.nvim to be configured for daily notes\n\n### Option B: Shade computes path, nvim just opens\n- Shade computes: `~/notes/daily/2026/20260107.md`\n- Send nvim RPC: `nvim_command('edit ' .. path)`\n- File creation/templating happens elsewhere (shell script still)\n\n## Current Recommendation\n- Start with Option B (matches current workflow)\n- Migrate to Option A when obsidian.nvim templating is enhanced\n\n## Dependencies\n- Requires background-on-exit (surface may not exist)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T09:02:49.408173-05:00","updated_at":"2026-01-07T09:25:57.17003-05:00","closed_at":"2026-01-07T09:25:57.17003-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-141.5","depends_on_id":".dotfiles-141","type":"parent-child","created_at":"2026-01-07T09:02:49.408786-05:00","created_by":"seth","metadata":"{}"},{"issue_id":".dotfiles-141.5","depends_on_id":".dotfiles-141.2","type":"blocks","created_at":"2026-01-07T09:03:47.799844-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-141.6","title":"Add emergency escape hotkey (Cmd+Escape)","description":"Register a global hotkey as emergency dismiss, independent of Hammerspoon.\n\n## Goal\nWhen Hammerspoon breaks, user can still dismiss Shade with Cmd+Escape (or configured key).\n\n## Implementation Approach\nUse CGEvent tap to register global hotkey:\n1. Request Accessibility permissions (likely already granted for get-selection)\n2. Create CGEvent tap for keyDown events\n3. Check for Cmd+Escape combination\n4. On match: hide panel, return true (consume event)\n\n## Considerations\n- Should this work even when Shade is hidden? (Probably no-op)\n- What if Accessibility permissions denied? (Log warning, continue without hotkey)\n- Should hotkey be configurable? (Future: via config file)\n\n## Alternative: NSEvent.addGlobalMonitorForEvents\n- Simpler API but less reliable for key consumption\n- May not work if another app has captured the key\n\n## Verification\n- Launch Shade\n- Kill Hammerspoon\n- Press Cmd+Escape\n- Shade should hide","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T09:02:55.495287-05:00","updated_at":"2026-01-07T09:34:07.129171-05:00","closed_at":"2026-01-07T09:34:07.129171-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-141.6","depends_on_id":".dotfiles-141","type":"parent-child","created_at":"2026-01-07T09:02:55.495917-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-141.7","title":"Add Cmd+Q handler for actual quit","description":"Distinguish between 'hide on process exit' and 'actually quit the app'.\n\n## Current State\n- No explicit quit handling\n- App quits when child process exits\n\n## Desired Behavior\n- Cmd+Q in Shade window → terminate app\n- io.shade.quit IPC → terminate app\n- Child process exit → hide panel, keep running\n\n## Implementation\n- Add menu bar (even if hidden) with Quit item for Cmd+Q\n- Or: capture Cmd+Q in key event handling\n- Add io.shade.quit notification observer\n- Both trigger NSApp.terminate()\n\n## Considerations\n- Shade runs as .accessory (no dock icon) - does Cmd+Q still work?\n- May need to temporarily become .regular to receive Cmd+Q?\n- Alternative: capture in global hotkey system","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T09:03:00.393904-05:00","updated_at":"2026-01-07T09:25:01.1793-05:00","closed_at":"2026-01-07T09:25:01.1793-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-141.7","depends_on_id":".dotfiles-141","type":"parent-child","created_at":"2026-01-07T09:03:00.394451-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-141.8","title":"Implement nvim RPC communication","description":"Add ability to send commands to nvim via Unix socket RPC.\n\n## Current State\n- nvim launched with: --listen /tmp/nvim-capture.sock\n- Hammerspoon can send RPC commands\n- Shade cannot (no RPC client)\n\n## Required for\n- Opening files in existing nvim session (capture, daily note)\n- Checking buffer state before switching\n- Future: sending save commands\n\n## Implementation\nUse nvim's msgpack-rpc protocol over Unix socket:\n1. Connect to socket at ~/.local/state/shade/nvim.sock\n2. Send nvim_command() RPC calls\n3. Handle connection failures gracefully (nvim not running)\n\n## Swift Options\n- Raw socket + msgpack encoding (complex)\n- Shell out to nvr/nvim --remote (simpler, adds dependency)\n- Use Process to run: nvim --server \u003csock\u003e --remote-send '\u003ccmd\u003e'\n\n## Recommended: Start with Process/nvim --server\n```swift\nProcess.run(\n  \"/usr/bin/env\", \"nvim\",\n  \"--server\", socketPath,\n  \"--remote-send\", \"\u003cC-\\\\\u003e\u003cC-n\u003e:edit \\(path)\u003cCR\u003e\"\n)\n```\n\n## Considerations\n- What if nvim isn't running? Create new surface with nvim\n- What if socket doesn't exist? Same as above\n- Race conditions between surface creation and RPC","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T09:03:08.61901-05:00","updated_at":"2026-01-07T09:32:47.882087-05:00","closed_at":"2026-01-07T09:32:47.882087-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-141.8","depends_on_id":".dotfiles-141","type":"parent-child","created_at":"2026-01-07T09:03:08.619622-05:00","created_by":"seth","metadata":"{}"},{"issue_id":".dotfiles-141.8","depends_on_id":".dotfiles-141.3","type":"blocks","created_at":"2026-01-07T09:03:47.835983-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-141.9","title":"Update documentation and README for Shade","description":"Comprehensive documentation update after rename.\n\n## Updates Required\n- [ ] README.md: new name, updated architecture diagram\n- [ ] README.md: document XDG paths\n- [ ] README.md: document new IPC namespace\n- [ ] README.md: document emergency hotkey\n- [ ] Update justfile comments\n- [ ] Add CHANGELOG.md entry for rename\n\n## New Sections to Add\n- IPC Protocol reference\n- XDG directory structure\n- Hammerspoon integration guide (link to dotfiles epic)","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-07T09:03:15.591985-05:00","updated_at":"2026-01-07T09:35:24.759631-05:00","closed_at":"2026-01-07T09:35:24.759631-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-141.9","depends_on_id":".dotfiles-141","type":"parent-child","created_at":"2026-01-07T09:03:15.592563-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-155","title":"Critical notifications on primaryScreen","description":"Make critical/high urgency notifications always appear on hs.screen.primaryScreen() (external monitor) instead of following the focused window. Both the notification canvas and dimming overlay should use primaryScreen when urgency is critical/high (center position).","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-05T11:03:10.402997-05:00","updated_at":"2026-01-05T11:06:04.728273-05:00","closed_at":"2026-01-05T11:06:04.728273-05:00","close_reason":"Implemented in commit: fix(hammerspoon): correct Fantastical bundleID and show critical notifications on primaryScreen"}
{"id":".dotfiles-1aq","title":"Design multi-agent coordination protocol","description":"Define protocols for multiple AI agents working simultaneously:\n\nScenarios to Handle:\n1. **Multiple Claude Code instances** on same machine\n2. **Parallel task execution** by same agent (Task tool subagents)\n3. **Sequential handoff** between agent sessions\n\nCoordination Mechanisms:\n1. **Lock files** - .jj-workspaces/$NAME.lock with PID\n   - Check before starting work\n   - Release on session end\n   - Stale lock detection\n\n2. **Bead task claiming** - bd update --status=in_progress --assignee=agent-1\n   - Prevents double-claiming\n   - Visible to other agents via bd list\n\n3. **Workspace reservation** - Metadata in workspace\n   - Who's working here?\n   - What task?\n   - Session start time\n\n4. **Conflict detection** - Pre-work check\n   - Are other workspaces touching same files?\n   - jj diff comparison across workspaces\n\n5. **Communication channel** - Shared state file\n   - .jj-workspaces/coordination.json\n   - Agent intents and status\n\nImplementation should be lightweight - agents can coordinate without heavy infrastructure.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-29T08:45:25.789508-05:00","updated_at":"2025-12-29T08:45:25.789508-05:00","labels":["ai-workflow","concurrency","workspace"],"dependencies":[{"issue_id":".dotfiles-1aq","depends_on_id":".dotfiles-20n","type":"blocks","created_at":"2025-12-29T08:45:25.799324-05:00","created_by":"daemon","metadata":"{}"}]}
{"id":".dotfiles-1cs","title":"starship-jj-workspace","description":"Evaluate and enhance Starship prompt to display jj workspace info","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T13:29:41.752846-05:00","updated_at":"2025-12-29T13:31:52.372909-05:00","closed_at":"2025-12-29T13:31:52.372909-05:00","close_reason":"Implemented workspace indicator in Starship prompt","labels":["jj","prompt","starship"]}
{"id":".dotfiles-1d4","title":"test-ws","description":"AI agent workspace task for test-ws","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T13:15:02.899858-05:00","updated_at":"2025-12-29T13:32:48.880801-05:00","closed_at":"2025-12-29T13:32:48.880801-05:00","close_reason":"Test workspace - cleaned up after validation","labels":["agent","workspace"]}
{"id":".dotfiles-1ic","title":"Create Hammerspoon reload cleanup hook","description":"Add a central cleanup mechanism in init.lua that calls cleanup() on all modules before hs.reload(). Modules should register their cleanup functions. This ensures watchers, timers, and canvases are properly released.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T18:03:13.560943-05:00","updated_at":"2025-12-29T15:25:29.86731-05:00","closed_at":"2025-12-29T15:25:29.86731-05:00","close_reason":"Implemented as part of memory leak fixes - cleanup hooks now registered and called on hs.reload()","labels":["architecture","hammerspoon","memory-leak"]}
{"id":".dotfiles-1ql","title":"Create agent-oriented workspace scripts (jj-ws-claim, jj-ws-complete)","description":"Create standalone scripts in ~/bin for AI agents to use programmatically.\n\nUnlike fish functions (human-oriented with fzf pickers), these are:\n- Machine-readable output (JSON or structured)\n- Clear exit codes\n- Bead task lifecycle integration\n- No interactive prompts\n\nScripts needed:\n- jj-ws-claim \u003ctask-id\u003e - Claim/create workspace for a bead task\n- jj-ws-complete - Mark task done, merge work, cleanup workspace\n- jj-ws-status - Machine-readable workspace state\n\nThese will be called by Claude, OpenCode, and other AI agents during their workflow.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T12:04:15.513853-05:00","updated_at":"2025-12-29T13:32:48.781858-05:00","closed_at":"2025-12-29T13:32:48.781858-05:00","close_reason":"Created bin/jj-ws-claim, bin/jj-ws-complete, bin/jj-ws-status with JSON output, bead integration, tmux window creation","labels":["ai-workflow","jj","scripts"],"dependencies":[{"issue_id":".dotfiles-1ql","depends_on_id":".dotfiles-20n","type":"blocks","created_at":"2025-12-29T12:04:15.520475-05:00","created_by":"daemon","metadata":"{}"}]}
{"id":".dotfiles-1rd","title":"Standardize module pattern across Hammerspoon config","description":"Inconsistent module patterns: some use 'local M = {}', others use 'local obj = {}' with unused __index. Standardize on simple 'local M = {}' pattern without unnecessary metatable setup. Remove unused M.__index and M.name declarations.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-27T18:02:43.284235-05:00","updated_at":"2025-12-27T18:02:43.284235-05:00","labels":["code-quality","hammerspoon"]}
{"id":".dotfiles-1zf","title":"Implement visor-style slide animation for notes scratchpad","description":"Research and implement smooth slide-down animation for notes scratchpad visor mode. Current attempt using hs.window:setFrame() with duration doesn't work - macOS may clamp windows to screen bounds preventing off-screen positioning. Consider alternatives: hs.canvas overlay, or native window animation APIs.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T09:03:35.389927-05:00","updated_at":"2025-12-30T09:03:35.389927-05:00","labels":["animation","hammerspoon","phase-5","polish"]}
{"id":".dotfiles-20n","title":"JJ Workspaces + Bead Workflow for Concurrent AI Agent Development","description":"Enable concurrent AI agent and developer workflows using jj workspaces for VCS isolation and bead for task coordination. This epic addresses:\n\n1. **JJ Workspace Infrastructure** - Set up workspace management patterns for this repo and provide reusable patterns for other repos\n2. **Bead Integration** - Establish conventions for workspace-specific bead epics/tasks and cross-workspace synchronization  \n3. **AI Agent Workflow Rules** - Define clear protocols for agents operating in workspaces to avoid conflicts\n4. **Developer Experience** - Scripts, aliases, and documentation to make workspace workflows frictionless\n\nKey Goals:\n- Multiple AI agents can work concurrently without stomping on each other's changes\n- Each workspace gets its own bead epic/task context\n- Clear handoff protocols between workspaces and agents\n- Easy workspace lifecycle management (create, work, merge, cleanup)\n\nResearch Complete: See _docs/jj-workspaces-research.md for comprehensive findings on jj workspace architecture, lock-free concurrency model, conflict handling, and best practices.","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-29T08:43:32.746854-05:00","updated_at":"2025-12-29T08:43:32.746854-05:00","labels":["ai-workflow","bead","concurrency","epic","jj"]}
{"id":".dotfiles-2hs","title":"Debug Shade + Hammerspoon integration issues","description":"Debug and fix the Shade + Hammerspoon integration after the .dotfiles-qji context gathering refactor.\n\n## Problem\nAfter refactoring Hammerspoon to use notification pattern (io.shade.note.daily, io.shade.note.capture), the daily note and capture workflows are broken.\n\n## Evidence\n- Shade IS running with correct args (--command, --working-directory)\n- nvim socket EXISTS and RESPONDS (v:version returns 801)\n- But: errors.log shows 'timeout waiting for nvim server to send: :ObsidianToday'\n\n## Hypothesis\nThe notification handlers in Shade (ShadeAppDelegate.swift) may not be correctly wired up, OR ShadeNvim actor is failing to connect/execute commands.\n\n## Key Files\n- ~/.dotfiles/config/hammerspoon/lib/interop/shade.lua\n- ~/.dotfiles/config/hammerspoon/bindings.lua\n- ~/code/shade/Sources/ShadeAppDelegate.swift\n- ~/code/shade/Sources/ShadeNvim.swift","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-08T14:47:07.406511-05:00","updated_at":"2026-01-08T16:17:04.185129-05:00","closed_at":"2026-01-08T16:17:04.185129-05:00","close_reason":"Debug complete - all issues resolved via shade-d5b and shade-4u3"}
{"id":".dotfiles-2hs.1","title":"Verify notification handlers are registered in ShadeAppDelegate","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-08T14:47:20.230882-05:00","updated_at":"2026-01-08T16:17:00.58529-05:00","closed_at":"2026-01-08T16:17:00.58529-05:00","close_reason":"Verified - notification handlers are registered and working","dependencies":[{"issue_id":".dotfiles-2hs.1","depends_on_id":".dotfiles-2hs","type":"parent-child","created_at":"2026-01-08T14:47:20.231568-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-2hs.2","title":"Test io.shade.note.daily notification delivery and handler execution","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-08T14:47:20.900813-05:00","updated_at":"2026-01-08T16:17:01.191012-05:00","closed_at":"2026-01-08T16:17:01.191012-05:00","close_reason":"Working - daily note notification triggers correctly","dependencies":[{"issue_id":".dotfiles-2hs.2","depends_on_id":".dotfiles-2hs","type":"parent-child","created_at":"2026-01-08T14:47:20.901519-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-2hs.3","title":"Debug ShadeNvim.connectAndPerform flow for openDailyNote","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-08T14:47:22.058916-05:00","updated_at":"2026-01-08T16:17:02.489318-05:00","closed_at":"2026-01-08T16:17:02.489318-05:00","close_reason":"Fixed via shade-d5b (bidirectional RPC) and shade-4u3 (early-return fix)","dependencies":[{"issue_id":".dotfiles-2hs.3","depends_on_id":".dotfiles-2hs","type":"parent-child","created_at":"2026-01-08T14:47:22.059609-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-2hs.4","title":"Test io.shade.note.capture notification and context gathering","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T14:47:22.891204-05:00","updated_at":"2026-01-08T16:17:03.396867-05:00","closed_at":"2026-01-08T16:17:03.396867-05:00","close_reason":"Fixed via shade-4u3 - capture now works even when panel visible","dependencies":[{"issue_id":".dotfiles-2hs.4","depends_on_id":".dotfiles-2hs","type":"parent-child","created_at":"2026-01-08T14:47:22.89186-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-2hs.5","title":"Fix screen positioning (Shade uses NSScreen.main instead of primary)","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-08T14:47:23.918592-05:00","updated_at":"2026-01-08T16:17:21.594933-05:00","closed_at":"2026-01-08T16:17:21.594933-05:00","close_reason":"Duplicate of shade-qa3","dependencies":[{"issue_id":".dotfiles-2hs.5","depends_on_id":".dotfiles-2hs","type":"parent-child","created_at":"2026-01-08T14:47:23.919242-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-2i2","title":"Add menubar icon using SF Symbol pin rotated 45 degrees","description":"Add a menubar status item for Shade with a recognizable icon.\n\n## Icon\n- Use SF Symbol: selection.pin.in.out\n- Rotate 45 degrees for visual distinction\n- Should work in light and dark mode\n\n## Menubar Functionality\n- Click to toggle panel visibility\n- Right-click or long-press for menu:\n  - Show/Hide\n  - Open Daily Note\n  - New Capture\n  - Separator\n  - Quit\n\n## Implementation Notes\n- Use NSStatusItem with NSStatusBar.system\n- NSImage(systemSymbolName:accessibilityDescription:) for SF Symbol\n- Apply CGAffineTransform for rotation\n- Consider using template image for auto dark/light adaptation\n\n## Acceptance Criteria\n- Icon visible in menubar when Shade running\n- Click toggles panel\n- Menu provides quick actions\n- Works correctly in light and dark mode","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-08T09:35:13.323623-05:00","updated_at":"2026-01-08T10:21:30.327388-05:00","closed_at":"2026-01-08T10:21:30.327388-05:00","close_reason":"Closed"}
{"id":".dotfiles-2lu","title":"Research libghostty embedding for custom notes app","description":"Research and document libghostty embedding for a custom Swift-based notes capture app. Goals: (1) Understand build requirements, (2) Document C API usage, (3) Create minimal proof-of-concept, (4) Evaluate viability vs VimR/Neovide approaches.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T10:00:58.037052-05:00","updated_at":"2025-12-30T13:08:40.568155-05:00","closed_at":"2025-12-30T13:08:40.568155-05:00","close_reason":"MegaNote built and working - Swift CLI using libghostty with Hammerspoon integration, auto-detect binary, IPC via distributed notifications"}
{"id":".dotfiles-32b","title":"Fix inconsistent EDITOR/VISUAL/JJ_EDITOR configuration","description":"Editor environment variables are configured in multiple conflicting places, causing tools like jj to fail when opening editors.\n\nCurrent State (broken):\n- EDITOR=nvim (just binary name)\n- VISUAL=/nix/store/.../nvim (full nix path)\n- JJ_EDITOR=(empty)\n- GIT_EDITOR=$EDITOR\n\nSources of Conflict:\n1. hosts/megabookpro.nix:61-63 - Sets EDITOR to pkgs.nvim-nightly/bin/nvim\n2. home/zsh/lib/env.zsh:93 - Sets EDITOR='nvim -O' (with -O flag!)\n3. home/programs/nvim.nix:42 - defaultEditor = true (may also set things)\n4. JJ_EDITOR - Never explicitly set\n\nProblem Discovered:\n- jj split failed because editor didn't work properly\n- Concurrent AI agent changes got wrong commit messages\n- nvim client/server mode (from notes system) may have changed expected behavior\n\nRequired Fix:\n1. Consolidate editor config in ONE place (probably nix)\n2. Remove conflicting zsh env.zsh EDITOR override\n3. Set JJ_EDITOR explicitly (may need different behavior than git)\n4. Test that all tools work: jj, git, bd, fish edit_command_buffer\n5. Ensure nvim client/server mode doesn't break interactive editing\n\nRelated: Notes \u0026 Capture system may have changed nvim startup behavior","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-29T08:54:57.499263-05:00","updated_at":"2026-01-09T10:57:01.390834-05:00","closed_at":"2026-01-09T10:57:01.390834-05:00","close_reason":"No longer relevant or already resolved","labels":["bug","dx","jj","nix","nvim"]}
{"id":".dotfiles-3os","title":"Add io.shade.note.capture.image notification handler","description":"Add handler for image captures from clipper module.\n\nClipper writes context with imageFilename, then sends io.shade.note.capture.image notification.\nShade needs to:\n1. Read context (with imageFilename field)\n2. Run :Obsidian new_from_template capture capture-image\n3. Show panel (for captureFull) or stay hidden (for captureQuick)\n\nRequired changes:\n- ShadeAppDelegate.swift: Add handleImageCaptureNotification handler\n- StateDirectory.swift/CaptureContext: Add imageFilename field\n- ShadeNvim.swift: Add openImageCapture() method","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T12:32:45.757317-05:00","updated_at":"2026-01-08T12:34:32.905607-05:00","closed_at":"2026-01-08T12:34:32.905607-05:00","close_reason":"Closed"}
{"id":".dotfiles-3ra","title":"Remove duplicate logging in notification hot path","description":"In notification.lua:382-388, both print() and U.log.nf() are called on every notification with similar format strings. Remove the print() call or consolidate to single logging approach.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-27T18:03:01.739539-05:00","updated_at":"2025-12-27T18:03:01.739539-05:00","labels":["hammerspoon","performance"]}
{"id":".dotfiles-3rc","title":"Create jj-workspace skill for AI agent workflow awareness","description":"Create a skill (docs/skills/jj-workspace.md) that AI agents can invoke to understand:\n\n- When to create/claim a workspace\n- How to use jj-ws-* scripts\n- Bead task integration patterns\n- Multi-agent coordination rules\n- Workspace lifecycle management\n\nThis skill should be usable by Claude Code, OpenCode, and other AI tools.\nDepends on agent scripts (.dotfiles-1ql) being complete.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-29T12:04:28.988264-05:00","updated_at":"2025-12-29T12:04:28.988264-05:00","labels":["ai-workflow","jj","skill"],"dependencies":[{"issue_id":".dotfiles-3rc","depends_on_id":".dotfiles-20n","type":"blocks","created_at":"2025-12-29T12:04:28.997875-05:00","created_by":"daemon","metadata":"{}"}]}
{"id":".dotfiles-4el","title":"Configure Hammerspoon PATH for Nix/Homebrew binaries","description":"Hammerspoon doesn't inherit shell PATH, requiring absolute paths to binaries (nvim, kitty, ghostty). Find a clean solution to inject Nix/Homebrew paths so we can use simple binary names instead of hardcoded paths like /opt/homebrew/bin/kitty or /run/current-system/sw/bin/nvim.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T11:10:46.837799-05:00","updated_at":"2025-12-26T12:23:12.803943-05:00","closed_at":"2025-12-26T12:23:12.803943-05:00","close_reason":"Implemented PATH injection via monkey-patched hs.task.new in overrides.lua. Nix generates nix_path.lua to ~/.local/share/hammerspoon/ on darwin-rebuild.","labels":["dx","hammerspoon","nix","path"]}
{"id":".dotfiles-4u3","title":"Fix: capture notification early-return prevented new captures when panel visible","description":"When panel was already visible, handleNoteCaptureNotification() would just focus the panel and return early instead of creating a new capture. This broke the Hyper+Shift+N workflow when daily note was open.\n\nFix: Remove the early-return logic - always create a new capture when user explicitly requests one.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-08T15:47:00.653518-05:00","updated_at":"2026-01-08T15:47:09.975448-05:00","closed_at":"2026-01-08T15:47:09.975448-05:00","close_reason":"Fixed by removing early-return in handleNoteCaptureNotification - always create new capture"}
{"id":".dotfiles-58f","title":"Dynamic panel sizing: daily notes larger than captures","description":"Shade should resize the panel based on notification type:\n- io.shade.note.daily → large (0.6 x 0.6)\n- io.shade.note.capture → small (0.4 x 0.4)\n- io.shade.note.capture.image → small (0.4 x 0.4)\n\nCLI args can override these defaults:\n- --daily-width, --daily-height\n- --capture-width, --capture-height\n\nWhen switching from capture to daily (or vice versa), panel should resize dynamically.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T16:08:57.491046-05:00","updated_at":"2026-01-08T16:27:13.49859-05:00","closed_at":"2026-01-08T16:27:13.49859-05:00","close_reason":"Implemented dynamic sizing: daily=0.6x0.6, capture=0.4x0.4, with CLI overrides"}
{"id":".dotfiles-5lx","title":"Fix obsidian.nvim deprecation warnings and API changes","description":"Fixed multiple issues: 1) Deprecated 'mappings' config replaced with 'callbacks.enter_note', 2) util module replaced with api module, 3) cursor_on_markdown_link() replaced with api.cursor_link(), 4) Added gr keybinding that works on frontmatter tags and body tags","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T17:06:58.233137-05:00","updated_at":"2025-12-27T17:07:03.819703-05:00","closed_at":"2025-12-27T17:07:03.819703-05:00","close_reason":"Fixed in config/nvim/lua/plugins/obsidian.lua and config/nvim/after/plugin/notes.lua","labels":["nvim","obsidian"]}
{"id":".dotfiles-5vb","title":"Add consistent error handling to pcall patterns","description":"Some pcall() calls properly check return values, others ignore them entirely. Example: notifier.lua:143 uses pcall without checking success. Standardize on 'local ok, err = pcall(...)' pattern and handle errors.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-27T18:02:45.083377-05:00","updated_at":"2025-12-27T18:02:45.083377-05:00","labels":["error-handling","hammerspoon"]}
{"id":".dotfiles-5y5","title":"[Research] Deep audit of Nix config duplication and redundancy","description":"## Objective\nDeep dive into the Nix configuration to identify and validate areas of duplication, redundancy, and unclear module boundaries. Build on Phases 1-2 of the existing reorganization work.\n\n## Scope\n1. **Path Definition Duplication** - Validate paths defined in both hosts/megabookpro.nix AND home/default.nix\n2. **Package Installation Duplication** - Verify packages in both environment.systemPackages AND home-manager programs.X\n3. **Environment Variable Overlap** - Check env vars set at system AND user level\n4. **App Installation Method Confusion** - Clarify brew vs mkApp vs nixpkgs boundaries\n5. **Config Sourcing Inconsistency** - Document out-of-store vs in-store vs generated patterns\n\n## Deliverables\n- Updated _docs/nix-dotfiles-reorganization-research.md with:\n  - Validated findings with specific file:line references\n  - Clear refactoring recommendations\n  - Priority-ordered tasks for Phase 3+\n- Beads for actionable refactoring work\n\n## Related\n- Existing research: _docs/nix-dotfiles-reorganization-research.md\n- Phases 1-2 complete, Phases 3-4 not started","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-14T07:58:42.515859-05:00","updated_at":"2026-01-14T08:00:44.304858-05:00","closed_at":"2026-01-14T08:00:44.304858-05:00","close_reason":"Research complete. Updated _docs/nix-dotfiles-reorganization-research.md with validated findings. Created 3 actionable tasks: .dotfiles-kcj (paths), .dotfiles-795 (packages), .dotfiles-d1e (routing docs)"}
{"id":".dotfiles-5y6","title":"Create bead-workspace integration pattern","description":"Design and implement patterns for integrating bead issue tracking with jj workspaces:\n\nCore Pattern:\n- Each workspace can be associated with a bead epic or task\n- Workspace creation can auto-create/link to bead task\n- Workspace cleanup can update bead task status\n\nImplementation Ideas:\n1. **Workspace metadata file**: .jj-workspace-bead.json in workspace root\n   - Contains linked bead issue ID\n   - Auto-updated by jj-ws-* scripts\n\n2. **Bead workspace label**: Add 'workspace:$NAME' label to tasks\n   - Easy filtering: bd list --labels='workspace:agent-1'\n\n3. **Auto-context injection**: bd prime could include workspace-specific context\n   - Which workspace am I in?\n   - What's my assigned task?\n\n4. **Cross-workspace task visibility**: \n   - bd list should work from any workspace\n   - Show workspace assignments in output\n\nResearch needed:\n- How does bead handle multiple concurrent readers/writers?\n- Does bead need sandbox mode in workspaces?","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-29T08:44:32.922278-05:00","updated_at":"2025-12-29T08:44:32.922278-05:00","labels":["bead","integration","jj","workspace"],"dependencies":[{"issue_id":".dotfiles-5y6","depends_on_id":".dotfiles-20n","type":"blocks","created_at":"2025-12-29T08:44:32.933147-05:00","created_by":"daemon","metadata":"{}"}]}
{"id":".dotfiles-6bp","title":"[Phase 5] Add window position persistence","description":"Save/restore notes window position via hs.settings. Handle multi-monitor and off-screen scenarios.","status":"closed","priority":3,"issue_type":"task","estimated_minutes":30,"created_at":"2025-12-26T10:35:59.656222-05:00","updated_at":"2025-12-30T09:14:09.346669-05:00","closed_at":"2025-12-30T09:14:09.346669-05:00","close_reason":"Window positioning and smooth toggle complete: centered float with explicit Kitty dimensions, separate instances for daily/capture notes. Visor animations deferred to separate task (.dotfiles-1zf).","labels":["hammerspoon","phase-5","polish"],"dependencies":[{"issue_id":".dotfiles-6bp","depends_on_id":".dotfiles-ca8","type":"blocks","created_at":"2025-12-26T10:35:59.657071-05:00","created_by":"daemon","metadata":"{}"},{"issue_id":".dotfiles-6bp","depends_on_id":".dotfiles-ckn","type":"blocks","created_at":"2025-12-26T20:54:09.752167-05:00","created_by":"daemon","metadata":"{}"}]}
{"id":".dotfiles-6ct","title":"Handle colocated repo workspace limitations","description":"Address known issues with jj workspaces in colocated (jj+git) repos:\n\nKnown Issues:\n1. **Secondary workspaces lack .git file** - Tools expecting git repos may fail\n2. **git commands don't work in secondary workspaces** - Must use jj only\n3. **IDE git integrations can cause stale workspaces** - Background fetches\n4. **Performance degrades with many git refs** - Need periodic jj util gc\n\nPotential Mitigations:\n1. **Disable IDE git in workspace dirs** - .vscode/settings.json, etc.\n2. **Create wrapper scripts** that warn about git usage\n3. **Add pre-command hook** to check for git command usage in workspaces\n4. **Document which tools need git** and alternatives\n\nResearch:\n- Is there a way to create .git file for secondary workspaces? (jj discussion #6286)\n- Can we symlink or stub the .git for compatibility?\n\nThis may require accepting limitations rather than full solutions.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-29T08:45:00.830762-05:00","updated_at":"2025-12-29T08:45:00.830762-05:00","labels":["git","jj","workaround","workspace"],"dependencies":[{"issue_id":".dotfiles-6ct","depends_on_id":".dotfiles-20n","type":"blocks","created_at":"2025-12-29T08:45:00.841606-05:00","created_by":"daemon","metadata":"{}"}]}
{"id":".dotfiles-71b","title":"statusline-jj-support","description":"AI agent workspace task for statusline-jj-support","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T13:56:54.988508-05:00","updated_at":"2025-12-30T14:06:02.510195-05:00","closed_at":"2025-12-30T14:06:02.510195-05:00","close_reason":"Completed: removed tmux window creation from jj-ws-claim and jj-ws-complete","labels":["agent","workspace"]}
{"id":".dotfiles-795","title":"[Nix] Remove duplicate packages from environment.systemPackages","description":"## Problem\nPackages are installed TWICE - in environment.systemPackages AND via programs.X.enable:\n\n| Package | system.nix | home location |\n|---------|------------|---------------|\n| bat | :133 | programs.bat.enable (:471) |\n| git | :144 | programs.git.enable (:378) |\n| ripgrep | :165 | programs.ripgrep.enable (:497) |\n| fd | :141 | programs.fd.enable (:501) |\n| eza | :140 | programs.eza.enable (:457) |\n| zoxide | :173 | programs.zoxide.enable (:424) |\n| starship | :166 | programs.starship.enable (:374) |\n\nWhen programs.X.enable = true, home-manager auto-installs the package.\n\n## Solution\nRemove duplicates from modules/system.nix. Keep ONLY packages that:\n1. Don't have home-manager modules (delta, coreutils, etc.)\n2. Need system-wide availability before user login\n\n## Files to modify\n- EDIT: modules/system.nix (hosts/megabookpro.nix:123-177)\n\n## Acceptance criteria\n- [ ] No duplicate packages\n- [ ] darwin-rebuild succeeds\n- [ ] All tools still work (bat, git, rg, fd, eza, zoxide, starship)","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T08:00:34.295806-05:00","updated_at":"2026-01-14T08:00:34.295806-05:00","dependencies":[{"issue_id":".dotfiles-795","depends_on_id":".dotfiles-kcj","type":"blocks","created_at":"2026-01-14T08:00:39.566532-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-7dz","title":"Define workspace naming conventions and directory structure","description":"Establish clear conventions for workspace organization:\n\nNaming Pattern: $REPO-$PURPOSE[-$AGENT]\nExamples:\n- dotfiles-auth-refactor\n- dotfiles-test-runner\n- dotfiles-agent-1\n- dotfiles-docs-update\n\nDirectory Structure:\n- Main workspace: ~/.dotfiles (contains .jj/store/)\n- Secondary workspaces: ~/.dotfiles-$NAME (siblings, not children!)\n\nWhy siblings not children:\n- Avoids nested workspace footgun (jj issue #6102)\n- Cleaner separation\n- Some tools scan subdirectories\n\nReserved names:\n- 'main' or 'default' for primary workspace\n- 'ci-*' for CI/CD workspaces\n- 'agent-*' for AI agent workspaces\n\nDocument in CLAUDE.md for AI agents to follow.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T08:44:30.588357-05:00","updated_at":"2025-12-29T11:11:04.557731-05:00","closed_at":"2025-12-29T11:11:04.557731-05:00","close_reason":"Created _docs/jj-workspace-conventions.md with colocated .workspaces/ pattern","labels":["conventions","documentation","jj","workspace"],"dependencies":[{"issue_id":".dotfiles-7dz","depends_on_id":".dotfiles-20n","type":"blocks","created_at":"2025-12-29T08:44:30.59899-05:00","created_by":"daemon","metadata":"{}"}]}
{"id":".dotfiles-8a7","title":"Extend Hammerspoon env injection for NOTES_HOME","description":"Extended nix_path.lua to export NIX_ENV table with critical env vars (NOTES_HOME, OBSIDIAN_HOME, NVIM_DB_HOME, DOTS, XDG_*). Updated overrides.lua to inject these into spawned processes. Fixes nvim config errors when launched via Hammerspoon hotkeys.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T17:06:46.105735-05:00","updated_at":"2025-12-27T17:06:51.241449-05:00","closed_at":"2025-12-27T17:06:51.241449-05:00","close_reason":"Implemented in home/default.nix, overrides.lua, and preflight.lua","labels":["env","hammerspoon","nix"]}
{"id":".dotfiles-8g2","title":"Shade: Update Hammerspoon integration for MegaNote → Shade rename","description":"Update Hammerspoon configuration to work with the renamed Shade app.\n\n## Related\n- Shade repo epic: shade-141 (in ~/code/MegaNote → ~/code/shade)\n\n## Scope\n- Rename interop/meganote.lua → interop/shade.lua\n- Update IPC notifications: com.meganote.* → io.shade.*\n- Update binary paths and process names\n- Add io.shade.note.capture handler (write context.json, send notification)\n- Add io.shade.note.daily handler\n- Update keybindings\n- Update notes.lua to use new module\n\n## Future (Phase 2+)\n- Remove global hotkey registration if Shade handles it\n- Remove context gathering if Shade handles it\n- Vision/OCR integration hooks\n\n## XDG Paths\nHammerspoon will write context to:\n~/.local/state/shade/context.json","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-07T09:06:35.362099-05:00","updated_at":"2026-01-07T09:06:35.362099-05:00"}
{"id":".dotfiles-8g2.1","title":"Rename interop/meganote.lua to interop/shade.lua and update all references","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T10:09:21.282408-05:00","updated_at":"2026-01-07T10:19:33.460276-05:00","closed_at":"2026-01-07T10:19:33.460276-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-8g2.1","depends_on_id":".dotfiles-8g2","type":"parent-child","created_at":"2026-01-07T10:09:21.286033-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-8g2.10","title":"[Validate] Test socket path coordination - verify Option A works or need Option B","description":"Socket coordination question from planning session:\n\n**Option A (current approach)**: Hammerspoon passes command with --listen ~/.local/state/shade/nvim.sock\n**Option B (alternative)**: Shade injects --listen into whatever command is passed\n\nWe're starting with Option A. This task is to verify:\n1. Does nvim actually listen on the socket when launched this way?\n2. Can Shade's NvimRPC successfully communicate with it?\n3. If not, do we need Option B (Shade handles socket setup)?\n\nContext: Shade expects socket at StateDirectory.nvimSocketPath (~/.local/state/shade/nvim.sock)\nThe command passed from Hammerspoon needs to include: nvim --listen ~/.local/state/shade/nvim.sock","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-07T10:09:29.291451-05:00","updated_at":"2026-01-08T14:58:50.398123-05:00","closed_at":"2026-01-08T14:58:50.398128-05:00","dependencies":[{"issue_id":".dotfiles-8g2.10","depends_on_id":".dotfiles-8g2","type":"parent-child","created_at":"2026-01-07T10:09:29.292073-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-8g2.11","title":"Shade: subsequent daily note presses open empty nvim","description":"When pressing Hyper+Shift+O multiple times:\n1. First press works - opens daily note in Shade\n2. User does :wq or hides Shade\n3. Second press opens empty nvim instead of daily note\n\nNeed to investigate:\n- Is nvim still running after hide? (should be)\n- Is socket still valid?\n- Is openFile() RPC succeeding?\n- Is the issue in Hammerspoon or Shade?\n\nPossibly related to socket cleanup or backgrounding logic.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-07T14:30:02.193339-05:00","updated_at":"2026-01-07T15:03:19.757784-05:00","closed_at":"2026-01-07T15:03:19.757786-05:00","dependencies":[{"issue_id":".dotfiles-8g2.11","depends_on_id":".dotfiles-8g2","type":"parent-child","created_at":"2026-01-07T14:30:02.19414-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-8g2.12","title":"Shade: restore focus to previous window on hide","description":"When Shade panel hides (via toggle, hide IPC, or Cmd+Escape):\n- Should restore focus to the window that was focused before Shade was shown\n- Currently just calls orderOut(nil) which leaves focus in limbo\n\nImplementation needed in Shade (Swift):\n- Track previous app/window before showing panel\n- Restore focus to it on hide\n\nThis affects both capture and daily note workflows - user expects to return to their previous context after dismissing Shade.","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-07T14:30:09.739725-05:00","updated_at":"2026-01-07T14:30:09.739725-05:00","dependencies":[{"issue_id":".dotfiles-8g2.12","depends_on_id":".dotfiles-8g2","type":"parent-child","created_at":"2026-01-07T14:30:09.740408-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-8g2.2","title":"Update IPC notifications from com.meganote.* to io.shade.*","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T10:09:22.026199-05:00","updated_at":"2026-01-07T10:19:33.530097-05:00","closed_at":"2026-01-07T10:19:33.530097-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-8g2.2","depends_on_id":".dotfiles-8g2","type":"parent-child","created_at":"2026-01-07T10:09:22.026943-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-8g2.3","title":"Update binary paths and process detection for shade","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T10:09:23.044817-05:00","updated_at":"2026-01-07T10:19:33.597402-05:00","closed_at":"2026-01-07T10:19:33.597402-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-8g2.3","depends_on_id":".dotfiles-8g2","type":"parent-child","created_at":"2026-01-07T10:09:23.045483-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-8g2.4","title":"Update socket path to ~/.local/state/shade/nvim.sock","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T10:09:24.078221-05:00","updated_at":"2026-01-07T10:19:43.932244-05:00","closed_at":"2026-01-07T10:19:43.932244-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-8g2.4","depends_on_id":".dotfiles-8g2","type":"parent-child","created_at":"2026-01-07T10:09:24.078807-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-8g2.5","title":"Add io.shade.note.capture handler (write context.json, send notification)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T10:09:25.579264-05:00","updated_at":"2026-01-07T10:19:44.041404-05:00","closed_at":"2026-01-07T10:19:44.041404-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-8g2.5","depends_on_id":".dotfiles-8g2","type":"parent-child","created_at":"2026-01-07T10:09:25.579989-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-8g2.6","title":"Add io.shade.note.daily handler","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T10:09:26.090667-05:00","updated_at":"2026-01-07T10:19:44.11025-05:00","closed_at":"2026-01-07T10:19:44.11025-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-8g2.6","depends_on_id":".dotfiles-8g2","type":"parent-child","created_at":"2026-01-07T10:09:26.091309-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-8g2.7","title":"Update keybindings to use shade module","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T10:09:26.57389-05:00","updated_at":"2026-01-07T10:19:44.180711-05:00","closed_at":"2026-01-07T10:19:44.180711-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-8g2.7","depends_on_id":".dotfiles-8g2","type":"parent-child","created_at":"2026-01-07T10:09:26.574469-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-8g2.8","title":"Update notes.lua to use new shade module","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T10:09:27.076615-05:00","updated_at":"2026-01-07T10:19:44.252656-05:00","closed_at":"2026-01-07T10:19:44.252656-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-8g2.8","depends_on_id":".dotfiles-8g2","type":"parent-child","created_at":"2026-01-07T10:09:27.077216-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-8g2.9","title":"Rename MEGANOTE=1 env var to SHADE=1","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-07T10:09:28.034911-05:00","updated_at":"2026-01-07T10:19:44.322049-05:00","closed_at":"2026-01-07T10:19:44.322049-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-8g2.9","depends_on_id":".dotfiles-8g2","type":"parent-child","created_at":"2026-01-07T10:09:28.035547-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-8nx","title":"Migrate note system to obsidian.nvim-native workflows","description":"Migrate daily notes, quick capture, and task management from shell scripts + Hammerspoon to obsidian.nvim-native templates and Lua functions.\n\n## Progress Summary (as of 2026-01-07)\n\n### COMPLETED\n- [x] Templates created at $NOTES_HOME/templates/ (daily.md, capture-text.md, capture-image.md)\n- [x] obsidian.nvim config updated with custom substitutions:\n  - migrated_tasks: extracts incomplete tasks from previous daily note\n  - yesterday_link: generates link to previous daily note  \n  - capture_context: builds collapsible callout with app/url/file context\n  - capture_selection: wraps selection in code fence with detected language\n  - date_id, timestamp: date formatting helpers\n- [x] Obsidian app configured to match nvim (daily-notes.json, templates.json)\n- [x] Context injection reads from ~/.local/state/shade/context.json\n\n### REMAINING\n- [ ] .dotfiles-8nx.5: Update Hammerspoon to use :ObsidianToday and :ObsidianNew commands\n- [ ] .dotfiles-8nx.7: Migrate notes from old vault (_notes 2) to new vault (_notes)\n- [ ] .dotfiles-8nx.6: Deprecate daily_note shell script\n\n## Key Files Modified\n- config/nvim/lua/plugins/obsidian.lua - Template substitutions and config\n- $NOTES_HOME/templates/daily.md - Daily note template\n- $NOTES_HOME/templates/capture-text.md - Text capture template  \n- $NOTES_HOME/templates/capture-image.md - Image capture template\n- $NOTES_HOME/.obsidian/daily-notes.json - Obsidian app daily notes config\n- $NOTES_HOME/.obsidian/templates.json - Obsidian app templates config\n\n## Architecture Notes\n- Shade writes context.json before triggering capture\n- obsidian.nvim substitutions read context.json at template insertion time\n- Capture linking to daily note handled by BufWritePost autocmd in autocmds.lua:779-838\n- ## Captures section created dynamically on first capture (not in template)","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-07T14:48:48.653865-05:00","updated_at":"2026-01-07T15:18:49.654071-05:00"}
{"id":".dotfiles-8nx.1","title":"Create templates directory and base templates in vault","description":"Create $NOTES_HOME/templates/ directory with:\n- daily.md - Daily note template with frontmatter and sections\n- capture-text.md - Text capture template with context placeholders\n- capture-image.md - Image capture template with OCR placeholder\n\nTemplates should use obsidian.nvim's {{date}}, {{title}} built-ins plus custom substitutions.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T14:50:52.796939-05:00","updated_at":"2026-01-07T14:51:44.894679-05:00","closed_at":"2026-01-07T14:51:44.894679-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-8nx.1","depends_on_id":".dotfiles-8nx","type":"parent-child","created_at":"2026-01-07T14:50:52.797823-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-8nx.2","title":"Implement task migration substitution function","description":"Add custom template substitution to obsidian.nvim config for task migration:\n\ntemplates.substitutions = {\n  migrated_tasks = function()\n    -- Find yesterday's daily note\n    -- Extract incomplete tasks (- [ ])\n    -- Return formatted task list\n  end\n}\n\nMust handle edge cases: no previous note, no tasks, weekend gaps.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T14:50:54.110352-05:00","updated_at":"2026-01-07T14:53:44.051526-05:00","closed_at":"2026-01-07T14:53:44.051526-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-8nx.2","depends_on_id":".dotfiles-8nx","type":"parent-child","created_at":"2026-01-07T14:50:54.111779-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-8nx.3","title":"Add context injection substitution for captures","description":"Add substitutions that read from Shade's context.json:\n\n- context_source - Browser URL or file path\n- context_app - Source application name\n- context_title - Window/tab title\n- context_selection - Selected text (for text captures)\n\nRead from ~/.local/state/shade/context.json","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T14:50:55.206417-05:00","updated_at":"2026-01-07T14:53:44.202593-05:00","closed_at":"2026-01-07T14:53:44.202593-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-8nx.3","depends_on_id":".dotfiles-8nx","type":"parent-child","created_at":"2026-01-07T14:50:55.20759-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-8nx.4","title":"Update obsidian.nvim config with new templates and substitutions","description":"Update config/nvim/lua/plugins/obsidian.lua:\n\n1. Set templates.folder = 'templates'\n2. Set daily_notes.template = 'daily.md'\n3. Add all custom substitutions\n4. Ensure frontmatter.func preserves custom fields","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T14:50:56.430788-05:00","updated_at":"2026-01-07T14:53:44.127491-05:00","closed_at":"2026-01-07T14:53:44.127491-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-8nx.4","depends_on_id":".dotfiles-8nx","type":"parent-child","created_at":"2026-01-07T14:50:56.431671-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-8nx.5","title":"Update Hammerspoon to use obsidian.nvim commands","description":"Update lib/interop/shade.lua and lib/notes.lua to use obsidian.nvim commands instead of direct file creation.\n\n## What's Done\n- obsidian.nvim config updated with custom template substitutions\n- Templates created at $NOTES_HOME/templates/ (daily.md, capture-text.md, capture-image.md)\n- Obsidian app configured to match (daily-notes.json, templates.json)\n\n## What Needs to Change\n\n### lib/interop/shade.lua\n- Daily note handler: Send `:ObsidianToday` via nvim RPC instead of running daily_note script\n- The template substitutions (migrated_tasks, yesterday_link) handle task migration automatically\n\n### lib/notes.lua  \n- Text capture: Instead of creating file directly, use `:ObsidianNew` with capture-text template\n- Image capture: Instead of creating file directly, use `:ObsidianNew` with capture-image template\n- The capture_context and capture_selection substitutions read from ~/.local/state/shade/context.json\n- Daily note linking is handled by nvim autocmd on BufWritePost (config/nvim/lua/config/autocmds.lua:779-838)\n\n### Key Files\n- config/hammerspoon/lib/interop/shade.lua\n- config/hammerspoon/lib/notes.lua\n- config/nvim/lua/plugins/obsidian.lua (already updated)\n- config/nvim/lua/config/autocmds.lua (capture linking autocmd exists)\n\n## Testing\n1. Trigger daily note via Shade - should open today's note with migrated tasks\n2. Text capture with selection - should create note with context callout\n3. Image capture - should create note with image embed\n4. Verify captures appear in daily note's ## Captures section","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T14:50:57.75774-05:00","updated_at":"2026-01-07T16:12:47.250991-05:00","closed_at":"2026-01-07T16:12:47.250991-05:00","close_reason":"Implemented and tested. All three workflows verified:\n1. Daily note (:ObsidianToday) - creates/opens daily note at correct path\n2. Text capture (:Obsidian new_from_template capture-text) - zettel+descriptor filename, code block with selection, collapsible context callout\n3. Image capture (:Obsidian new_from_template capture-image) - reads imageFilename from context.json, embeds image, context callout\n\nNote: Full interactive testing blocked by Shade shift-key bug (shade-s7p), but nvim server tests confirm the obsidian.nvim integration works correctly.","dependencies":[{"issue_id":".dotfiles-8nx.5","depends_on_id":".dotfiles-8nx","type":"parent-child","created_at":"2026-01-07T14:50:57.758979-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-8nx.6","title":"Deprecate daily_note shell script","description":"After migration is tested:\n\n1. Remove bin/daily_note or rename to daily_note.deprecated\n2. Update any remaining references\n3. Document new workflow in README or notes","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-07T14:50:58.699578-05:00","updated_at":"2026-01-07T14:51:06.341259-05:00","dependencies":[{"issue_id":".dotfiles-8nx.6","depends_on_id":".dotfiles-8nx","type":"parent-child","created_at":"2026-01-07T14:50:58.700432-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-8nx.7","title":"Migrate notes from old vault to new format","description":"Migrate notes from ~/iclouddrive/Documents/_notes 2 to ~/iclouddrive/Documents/_notes\n\n## Source (old vault)\n- Path: ~/iclouddrive/Documents/_notes 2\n- Daily notes: daily/YYYY-MM-DD.md (flat, with dashes)\n- Captures: captures/*.md\n- Assets: assets/*\n- Other notes: *.md in root\n\n## Target (new vault)\n- Path: ~/iclouddrive/Documents/_notes\n- Daily notes: daily/YYYY/YYYYMMDD.md (year subfolder, no dashes)\n- Captures: captures/*.md (same)\n- Assets: assets/* (same)\n- Templates: templates/*.md (new)\n\n## Migration steps\n1. Copy assets/ directory\n2. Copy captures/ directory\n3. Migrate daily notes:\n   - Rename YYYY-MM-DD.md -\u003e YYYYMMDD.md\n   - Move into year subfolders (daily/YYYY/)\n   - Update frontmatter id format if present\n   - Update internal links to daily notes\n4. Copy other root-level .md files (ADHD.md, ENG.md, etc.)\n5. Copy .obsidian/ config and update daily-notes.json to match new format\n6. Verify all wiki links still resolve\n7. Remove old vault after verification","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-07T15:16:12.017299-05:00","updated_at":"2026-01-07T15:16:12.017299-05:00","dependencies":[{"issue_id":".dotfiles-8nx.7","depends_on_id":".dotfiles-8nx","type":"parent-child","created_at":"2026-01-07T15:16:12.018256-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-8nx.8","title":"Update image capture template to read imageFilename from context.json","description":"The image_filename substitution in obsidian.lua currently returns a literal placeholder. Update it to:\n\n1. Read imageFilename from ~/.local/state/shade/context.json\n2. Hammerspoon (clipper.lua) should write imageFilename to context.json before triggering capture\n3. Template will then properly embed the image with ![[filename.png]]\n\nThis mirrors how capture_context already works - reading from the shared context file.\n\nRelated: The capture_context substitution already renders as a collapsible callout, so image captures will get the same treatment as text captures for source metadata.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-07T15:42:46.838107-05:00","updated_at":"2026-01-07T15:42:53.529796-05:00","dependencies":[{"issue_id":".dotfiles-8nx.8","depends_on_id":".dotfiles-8nx","type":"parent-child","created_at":"2026-01-07T15:42:46.838825-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-8uo","title":"[Phase 3] Create nvim autocmd for daily note linking","description":"BufWritePost autocmd for captures/ files. Skip empty files. Append wikilink to daily note ## Captures section.\n\nImplementation complete - pending questions before final test:\n- Different separators in description? (currently using \" · \")\n- Include timestamp in description?\n- Truncate description at different length? (currently 60 chars)\n- Different fallback text? (currently \"Text capture\")","status":"closed","priority":2,"issue_type":"task","estimated_minutes":45,"created_at":"2025-12-26T10:35:59.457437-05:00","updated_at":"2025-12-26T17:41:02.320001-05:00","closed_at":"2025-12-26T17:41:02.320001-05:00","close_reason":"Implemented and tested. Fixed language detection, added source context to frontmatter, smart filenames, duplicate prevention, and simplified image capture entries.","labels":["nvim","obsidian","phase-3"],"dependencies":[{"issue_id":".dotfiles-8uo","depends_on_id":".dotfiles-wpc","type":"blocks","created_at":"2025-12-26T10:35:59.458333-05:00","created_by":"daemon","metadata":"{}"}]}
{"id":".dotfiles-8uu","title":"Move MegaNote to ~/code/ and update paths","description":"Move MegaNote project from ~/src/ to ~/code/ and update all references:\n- Update meganote.lua appPath config\n- Update Package.swift ghostty path (relative to new location)\n- Clean and rebuild\n- Verify Hammerspoon integration still works","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-30T12:45:29.525206-05:00","updated_at":"2025-12-30T12:46:26.866998-05:00","closed_at":"2025-12-30T12:46:26.866998-05:00","close_reason":"Project moved to ~/code/MegaNote, Package.swift and meganote.lua paths updated, build verified","labels":["meganote hammerspoon"]}
{"id":".dotfiles-8wi","title":"Canonize jj workspace docs to docs/knowledge/","description":"Once the jj workspace workflow is fully vetted and complete:\n\n1. Merge _docs/jj-workspaces-research.md and _docs/jj-workspace-conventions.md\n2. Create consolidated docs/knowledge/jj-workspace-workflow.md\n3. Include:\n   - Architecture overview (operation log, lock-free concurrency)\n   - .workspaces/ directory structure\n   - Naming conventions\n   - Lifecycle (create, work, merge, cleanup)\n   - Shell integration and aliases\n   - AI agent workflow rules\n   - Troubleshooting\n\nThis is the final step after all other epic tasks are complete and workflow is battle-tested.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-29T11:12:21.174915-05:00","updated_at":"2025-12-29T11:12:21.174915-05:00","labels":["docs","jj","workflow"],"dependencies":[{"issue_id":".dotfiles-8wi","depends_on_id":".dotfiles-20n","type":"blocks","created_at":"2025-12-29T11:12:21.183028-05:00","created_by":"daemon","metadata":"{}"}]}
{"id":".dotfiles-91b","title":"Remove dead code from bindings.lua","description":"bindings.lua has ~200 lines of commented-out code (lines 151-192, 449-480, 485-641). Delete these blocks to improve maintainability. Also remove unused assertKeyAvailable function at line 662.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T18:02:31.980637-05:00","updated_at":"2026-01-02T10:10:17.529796-05:00","closed_at":"2026-01-02T10:10:17.529796-05:00","close_reason":"Removed ~170 lines of dead code: old meeting impl comments, AX debugging code, unused alt WM implementation block, and assertKeyAvailable function","labels":["cleanup","code-quality","hammerspoon"]}
{"id":".dotfiles-97v","title":"MegaNote cleanup and polish","description":"Cleanup tasks for MegaNote:\n- Remove debug print statements or make them conditional\n- Add proper error handling\n- Consider adding --verbose flag for debug output\n- Review memory management in Swift/ghostty integration","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-30T12:45:31.794737-05:00","updated_at":"2025-12-30T13:15:36.943128-05:00","closed_at":"2025-12-30T13:15:36.943128-05:00","close_reason":"Added --verbose flag for conditional logging, replaced all print() with Log utility (debug/info/warn/error), verified build. Identified cleanup opportunities (Optional.withCStringOrNil helper, hide() log consolidation) and test opportunities (AppConfig parsing tests) for future work.","labels":["meganote cleanup"]}
{"id":".dotfiles-9bb","title":"Implement holistic jj workspace context propagation","description":"Implement consistent jj workspace context across all tools in the stack.\n\nResearch documented in: _docs/jj-workspace-tooling-research.md\n\nKey integrations needed:\n- Tmux: One WINDOW per workspace within a project session\n- Fish: Prompt shows workspace name, jj-ws-* functions\n- Neovim: Statusline + Telescope picker for workspaces\n- Ghostty/terminal: Title reflects workspace\n- Starship (if used): Workspace in prompt\n\nCore challenge: Detecting 'am I in a jj workspace, and which one?' and exposing that to all tools consistently.\n\nInspiration: workmux pattern (tmux IS the interface, one command creates workspace + window)\n\nThis is follow-up work after core scripts (.dotfiles-c4d) are complete.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-29T11:52:41.777663-05:00","updated_at":"2025-12-29T11:52:41.777663-05:00","labels":["fish","integration","jj","neovim","tmux"],"dependencies":[{"issue_id":".dotfiles-9bb","depends_on_id":".dotfiles-20n","type":"blocks","created_at":"2025-12-29T11:52:41.781799-05:00","created_by":"daemon","metadata":"{}"}]}
{"id":".dotfiles-a1f","title":"Create jj workspace shell integration (prompt/statusline)","description":"Enhance shell prompt/statusline to show workspace context:\n\nCurrent State:\n- Statusline shows jj bookmark and change_id\n- No indication of which workspace\n\nDesired State:\n- Show workspace name when not in default workspace\n- Show stale indicator if workspace is stale\n- Show linked bead task ID\n\nImplementation Options:\n1. **Starship prompt module** - If using starship\n2. **Custom shell function** - For prompt PS1\n3. **Hammerspoon statusline** - Already have jj integration\n\nFormat suggestion: jj:workspace-name@bookmark* (change_id)\nExample: jj:agent-1@feat-auth* (abc123)\n\nAlso consider:\n- Color coding for workspace state (normal, stale, conflicted)\n- Quick command to show full workspace info","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T08:45:02.37166-05:00","updated_at":"2025-12-29T13:32:48.851194-05:00","closed_at":"2025-12-29T13:32:48.851194-05:00","close_reason":"Added workspace indicator to Starship custom.jj module - shows workspace name in cyan when in non-default workspace","labels":["dx","jj","shell","workspace"],"dependencies":[{"issue_id":".dotfiles-a1f","depends_on_id":".dotfiles-20n","type":"blocks","created_at":"2025-12-29T08:45:02.382114-05:00","created_by":"daemon","metadata":"{}"}]}
{"id":".dotfiles-ahf.1","title":"Add mlx-swift-lm dependency to Package.swift","description":"Add the MLXLLM package dependency from ml-explore/mlx-swift-lm. Pin to version 2.29.1 or later.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T13:17:48.114131-05:00","updated_at":"2026-01-11T14:10:07.519651-05:00","closed_at":"2026-01-11T14:10:07.519651-05:00","close_reason":"Added mlx-swift-lm as vendored dependency due to SPM cache issues. Build successful."}
{"id":".dotfiles-ahf.11","title":"Implement ShadeConfig.swift (parse config.json)","description":"Create ShadeConfig.swift that:\n1. Loads ~/.config/shade/config.json at startup\n2. Provides Codable types for all config sections\n3. Falls back to defaults if file missing\n4. Validates config values","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T13:29:27.806018-05:00","updated_at":"2026-01-11T14:11:02.988272-05:00","closed_at":"2026-01-11T14:11:02.988272-05:00","close_reason":"Created ShadeConfig.swift with LLMConfig, CaptureConfig, WindowConfig types. Includes XDG config directory support, CLI merge, and shared instance pattern."}
{"id":".dotfiles-ahf.12","title":"Create config types (ShadeConfig, LLMConfig, WindowConfig)","description":"Define Swift Codable structs:\n- ShadeConfig (root)\n- WindowConfig (width, height, padding, decorations)\n- NvimConfig (socket, command)\n- LLMConfig (enabled, backend, model, preset, auto_*, preload, idle_timeout)\n- CaptureConfig (ocr_enabled, working_directory)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T13:29:30.141245-05:00","updated_at":"2026-01-11T14:11:03.005541-05:00","closed_at":"2026-01-11T14:11:03.005541-05:00","close_reason":"Created ShadeConfig.swift with LLMConfig, CaptureConfig, WindowConfig types. Includes XDG config directory support, CLI merge, and shared instance pattern."}
{"id":".dotfiles-ahf.14","title":"Create ~/.dotfiles/home/programs/shade.nix module","description":"Create Nix home-manager module that:\n1. Adds shade flake as input to dotfiles\n2. Installs shade binary from flake\n3. Generates config.json via builtins.toJSON\n4. Creates state directory via activation script","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T13:29:32.515235-05:00","updated_at":"2026-01-11T14:35:58.004493-05:00","closed_at":"2026-01-11T14:35:58.004493-05:00","close_reason":"Moved to dotfiles repo as .dotfiles-4zt (cross-repo: config belongs in dotfiles)"}
{"id":".dotfiles-ahf.19","title":"Create project CLAUDE.md for Shade repo","description":"Create ~/code/shade/CLAUDE.md with:\n- Project overview and architecture\n- Reference to shade skill in dotfiles\n- MLX/LLM integration direction\n- Key decisions (quality-over-speed, async pipeline, config via Nix)\n- Beads epic reference (.dotfiles-ahf)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T16:02:13.055862-05:00","updated_at":"2026-01-09T16:10:23.02301-05:00","closed_at":"2026-01-09T16:10:23.02301-05:00","close_reason":"Closed"}
{"id":".dotfiles-ahf.2","title":"Create MLXInferenceEngine actor with lazy loading","description":"Implement MLXInferenceEngine.swift as a Swift actor. Load models lazily on first inference request to minimize startup time.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T13:17:48.859961-05:00","updated_at":"2026-01-11T14:52:20.454647-05:00","closed_at":"2026-01-11T14:52:20.454647-05:00","close_reason":"Closed"}
{"id":".dotfiles-ahf.20","title":"Add MLX integration decisions to MCP memory","description":"Add memory entities for key decisions:\n- Model: Qwen3-8B-Instruct-4bit (quality default)\n- Config key: 'llm' not 'mlx' (backend-agnostic)\n- Async pipeline architecture\n- Nix-managed config generation","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T16:02:14.554953-05:00","updated_at":"2026-01-09T16:10:24.273745-05:00","closed_at":"2026-01-09T16:10:24.273745-05:00","close_reason":"Cancelled per user request - context persisted via CLAUDE.md and shade skill instead"}
{"id":".dotfiles-ahf.21","title":"Update shade.md skill with LLM integration section","description":"Add new section to ~/.dotfiles/docs/skills/shade.md covering:\n- MLXInferenceEngine actor\n- Async enrichment pipeline\n- Config file schema (llm section)\n- nvim RPC methods for placeholder replacement","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T16:02:15.258079-05:00","updated_at":"2026-01-09T16:26:38.955257-05:00","closed_at":"2026-01-09T16:26:38.955257-05:00","close_reason":"Closed"}
{"id":".dotfiles-ahf.3","title":"Implement summarize() method in MLXInferenceEngine","description":"Add summarize(text:style:) method that generates concise summaries of OCR output and captured text.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T13:17:49.870302-05:00","updated_at":"2026-01-11T14:52:20.473482-05:00","closed_at":"2026-01-11T14:52:20.473482-05:00","close_reason":"Closed"}
{"id":".dotfiles-ahf.4","title":"Add --llm-backend, --llm-model, and --no-llm CLI flags","description":"Add CLI arguments to configure MLX model selection and disable MLX for Ollama fallback.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T13:17:50.792146-05:00","updated_at":"2026-01-12T09:38:42.923369-05:00","closed_at":"2026-01-12T09:38:42.923369-05:00","close_reason":"Closed"}
{"id":".dotfiles-ahf.6","title":"Implement categorize() method with context awareness","description":"Add categorize(text:context:) method that suggests tags based on OCR text and capture context (source app, URL, etc).","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T13:18:02.209609-05:00","updated_at":"2026-01-12T09:38:42.940488-05:00","closed_at":"2026-01-12T09:38:42.940488-05:00","close_reason":"Closed"}
{"id":".dotfiles-aie","title":"m8o-agent-workflow","description":"AI agent workspace task for m8o-agent-workflow","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-29T14:09:17.300965-05:00","updated_at":"2025-12-29T14:09:17.300965-05:00","labels":["agent","workspace"]}
{"id":".dotfiles-alq","title":"AI Systems Refactor: Orchestration, Skills, Agents, and Secure Remote Communication","description":"Deep refactor of AI configuration systems (.dotfiles AI infrastructure) to establish:\n\n1. **'dots' Orchestrator** - Central agent that understands the entire dotfiles ecosystem and auto-routes to specialized skills/agents\n2. **Auto-routing** - Automatic detection and delegation based on keywords (nix, hammerspoon, nvim, tmux, shade, etc.)\n3. **Specialized Skills \u0026 Agents** - Deep expertise modules for each subsystem\n4. **Secure Telegram Integration** - Real-time bidirectional communication for remote monitoring and interaction\n5. **Token Efficiency** - Reduce context bloat, improve precision, eliminate hallucinations\n6. **Cross-tool Compatibility** - Works with both claude-code and opencode\n\nResearch areas:\n- Anthropic best practices for skills/agents\n- OpenCode documentation and patterns\n- Community discoveries (X/Twitter, GitHub)\n- MCP ecosystem patterns\n- Prompt engineering research\n- Real-world production setups\n- Telegram bot security best practices","status":"open","priority":1,"issue_type":"epic","created_at":"2026-01-08T14:28:53.189939-05:00","updated_at":"2026-01-08T14:28:53.189939-05:00"}
{"id":".dotfiles-alq.1","title":"Research: Anthropic claude-code best practices for skills, agents, and memory","description":"Deep dive into Anthropic's documentation and community patterns for:\n- Skill file structure and content optimization\n- Agent definition best practices\n- Memory system usage patterns\n- Token efficiency strategies\n- When to use skills vs agents vs inline instructions\n\nSources: Anthropic docs, GitHub claude-code issues/discussions, community examples","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-08T14:29:03.583289-05:00","updated_at":"2026-01-08T15:05:01.533451-05:00","closed_at":"2026-01-08T15:05:01.533457-05:00","dependencies":[{"issue_id":".dotfiles-alq.1","depends_on_id":".dotfiles-alq","type":"parent-child","created_at":"2026-01-08T14:29:03.583924-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-alq.10","title":"Enhance /preview command with smart content rendering","description":"Improve the /preview command to be smarter about content rendering:\n\n## Current State\n- Simple fish -c wrapper showing raw command output in tmux pane\n- No markdown conversion for beads\n- Basic content type routing\n\n## Future Improvements\n- [ ] Convert beads JSON to proper markdown (headers, tables, linked deps)\n- [ ] Open markdown content in nvim for full tooling\n- [ ] Smart pane reuse (check for existing preview panes)\n- [ ] Image preview with kitty/sixel graphics protocol\n- [ ] Syntax highlighting for diff output (delta integration)\n- [ ] JSON pretty-printing with jq + bat\n- [ ] Context memory - remember last previewed item\n\n## Related\n- /preview command: docs/commands/preview.md\n- tmux skill: docs/skills/tmux.md","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-09T11:22:19.043415-05:00","updated_at":"2026-01-09T11:22:19.043415-05:00","dependencies":[{"issue_id":".dotfiles-alq.10","depends_on_id":".dotfiles-alq","type":"parent-child","created_at":"2026-01-09T11:22:19.044383-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-alq.2","title":"Research: OpenCode architecture, skills, agents, and MCP integration","description":"Deep dive into OpenCode's documentation and implementation:\n- Skill file format differences from claude-code\n- Agent spawning patterns\n- MCP server integration\n- Custom tool development\n- Configuration best practices\n\nSources: OpenCode GitHub repo, docs, issues, community examples","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-08T14:29:13.272571-05:00","updated_at":"2026-01-08T15:05:01.593349-05:00","closed_at":"2026-01-08T15:05:01.593352-05:00","dependencies":[{"issue_id":".dotfiles-alq.2","depends_on_id":".dotfiles-alq","type":"parent-child","created_at":"2026-01-08T14:29:13.27323-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-alq.3","title":"Research: Secure Telegram bot integration for AI agent communication","description":"Research secure patterns for bidirectional Telegram integration:\n- Telegram Bot API security best practices\n- Self-hosted vs cloud options\n- Authentication and authorization patterns\n- Session management for multiple concurrent AI sessions\n- End-to-end encryption considerations\n- Rate limiting and abuse prevention\n- Integration with existing ntfy notification system\n\nGoal: Enable remote monitoring and interaction with AI agents via Telegram while maintaining security","status":"in_progress","priority":1,"issue_type":"task","created_at":"2026-01-08T14:29:19.940552-05:00","updated_at":"2026-01-08T15:01:16.625074-05:00","dependencies":[{"issue_id":".dotfiles-alq.3","depends_on_id":".dotfiles-alq","type":"parent-child","created_at":"2026-01-08T14:29:19.941221-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-alq.4","title":"Research: Community patterns and production setups (Twitter/X, GitHub, forums)","description":"Gather real-world patterns from:\n- Twitter/X discussions about claude-code, cursor, windsurf, aider setups\n- GitHub repos with advanced AI tool configurations\n- Reddit r/LocalLLaMA, r/ChatGPT discussions\n- Discord communities\n- Blog posts and tutorials\n\nFocus on:\n- Token reduction strategies\n- Hallucination prevention\n- Context management\n- Multi-agent orchestration patterns\n- Real production configurations","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-08T14:29:26.089794-05:00","updated_at":"2026-01-08T14:29:26.089794-05:00","dependencies":[{"issue_id":".dotfiles-alq.4","depends_on_id":".dotfiles-alq","type":"parent-child","created_at":"2026-01-08T14:29:26.090466-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-alq.6","title":"Audit: Current ai.nix, skills, agents - identify bloat and inefficiencies","description":"Analyze current AI configuration for:\n- Redundant instructions across files\n- Overly verbose content consuming tokens\n- Missing critical guidance that causes errors\n- Inconsistencies between claude-code and opencode configs\n- Skills that should be agents (or vice versa)\n- Memory/context that could be externalized\n\nDeliverable: Audit report with specific recommendations","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T14:29:38.650876-05:00","updated_at":"2026-01-08T15:26:48.362107-05:00","closed_at":"2026-01-08T15:26:48.362107-05:00","close_reason":"Audit complete. Findings: memory.text ~2500 tokens (should be 500-800), duplicated content (ntfy, fd/rg), missing skills (cli-tools, jj, image-handling), hammerspoon-expert agent not wired up, OpenCode skills gap. Recommendations feed into alq.7 and alq.9.","dependencies":[{"issue_id":".dotfiles-alq.6","depends_on_id":".dotfiles-alq","type":"parent-child","created_at":"2026-01-08T14:29:38.651616-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-alq.7.1","title":"Create cli-tools skill (fd, rg usage for Nix store searches)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T15:27:10.09808-05:00","updated_at":"2026-01-08T15:44:01.281605-05:00","closed_at":"2026-01-08T15:44:01.281605-05:00","close_reason":"Created docs/skills/cli-tools.md with fd/rg usage guide","dependencies":[{"issue_id":".dotfiles-alq.7.1","depends_on_id":".dotfiles-alq.7","type":"parent-child","created_at":"2026-01-08T15:27:10.099012-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-alq.7.10","title":"Audit nix.md agent - verify accuracy and effectiveness","description":"Review docs/agents/nix.md for:\n- Accuracy of exploration strategies\n- Effectiveness when spawned as subagent\n- Alignment with dotfiles structure\n- Token efficiency (278 lines)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T15:48:18.496659-05:00","updated_at":"2026-01-08T16:12:13.536838-05:00","closed_at":"2026-01-08T16:12:13.536838-05:00","close_reason":"Audited nix.md agent - fixed directory structure to show ai/ subdirectory","dependencies":[{"issue_id":".dotfiles-alq.7.10","depends_on_id":".dotfiles-alq.7","type":"parent-child","created_at":"2026-01-08T15:48:18.497442-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-alq.7.11","title":"Audit hammerspoon-expert.md agent - verify accuracy and effectiveness","description":"Review docs/agents/hammerspoon-expert.md for:\n- Accuracy of Hammerspoon patterns and debugging\n- Alignment with config/hammerspoon/ structure\n- Effectiveness when spawned as subagent\n- Token efficiency (195 lines)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T15:48:20.001432-05:00","updated_at":"2026-01-08T16:12:56.743296-05:00","closed_at":"2026-01-08T16:12:56.743296-05:00","close_reason":"Audited hammerspoon-expert.md agent - updated lib/interop/ listing to reflect actual files, marked deprecated modules","dependencies":[{"issue_id":".dotfiles-alq.7.11","depends_on_id":".dotfiles-alq.7","type":"parent-child","created_at":"2026-01-08T15:48:20.002038-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-alq.7.2","title":"Create jj skill (Jujutsu workflow, commands, workspace patterns)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T15:27:10.652666-05:00","updated_at":"2026-01-08T15:44:01.352182-05:00","closed_at":"2026-01-08T15:44:01.352182-05:00","close_reason":"Created docs/skills/jj.md with Jujutsu workflow guide","dependencies":[{"issue_id":".dotfiles-alq.7.2","depends_on_id":".dotfiles-alq.7","type":"parent-child","created_at":"2026-01-08T15:27:10.653342-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-alq.7.3","title":"Create image-handling skill (resize-image, API constraints)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T15:27:11.226514-05:00","updated_at":"2026-01-08T15:44:01.420223-05:00","closed_at":"2026-01-08T15:44:01.420223-05:00","close_reason":"Created docs/skills/image-handling.md with resize-image guide","dependencies":[{"issue_id":".dotfiles-alq.7.3","depends_on_id":".dotfiles-alq.7","type":"parent-child","created_at":"2026-01-08T15:27:11.227332-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-alq.7.4","title":"Wire up hammerspoon-expert agent in ai.nix","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T15:27:11.892588-05:00","updated_at":"2026-01-08T15:44:01.489205-05:00","closed_at":"2026-01-08T15:44:01.489205-05:00","close_reason":"Wired up hammerspoon-expert.md as agent in claude-code.nix","dependencies":[{"issue_id":".dotfiles-alq.7.4","depends_on_id":".dotfiles-alq.7","type":"parent-child","created_at":"2026-01-08T15:27:11.893211-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-alq.7.6","title":"Audit nix.md skill - verify accuracy, completeness, best practices","description":"Review docs/skills/nix.md for:\n- Accuracy of commands and examples\n- Completeness of common workflows\n- Best practices alignment\n- Token efficiency (543 lines may be too long)\n- Cross-reference with actual dotfiles patterns","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T15:48:04.940632-05:00","updated_at":"2026-01-08T16:08:39.601305-05:00","closed_at":"2026-01-08T16:08:39.601305-05:00","close_reason":"Audited nix.md skill - updated directory structure to show ai/ subdirectory. All helpers verified accurate.","dependencies":[{"issue_id":".dotfiles-alq.7.6","depends_on_id":".dotfiles-alq.7","type":"parent-child","created_at":"2026-01-08T15:48:04.941669-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-alq.7.7","title":"Audit smart-ntfy.md skill - verify accuracy, completeness, best practices","description":"Review docs/skills/smart-ntfy.md for:\n- Accuracy of ntfy script options and examples\n- Completeness of notification workflows\n- Alignment with actual ~/bin/ntfy implementation\n- Token efficiency (240 lines)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T15:48:06.415534-05:00","updated_at":"2026-01-08T16:09:55.609793-05:00","closed_at":"2026-01-08T16:09:55.609793-05:00","close_reason":"Audited smart-ntfy.md skill - all claims verified accurate against ~/bin/ntfy and hammerspoon notification modules","dependencies":[{"issue_id":".dotfiles-alq.7.7","depends_on_id":".dotfiles-alq.7","type":"parent-child","created_at":"2026-01-08T15:48:06.416227-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-alq.7.8","title":"Audit web-debug.md skill - verify accuracy, completeness, best practices","description":"Review docs/skills/web-debug.md for:\n- Accuracy of Chrome DevTools MCP patterns\n- Completeness of debugging workflows\n- Best practices for browser automation\n- Token efficiency (447 lines may be too long)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T15:48:07.723052-05:00","updated_at":"2026-01-08T16:10:45.945071-05:00","closed_at":"2026-01-08T16:10:45.945071-05:00","close_reason":"Audited web-debug.md skill - patterns are accurate, tool names are conceptual (MCP handles actual prefixes). Minor note: port 9222 mention may be outdated but harmless.","dependencies":[{"issue_id":".dotfiles-alq.7.8","depends_on_id":".dotfiles-alq.7","type":"parent-child","created_at":"2026-01-08T15:48:07.723773-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-alq.7.9","title":"Audit shade.md skill - verify accuracy, completeness, best practices","description":"Review docs/skills/shade.md for:\n- Accuracy of Shade IPC/notification patterns\n- Alignment with current Shade implementation\n- Completeness of debugging workflows\n- Cross-reference with hammerspoon shade.lua","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T15:48:09.257253-05:00","updated_at":"2026-01-08T16:11:43.407691-05:00","closed_at":"2026-01-08T16:11:43.407691-05:00","close_reason":"Audited shade.md skill - fixed M.capture() to M.captureWithContext(), added missing functions","dependencies":[{"issue_id":".dotfiles-alq.7.9","depends_on_id":".dotfiles-alq.7","type":"parent-child","created_at":"2026-01-08T15:48:09.257832-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-alq.8","title":"Implement Telegram bot bridge for AI agent communication","description":"Based on research findings, implement secure Telegram integration:\n- Bot setup and configuration\n- Bridge service (likely a small daemon)\n- Session tracking for multiple concurrent AI sessions\n- Integration with ntfy for unified notification routing\n- Security hardening\n- Nix packaging for the service\n\nDeliverable: Working Telegram bot that enables bidirectional AI communication","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-08T14:29:50.814787-05:00","updated_at":"2026-01-08T14:29:50.814787-05:00","dependencies":[{"issue_id":".dotfiles-alq.8","depends_on_id":".dotfiles-alq","type":"parent-child","created_at":"2026-01-08T14:29:50.815456-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-alq.9.1","title":"Trim memory.text - remove duplicated content (ntfy, fd/rg examples)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T15:27:18.197295-05:00","updated_at":"2026-01-08T15:44:07.028012-05:00","closed_at":"2026-01-08T15:44:07.028012-05:00","close_reason":"Trimmed memory.text from ~174 lines to ~60 lines by extracting to skills","dependencies":[{"issue_id":".dotfiles-alq.9.1","depends_on_id":".dotfiles-alq.9","type":"parent-child","created_at":"2026-01-08T15:27:18.198005-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-als","title":"hs-memory-leaks","description":"AI agent workspace task for hs-memory-leaks","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T13:41:56.432402-05:00","updated_at":"2026-01-02T10:13:54.428938-05:00","closed_at":"2026-01-02T10:13:54.428938-05:00","close_reason":"Fixed hyper.lua:stop() using wrong key for _G.Hypers cleanup. No major memory leaks found - watchers/timers have proper cleanup, state.lua has good reset patterns. Minor: S.hypers exists but unused (relates to uho task).","labels":["agent","workspace"]}
{"id":".dotfiles-b3r","title":"Improve function naming for clarity","description":"Several unclear function names: M.toggle() - toggle what?; findWindowByTitle() returns single window not list; tableCount() should use stdlib. Rename for intention-revealing names per clean code principles.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-27T18:03:00.429094-05:00","updated_at":"2025-12-27T18:03:00.429094-05:00","labels":["code-quality","hammerspoon"]}
{"id":".dotfiles-bww","title":"Fix nested timer accumulation in dismissNotification","description":"In notifier.lua:279-301, nested hs.timer.doAfter inside doUntil can orphan timers when dismissNotification is called rapidly. Store reference and cancel previous before creating new. Location: lib/notifications/notifier.lua dismissNotification()","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T18:02:17.898907-05:00","updated_at":"2025-12-29T15:15:12.972911-05:00","closed_at":"2025-12-29T15:15:12.972911-05:00","close_reason":"Fixed in commit pushed to main - nested timer accumulation resolved by centralizing notification state with S.notification","labels":["hammerspoon","memory-leak"]}
{"id":".dotfiles-c4d","title":"Create workspace management scripts (jj-ws-*)","description":"Create helper scripts for common workspace operations:\n\nScripts needed:\n1. **jj-ws-new** - Create new workspace with standard naming/location\n   - Args: workspace-name, optional base-revision\n   - Creates at ../$REPO-$NAME (outside repo tree to avoid issues)\n   - Sets up bead context for the workspace\n   \n2. **jj-ws-list** - Enhanced workspace listing\n   - Shows workspace name, path, current commit, stale status\n   - Integrates with bead to show associated epic/task\n   \n3. **jj-ws-cleanup** - Clean up completed workspace\n   - Forgets workspace\n   - Removes directory\n   - Updates bead task status if linked\n\n4. **jj-ws-switch** - Quick workspace switching\n   - Tab completion for workspace names\n   - Updates shell prompt/statusline\n\nLocation: ~/bin/ (already in PATH via nix)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T08:44:29.43327-05:00","updated_at":"2025-12-29T13:32:48.819327-05:00","closed_at":"2025-12-29T13:32:48.819327-05:00","close_reason":"Created fish functions: jj-ws-new, jj-ws-switch, jj-ws-list, jj-ws-rm in home/programs/fish.nix","labels":["dx","jj","scripts","workspace"],"dependencies":[{"issue_id":".dotfiles-c4d","depends_on_id":".dotfiles-20n","type":"blocks","created_at":"2025-12-29T08:44:29.443536-05:00","created_by":"daemon","metadata":"{}"}]}
{"id":".dotfiles-ca8","title":"[Phase 3] Verify obsidian.nvim backlinks work","description":"Test obsidian.nvim backlinks between capture notes and daily notes. Verify navigation works.","status":"closed","priority":2,"issue_type":"task","estimated_minutes":15,"created_at":"2025-12-26T10:35:59.557261-05:00","updated_at":"2025-12-26T20:50:13.101087-05:00","closed_at":"2025-12-26T20:50:13.101087-05:00","close_reason":"Verified and enhanced. Added note_frontmatter_func to preserve capture metadata, picker tag mappings, smart gf/\u003ccr\u003e mappings, and unified gr keybinding for tags/links/LSP references.","labels":["nvim","obsidian","phase-3"],"dependencies":[{"issue_id":".dotfiles-ca8","depends_on_id":".dotfiles-8uo","type":"blocks","created_at":"2025-12-26T10:35:59.558086-05:00","created_by":"daemon","metadata":"{}"}]}
{"id":".dotfiles-cb1","title":"Investigate GPG signed commits not working","description":"GPG signed commits were working in the archived dotfiles-nix repo but are not working in this repo (.dotfiles).\n\nNeed to investigate:\n- Compare git config between repos (user.signingkey, commit.gpgsign, gpg.program)\n- Check if GPG key is still valid and available\n- Verify gpg-agent is running and configured correctly\n- Check if 1Password SSH agent integration is interfering\n- Compare .gitconfig or home-manager git module settings\n- Test with git log --show-signature on old repo vs this one\n\nReference: Previous working config was in dotfiles-nix repo (now archived)","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-29T09:53:50.215454-05:00","updated_at":"2026-01-03T12:27:10.012071-05:00","closed_at":"2026-01-03T12:27:10.012071-05:00","close_reason":"GPG signing was working all along - just needed allowedSignersFile for verification. Added via home.file.text in home/default.nix","labels":["git","gpg"]}
{"id":".dotfiles-cgn","title":"Image capture intelligence: OCR + AI summarization pipeline","description":"Enhance image captures with automatic text extraction and AI-powered summarization.\n\n## Pipeline\n1. Screenshot captured via clipper.lua\n2. Image saved to assets/\n3. Capture note created in Shade\n4. Apple Vision extracts text (OCR)\n5. Local LLM (Ollama) summarizes/categorizes\n6. Content injected into capture note\n\n## Goals\n- Use Apple Vision Framework for OCR (native, fast, accurate)\n- Use Ollama for local LLM inference (no cloud tokens)\n- Optimize model selection for M2 Max\n- Make OCR/summarization optional/configurable\n- Integrate cleanly with existing capture flow\n\n## Ownership\nShade owns this - native Vision access, can call Ollama HTTP API, already handles capture flow.\n\n## Existing Work\n- ~/bin/vision-ocr script exists\n- notes.lua has M.ocr_image_on_line() using vision-ocr\n- Phase 6 stub: M.summarize_image_on_line()\n\n## Configuration\n- --ocr-on-capture (auto-OCR new image captures)\n- --summarize-on-capture (auto-summarize with LLM)\n- Or manual trigger from nvim","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-01-08T16:57:58.761635-05:00","updated_at":"2026-01-09T13:18:26.797921-05:00","closed_at":"2026-01-09T13:18:26.797921-05:00"}
{"id":".dotfiles-cgn.1","title":"Setup Ollama with optimal models for M2 Max","description":"Configure Ollama for local LLM inference on M2 Max (32GB).\n\n## Recommended Models\n\n### For Vision/Multimodal (can see images directly):\n- **llava:13b** - Best quality, fits in 32GB\n- **llava:7b** - Faster, still good\n- **bakllava** - Alternative vision model\n\n### For Text Summarization:\n- **llama3.2:latest** - Excellent for summarization\n- **mistral:latest** - Fast, good quality\n- **phi3:medium** - Compact but capable\n\n## Setup Steps\n1. Ensure ollama runs on login (launchd or nix service)\n2. Pull recommended models: ollama pull llava:13b\n3. Test with sample image\n\n## Nix Integration\nAdd to home-manager or darwin config for auto-start.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-08T17:00:51.26437-05:00","updated_at":"2026-01-09T13:18:26.817868-05:00","closed_at":"2026-01-09T13:18:26.817868-05:00","dependencies":[{"issue_id":".dotfiles-cgn.1","depends_on_id":".dotfiles-cgn","type":"parent-child","created_at":"2026-01-08T17:00:51.265125-05:00","created_by":"seth","metadata":"{}"},{"issue_id":".dotfiles-cgn.1","depends_on_id":".dotfiles-h0a","type":"blocks","created_at":"2026-01-09T11:33:51.534721-05:00","created_by":"seth","metadata":"{}"},{"issue_id":".dotfiles-cgn.1","depends_on_id":".dotfiles-kjx","type":"blocks","created_at":"2026-01-09T11:33:52.274626-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-cgn.2","title":"Implement VisionKit OCR in Shade (Swift)","description":"Use Apple Vision Framework for native OCR in Shade.\n\n## Implementation\n- Create VisionOCR.swift actor\n- Use VNRecognizeTextRequest for text extraction\n- Support multiple languages\n- Return structured text with confidence scores\n\n## API\n```swift\nactor VisionOCR {\n    func extractText(from imagePath: String) async throws -\u003e OCRResult\n}\n\nstruct OCRResult {\n    let text: String\n    let blocks: [TextBlock]  // For layout-aware extraction\n    let confidence: Double\n}\n```\n\n## Integration Points\n- Called after image capture in handleImageCaptureNotification\n- Results written to context.json or injected via nvim RPC","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-08T17:00:56.474884-05:00","updated_at":"2026-01-09T13:18:26.840298-05:00","closed_at":"2026-01-09T13:18:26.840298-05:00","dependencies":[{"issue_id":".dotfiles-cgn.2","depends_on_id":".dotfiles-cgn","type":"parent-child","created_at":"2026-01-08T17:00:56.475525-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-cgn.3","title":"Implement Ollama client in Shade for summarization","description":"HTTP client to call local Ollama API for AI summarization.\n\n## Implementation\n- Create OllamaClient.swift actor\n- Use URLSession for HTTP calls to localhost:11434\n- Support both text and vision models\n\n## API\n```swift\nactor OllamaClient {\n    func summarize(text: String, model: String = \"llama3.2\") async throws -\u003e String\n    func analyzeImage(imagePath: String, prompt: String, model: String = \"llava:13b\") async throws -\u003e String\n}\n```\n\n## Endpoints Used\n- POST /api/generate - for text summarization\n- POST /api/generate with images - for vision models","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T17:01:00.563169-05:00","updated_at":"2026-01-09T13:18:26.876364-05:00","closed_at":"2026-01-09T13:18:26.876364-05:00","dependencies":[{"issue_id":".dotfiles-cgn.3","depends_on_id":".dotfiles-cgn","type":"parent-child","created_at":"2026-01-08T17:01:00.56387-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-cgn.4","title":"Wire up OCR+AI pipeline in image capture flow","description":"Integrate VisionOCR and OllamaClient into handleImageCaptureNotification.\n\n## Flow\n1. Image captured, note created\n2. If --ocr-on-capture: run VisionOCR.extractText()\n3. If --summarize-on-capture: run OllamaClient.summarize() or analyzeImage()\n4. Inject results into note via nvim RPC (append to buffer or update frontmatter)\n\n## CLI Flags\n- --ocr-on-capture (default: false)\n- --summarize-on-capture (default: false)\n- --ocr-model (for future: whisper-like models)\n- --summarize-model (default: llama3.2)\n- --vision-model (default: llava:13b)\n\n## UX Considerations\n- Show progress indicator in menubar?\n- Non-blocking: capture note appears immediately, AI content streams in","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T17:01:06.57441-05:00","updated_at":"2026-01-09T13:18:26.897999-05:00","closed_at":"2026-01-09T13:18:26.897999-05:00","dependencies":[{"issue_id":".dotfiles-cgn.4","depends_on_id":".dotfiles-cgn","type":"parent-child","created_at":"2026-01-08T17:01:06.575191-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-cgn.5","title":"Add manual OCR/summarize commands via ShadeServer RPC","description":"Allow nvim to trigger OCR/summarization on demand via shade.sock RPC.\n\n## New RPC Methods\n- ocr(imagePath) -\u003e returns extracted text\n- summarize(text) -\u003e returns AI summary  \n- analyze_image(imagePath, prompt) -\u003e returns vision model response\n\n## nvim Integration (shade.lua)\n```lua\nlocal shade = require('shade')\nlocal text = shade.ocr('/path/to/image.png')\nlocal summary = shade.summarize(text)\nlocal analysis = shade.analyze_image('/path/to/image.png', 'What is in this image?')\n```\n\n## Keybindings (notes.lua)\n- \u003clocalleader\u003eio - OCR image on line (already exists, update to use Shade RPC)\n- \u003clocalleader\u003eis - Summarize image on line (currently stub)","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-08T17:01:12.400625-05:00","updated_at":"2026-01-09T13:18:26.921807-05:00","closed_at":"2026-01-09T13:18:26.921807-05:00","dependencies":[{"issue_id":".dotfiles-cgn.5","depends_on_id":".dotfiles-cgn","type":"parent-child","created_at":"2026-01-08T17:01:12.401311-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-ckn","title":"[Phase 4] User testing and real-world usage validation","description":"Use the Notes \u0026 Capture System in daily workflow. Test:\n- Text capture from browser (verify app name, window title, language in frontmatter)\n- Text capture from terminal/nvim\n- Image capture flow\n- Daily note linking (verify no duplicates, proper formatting)\n- obsidian.nvim backlinks navigation\n- Unified gr keybinding (tags vs links vs LSP)\n- Smart \u003ccr\u003e and gf mappings\n\nReport any issues found for Phase 5 fixes.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T20:54:01.167553-05:00","updated_at":"2026-01-01T17:32:34.035637-05:00","closed_at":"2026-01-01T17:32:34.035637-05:00","close_reason":"Phase 4 testing complete - moving to Phase 5 cleanup","labels":["phase-4","testing"]}
{"id":".dotfiles-cwn","title":"Fix application watcher never stopped on reload","description":"In lib/notifications/notifier.lua:316-333, the application watcher is started on module load but never stopped. Add stop logic to cleanup function and call it before hs.reload(). Location: notifier.lua setupAppWatcher()","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T18:02:16.760137-05:00","updated_at":"2025-12-29T15:15:14.773337-05:00","closed_at":"2025-12-29T15:15:14.773337-05:00","close_reason":"Fixed in commit pushed to main - application watcher now properly stopped on reload via cleanup hook","labels":["critical","hammerspoon","memory-leak"]}
{"id":".dotfiles-d1e","title":"[Nix] Document app installation routing criteria","description":"## Problem\nThree app installation methods with unclear routing:\n1. Homebrew Cask (modules/brew.nix)\n2. mkApp Custom (home/packages.nix customApps)\n3. nixpkgs (home/packages.nix)\n\nExample confusion: Spotify is in nixpkgs but also commented out in brew.nix. Why?\n\n## Solution\nAdd documentation header to modules/brew.nix explaining criteria:\n- MAS: App Store exclusives only\n- Homebrew: Has official cask, standard install\n- mkApp: Needs custom fetch (nightly, beta)\n- nixpkgs: Available in nixpkgs, no special handling\n\nAlso resolve Spotify ambiguity.\n\n## Files to modify\n- EDIT: modules/brew.nix (add documentation header)\n- OPTIONAL: home/packages.nix (add comment)\n\n## Acceptance criteria\n- [ ] Clear routing criteria documented\n- [ ] Spotify anomaly resolved/documented","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T08:00:34.405412-05:00","updated_at":"2026-01-14T08:00:34.405412-05:00","dependencies":[{"issue_id":".dotfiles-d1e","depends_on_id":".dotfiles-795","type":"blocks","created_at":"2026-01-14T08:00:39.638451-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-d5b","title":"Bidirectional RPC: Nvim-to-Shade communication","description":"Enable nvim (and other processes running inside shade) to call back to shade via RPC.\n\n## Motivation\nCurrently communication is one-way:\n- Hammerspoon/Shell → Shade (distributed notifications)\n- Shade → Nvim (msgpack-rpc socket)\n\nBut nvim cannot easily communicate back to shade (only via shell-out to swift).\n\n## Goals\n- Shade listens on its own RPC socket (~/.local/state/shade/shade.sock)\n- Nvim can connect and call shade methods\n- Provide a nvim Lua module for easy integration\n\n## Use Cases\n1. Nvim tells shade to hide after :wq (without relying on process exit detection)\n2. Nvim requests the capture context directly\n3. Nvim triggers shade to gather fresh context from frontmost app\n4. Custom nvim commands that interact with shade\n\n## API Design (tentative)\n```lua\n-- In nvim\nlocal shade = require('shade')\nshade.hide()\nshade.show()\nshade.toggle()\nlocal ctx = shade.get_context()\nshade.notify('Custom message')\n```\n\n## Dependencies\n- .dotfiles-plf epic (native msgpack-rpc infrastructure)\n\n## References\n- .dotfiles-plf: Native msgpack-rpc client for nvim","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-08T08:41:28.572956-05:00","updated_at":"2026-01-08T15:04:26.310846-05:00","closed_at":"2026-01-08T15:04:26.310846-05:00","close_reason":"Implemented bidirectional RPC: ShadeServer.swift, shade.lua nvim module, tests"}
{"id":".dotfiles-d5b.1","title":"Shade listens on shade.sock as msgpack-rpc server","description":"Add a second socket (shade.sock) where Shade acts as the SERVER, not client. Nvim and other processes can connect and send commands.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-08T14:56:21.510937-05:00","updated_at":"2026-01-08T15:00:14.430992-05:00","closed_at":"2026-01-08T15:00:14.430992-05:00","close_reason":"Implemented ShadeServer.swift - listens on shade.sock","dependencies":[{"issue_id":".dotfiles-d5b.1","depends_on_id":".dotfiles-d5b","type":"parent-child","created_at":"2026-01-08T14:56:21.511946-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-d5b.2","title":"Implement Shade RPC methods: hide, show, toggle, get_context","description":"Handle incoming RPC requests from nvim. Methods: hide(), show(), toggle(), get_context() -\u003e returns current capture context.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-08T14:56:23.082052-05:00","updated_at":"2026-01-08T15:00:15.236581-05:00","closed_at":"2026-01-08T15:00:15.236581-05:00","close_reason":"Implemented hide, show, toggle, get_context, ping methods","dependencies":[{"issue_id":".dotfiles-d5b.2","depends_on_id":".dotfiles-d5b","type":"parent-child","created_at":"2026-01-08T14:56:23.082699-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-d5b.3","title":"Create nvim Lua module: shade.nvim","description":"Lua module that connects to shade.sock and provides: require('shade').hide(), .show(), .toggle(), .get_context(). Lives in dotfiles nvim config.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T14:56:24.412741-05:00","updated_at":"2026-01-08T15:04:04.86721-05:00","closed_at":"2026-01-08T15:04:04.86721-05:00","close_reason":"Created shade.lua nvim module with hide/show/toggle/ping/get_context","dependencies":[{"issue_id":".dotfiles-d5b.3","depends_on_id":".dotfiles-d5b","type":"parent-child","created_at":"2026-01-08T14:56:24.413461-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-d5b.4","title":"Wire up persistent nvim: QuitPre calls shade.hide()","description":"In notes.lua, the QuitPre autocmd calls require('shade').hide() instead of relying on process exit. This completes the persistent nvim flow.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T14:56:25.925858-05:00","updated_at":"2026-01-08T15:04:06.283927-05:00","closed_at":"2026-01-08T15:04:06.283927-05:00","close_reason":"shade.setup() in notes.lua wires up QuitPre to call shade.hide()","dependencies":[{"issue_id":".dotfiles-d5b.4","depends_on_id":".dotfiles-d5b","type":"parent-child","created_at":"2026-01-08T14:56:25.926525-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-d8h","title":"[Phase 2] Create lib/interop/selection.lua wrapper","description":"Lua wrapper for bin/get-selection. Call via hs.task.new(), parse JSON, handle errors gracefully.","status":"closed","priority":1,"issue_type":"task","estimated_minutes":30,"created_at":"2025-12-26T10:35:59.258017-05:00","updated_at":"2025-12-26T11:07:28.416287-05:00","closed_at":"2025-12-26T11:07:28.416287-05:00","close_reason":"Created lib/interop/selection.lua wrapper with async callback API","labels":["hammerspoon","lua","phase-2"],"dependencies":[{"issue_id":".dotfiles-d8h","depends_on_id":".dotfiles-vd5","type":"blocks","created_at":"2025-12-26T10:35:59.258897-05:00","created_by":"daemon","metadata":"{}"}]}
{"id":".dotfiles-dat","title":"Document MegaNote project","description":"Create comprehensive documentation for MegaNote:\n- README.md with project overview, architecture, usage\n- justfile with build/dev/clean tasks\n- Document libghostty integration gotchas\n- Document Hammerspoon IPC protocol\n- Installation instructions","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T12:45:30.513253-05:00","updated_at":"2025-12-30T12:59:14.328792-05:00","closed_at":"2025-12-30T12:59:14.328792-05:00","close_reason":"Updated README with CLI architecture, release builds, justfile targets; added flake.nix for Nix packaging","labels":["meganote documentation"]}
{"id":".dotfiles-ddn","title":"Migrate jj workspace workflow to global agent awareness","description":"After validating the jj workspace workflow in .dotfiles:\n\n1. Update global CLAUDE.md (~/.claude/CLAUDE.md) with workflow rules\n2. Create global skill accessible from any project\n3. Ensure OpenCode and other AI tools can use the workflow\n4. Document how to enable workspace workflow in new repos\n\nThis is the final migration step after all other epic tasks are validated.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-29T12:04:29.039411-05:00","updated_at":"2025-12-29T12:04:29.039411-05:00","labels":["ai-workflow","global","migration"],"dependencies":[{"issue_id":".dotfiles-ddn","depends_on_id":".dotfiles-20n","type":"blocks","created_at":"2025-12-29T12:04:29.044827-05:00","created_by":"daemon","metadata":"{}"}]}
{"id":".dotfiles-dlr","title":"Add cleanup methods to notifier module","description":"Add M.cleanup() function to lib/notifications/notifier.lua that stops _G.notificationAppWatcher, deletes _G.notificationOverlay canvas, and clears all timer references. Critical for preventing memory leaks on reload.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T18:02:15.598605-05:00","updated_at":"2025-12-29T15:15:15.9319-05:00","closed_at":"2025-12-29T15:15:15.9319-05:00","close_reason":"Fixed in commit pushed to main - notifier module now has proper cleanup methods called on reload","labels":["critical","hammerspoon","memory-leak"]}
{"id":".dotfiles-dm7","title":"Notes \u0026 Capture System","description":"Unified note-taking and capture system integrating Hammerspoon, Neovim (obsidian.nvim), and a floating Kitty terminal window for seamless capture workflows across the system.\n\nGoals:\n- Quick capture of text/ideas from anywhere on the system\n- Context-aware capture (grab selected text + source metadata without clipboard pollution)\n- Floating notes window that persists and toggles cleanly\n- Integration with daily notes via obsidian.nvim\n\nArchitecture:\n- Floating notes terminal: Kitty with persistent nvim session\n- Main terminal: Ghostty (tmux) - unchanged\n- Window management: Hammerspoon toggle with previousApp restore\n- Context capture: Swift script via Accessibility API (no clipboard)\n- Note storage: Obsidian vault with obsidian.nvim","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-26T10:34:58.50616-05:00","updated_at":"2025-12-27T17:36:01.618571-05:00","closed_at":"2025-12-27T17:36:01.618571-05:00","close_reason":"Core features complete. Capture system fully functional: persistent nvim session, clipboard-free selection via Accessibility API, text/image capture workflows, daily note integration, obsidian.nvim backlinks. Phase 5 polish tasks remain open for future refinement.","labels":["hammerspoon","notes","nvim","obsidian"]}
{"id":".dotfiles-dmm","title":"Text capture should position cursor below frontmatter ready to type","description":"After creating a quick text capture note, the cursor should be positioned just below the YAML frontmatter, ready for the user to start typing immediately.\n\nCurrently the cursor position after template expansion is unclear/inconsistent.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T15:47:13.989394-05:00","updated_at":"2026-01-08T16:33:22.439773-05:00","closed_at":"2026-01-08T16:33:22.439773-05:00","close_reason":"Implemented via execLua after template creation - positions cursor below frontmatter in insert mode"}
{"id":".dotfiles-e35","title":"Pull recommended Ollama models for M2 Max","description":"Pull the recommended models for image summarization on M2 Max (32GB).\n\n## Recommended Models\n\n### For Vision/Multimodal:\n- llava:13b - Best quality vision model\n- bakllava - Alternative\n\n### For Text Summarization:\n- llama3.2:latest - Great for summarization\n- mistral:latest - Fast, good quality\n\n## Steps\n```bash\nollama pull llava:13b\nollama pull llama3.2:latest\n```\n\n## Note\nCould add a script to ~/bin/ or nix activation to ensure models are pulled on new machines.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T11:33:30.930076-05:00","updated_at":"2026-01-09T11:35:07.514188-05:00","closed_at":"2026-01-09T11:35:07.514188-05:00","close_reason":"Already done - llava:13b and llama3.2:latest already pulled","dependencies":[{"issue_id":".dotfiles-e35","depends_on_id":".dotfiles-h0a","type":"blocks","created_at":"2026-01-09T11:34:16.46148-05:00","created_by":"seth"}]}
{"id":".dotfiles-ex2","title":"nvim-socket-fallback","description":"AI agent workspace task for nvim-socket-fallback","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T15:38:58.815043-05:00","updated_at":"2025-12-30T16:01:18.821702-05:00","closed_at":"2025-12-30T16:01:18.821702-05:00","close_reason":"Implemented global_{pid} socket fallback for non-tmux nvim instances. Detection cascade: tmux → frontmost app → most recent global socket.","labels":["agent","workspace"]}
{"id":".dotfiles-fdx","title":"Add LaunchDaemon to increase maxfiles limit for nix builds","description":"Nix builds fail with 'Too many open files' due to macOS default maxfiles limit of 256.\n\nRoot Cause:\n- macOS launchctl soft limit defaults to 256\n- Complex nix evaluations open many files (git packfiles, store paths)\n- No declarative kernel parameter config on modern macOS\n\nSolution:\n- Create LaunchDaemon via nix-darwin that runs 'launchctl limit maxfiles 524288 524288' at boot\n- This is Apple's officially recommended approach (no alternative exists)\n\nImplementation:\n- Add launchd.daemons.limit-maxfiles to modules/system.nix\n- Set both soft and hard limits to 524288 (512K)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T09:32:41.433874-05:00","updated_at":"2025-12-29T09:33:30.977042-05:00","closed_at":"2025-12-29T09:33:30.977042-05:00","close_reason":"Implemented in modules/system.nix - creates LaunchDaemon that sets maxfiles to 524288 at boot","labels":["darwin","dx","launchd","nix"]}
{"id":".dotfiles-gc6","title":"shade-ctl: CLI helper for shell integration","description":"Create a lightweight CLI tool (or shade subcommands) for easy shell integration.\n\n## Motivation\nCurrently, sending commands to shade from shell requires a verbose Swift one-liner:\n```bash\nswift -e 'import Foundation; DistributedNotificationCenter.default().post(name: NSNotification.Name(\"io.shade.toggle\"), object: nil)'\n```\n\n## Goals\n- Simple CLI interface for all shade IPC commands\n- Fast execution (no Swift compilation overhead)\n- Tab completion support\n\n## Design Options\n\n### Option A: Separate shade-ctl binary\n```bash\nshade-ctl toggle\nshade-ctl show\nshade-ctl hide\nshade-ctl quit\nshade-ctl capture [--context file.json]\nshade-ctl daily\nshade-ctl status  # Check if shade is running\n```\n\n### Option B: Subcommands in shade itself\n```bash\nshade ctl toggle\nshade ctl capture\n# or\nshade --send toggle\nshade --send capture\n```\n\n### Option C: Shell functions (no new binary)\n```bash\n# In .zshrc\nshade-toggle() { swift -e '...' }\n```\n\n## Implementation Notes\n- Could be a small Swift CLI that just sends notifications\n- Or a shell script wrapper\n- Consider using osascript for faster execution than swift -e\n\n## Dependencies\nNone (standalone)","status":"open","priority":3,"issue_type":"epic","created_at":"2026-01-08T08:41:40.059706-05:00","updated_at":"2026-01-08T08:41:40.059706-05:00"}
{"id":".dotfiles-h0a","title":"Install Ollama via brew.nix","description":"Add Ollama to homebrew packages in ~/.dotfiles/modules/brew.nix\n\nOllama provides local LLM inference. Needed by Shade for image summarization pipeline (shade-cgn).\n\n## Steps\n1. Add 'ollama' to brew.nix casks\n2. Run just rebuild\n3. Verify: ollama --version","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T11:33:30.681621-05:00","updated_at":"2026-01-09T11:34:59.079948-05:00","closed_at":"2026-01-09T11:34:59.079948-05:00","close_reason":"Already done - Ollama installed via Nix in home/programs/ai/ollama.nix"}
{"id":".dotfiles-hr2","title":"Split watchers/notification.lua into smaller modules","description":"notification.lua (825 lines) has too many responsibilities. Split into: notification-observer.lua (AX observer), notification-matcher.lua (rule matching), notification-actions.lua (dismiss/redirect). Each module should have single responsibility.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-27T18:03:11.640881-05:00","updated_at":"2025-12-27T18:03:11.640881-05:00","labels":["architecture","hammerspoon","refactor"]}
{"id":".dotfiles-isv","title":"Remove width/height args from shade.configure() - use Shade defaults","description":"After shade implements dynamic panel sizing (shade hardcodes sizes per notification type), remove the width/height arguments from bindings.lua shade.configure() call.\n\nShade will handle sizing internally based on daily vs capture notifications.\n\nDepends on: Shade dynamic sizing feature (.dotfiles-58f)","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-08T16:09:11.473257-05:00","updated_at":"2026-01-08T16:09:11.473257-05:00","labels":["dotfiles"]}
{"id":".dotfiles-ivz","title":"[Phase 5] Error handling and edge cases","description":"Handle: Kitty not installed, nvim socket unresponsive, get-selection fails, directory not writable, window stuck state. Add logging and graceful degradation.","status":"open","priority":3,"issue_type":"task","estimated_minutes":60,"created_at":"2025-12-26T10:35:59.870144-05:00","updated_at":"2025-12-26T10:35:59.870144-05:00","labels":["hammerspoon","phase-5","polish"],"dependencies":[{"issue_id":".dotfiles-ivz","depends_on_id":".dotfiles-ca8","type":"blocks","created_at":"2025-12-26T10:35:59.871088-05:00","created_by":"daemon","metadata":"{}"},{"issue_id":".dotfiles-ivz","depends_on_id":".dotfiles-ckn","type":"blocks","created_at":"2025-12-26T20:54:09.575095-05:00","created_by":"daemon","metadata":"{}"}]}
{"id":".dotfiles-j47","title":"hs-slow-reload","description":"AI agent workspace task for hs-slow-reload","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T14:13:46.552286-05:00","updated_at":"2026-01-02T10:02:30.509722-05:00","closed_at":"2026-01-02T10:02:30.509722-05:00","close_reason":"Eliminated window filter from scratchpad.lua by refactoring: created lib/interop/kitty.lua, lib/notes/window.lua, moved meganote to interop/, deleted scratchpad.lua (712 lines). See commit e0858fa.","labels":["agent","workspace"]}
{"id":".dotfiles-jod","title":"[Future] Create Neovide-based toggle as Kitty alternative","description":"Native macOS window alternative to Kitty terminal. Neovide already installed. Compare reliability and performance.","status":"closed","priority":4,"issue_type":"feature","estimated_minutes":120,"created_at":"2025-12-26T10:35:59.973888-05:00","updated_at":"2025-12-26T15:14:02.918563-05:00","closed_at":"2025-12-26T15:14:02.918563-05:00","close_reason":"Abandoned after testing - neovide socket reliability issues, sticking with Kitty","labels":["future","neovide"]}
{"id":".dotfiles-kcj","title":"[Nix] Create lib/paths.nix - centralize path definitions","description":"## Problem\nPath definitions are duplicated between hosts/megabookpro.nix and home/default.nix:\n- hosts/megabookpro.nix:16-17: `icloud_home`, `proton_home`\n- home/default.nix:15-18: Same paths + `notes_home`, `nvim_db_home`\n\nComment in home/default.nix:14 says \"mirroring hosts/megabookpro.nix\" - acknowledging the DRY violation.\n\n## Solution\nCreate lib/paths.nix with all path definitions, import in both files.\n\n## Files to modify\n- NEW: lib/paths.nix\n- EDIT: hosts/megabookpro.nix (use paths from lib/)\n- EDIT: home/default.nix (use paths from lib/)\n\n## Acceptance criteria\n- [ ] All path definitions in ONE place\n- [ ] Both files import from lib/paths.nix\n- [ ] darwin-rebuild succeeds\n- [ ] Hammerspoon nix_path.lua still generates correctly","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-14T08:00:34.191152-05:00","updated_at":"2026-01-14T08:00:34.191152-05:00"}
{"id":".dotfiles-kjx","title":"Configure Ollama launchd service for auto-start","description":"Set up Ollama to run on login via homebrew services.\n\n## Steps\n1. After installing ollama cask: brew services start ollama\n2. Or add to launchServices in darwin config\n\n## Goal\nOllama server should be running whenever the machine is on, so Shade can call it for summarization.\n\n## Related\n- shade-cgn.1 depends on this","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T11:33:30.806582-05:00","updated_at":"2026-01-09T11:34:59.875329-05:00","closed_at":"2026-01-09T11:34:59.875329-05:00","close_reason":"Already done - launchd agent configured in ollama.nix with RunAtLoad and KeepAlive"}
{"id":".dotfiles-lp4","title":"Extract magic numbers to config.lua","description":"Multiple magic numbers in code: minHeight=100, maxHeight=400 in notifier.lua; depth limits of 6 and 8 in notification.lua tree traversal. Move to C.notifier.canvas.* and C.notifier.axTreeMaxDepth.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-27T18:02:44.2798-05:00","updated_at":"2025-12-27T18:02:44.2798-05:00","labels":["hammerspoon","maintainability"]}
{"id":".dotfiles-m8o","title":"Define AI agent workspace workflow rules for CLAUDE.md","description":"Add comprehensive workspace workflow rules to CLAUDE.md for AI agents:\n\nRules to document:\n\n1. **Workspace Awareness**\n   - Check if in a workspace at session start\n   - Understand workspace isolation scope\n   - Know which files are shared vs isolated\n\n2. **Pre-Work Protocol**\n   - Check jj workspace list for context\n   - Check for stale workspace state\n   - Identify linked bead task\n\n3. **During Work**\n   - Stay within workspace scope\n   - Don't modify shared configs unless intentional\n   - Use jj commands exclusively (no git in workspaces)\n\n4. **Conflict Avoidance**\n   - Communicate intent before touching shared files\n   - Check if another workspace is modifying same area\n   - Prefer narrower file scopes\n\n5. **Handoff Protocol**\n   - Document work state before leaving workspace\n   - Update bead task status\n   - Note any pending conflicts for resolution\n\n6. **Merge Protocol**\n   - When workspace work is complete\n   - How to rebase onto main\n   - How to handle conflicts\n\nInclude concrete examples and error recovery procedures.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-29T08:44:58.431147-05:00","updated_at":"2025-12-29T08:44:58.431147-05:00","labels":["ai-workflow","claude","documentation","workspace"],"dependencies":[{"issue_id":".dotfiles-m8o","depends_on_id":".dotfiles-20n","type":"blocks","created_at":"2025-12-29T08:44:58.441398-05:00","created_by":"daemon","metadata":"{}"}]}
{"id":".dotfiles-mkm","title":"Image capture context enrichment via recognition/OCR","description":"Enhance image captures with intelligent context extraction:\n\n- Detect frontmost app when screenshot is taken (app name, window title)\n- OCR text visible in the screenshot for searchable content\n- Image classification/summarization for descriptive filenames\n- Pass enriched context to the capture note frontmatter\n\nThis would enable smarter naming like '20251226-1730-github-pr-review.png' instead of generic timestamps, and make captures more searchable via extracted text.","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-26T17:40:03.974062-05:00","updated_at":"2025-12-26T17:40:03.974062-05:00","labels":["phase-6"]}
{"id":".dotfiles-n5m","title":"Add sparse checkout patterns for large repos","description":"Document and implement sparse checkout patterns for workspace efficiency:\n\nUse Cases:\n- Monorepo with multiple packages\n- Large repos where agents only need subset of files\n- Performance optimization for workspace creation\n\nJJ Sparse Commands:\n- jj workspace add --sparse-patterns=empty - Start empty\n- jj sparse set --add 'path/to/dir/**' - Add specific paths\n- jj sparse list - View current patterns\n\nPattern Examples for Dotfiles:\n- config/hammerspoon/** - Just Hammerspoon work\n- home/programs/** - Just home-manager configs\n- modules/** - Just nix-darwin modules\n\nDocumentation:\n- When to use sparse workspaces\n- Pattern syntax\n- Caveats (some operations need full tree)\n\nLower priority - dotfiles repo is small, but valuable for other repos.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-29T08:45:27.04485-05:00","updated_at":"2025-12-29T08:45:27.04485-05:00","labels":["jj","performance","workspace"],"dependencies":[{"issue_id":".dotfiles-n5m","depends_on_id":".dotfiles-20n","type":"blocks","created_at":"2025-12-29T08:45:27.0554-05:00","created_by":"daemon","metadata":"{}"}]}
{"id":".dotfiles-ngc","title":"[Phase 5] Code cleanup and refactoring for maintainability","description":"Review and refactor the Notes \u0026 Capture System code for maintainability:\n\nPotential areas to address:\n- lib/notes.lua: Large file, may need splitting into focused modules\n- lib/interop/scratchpad.lua: Complex toggle logic, could simplify\n- config/nvim/after/plugin/notes.lua: Growing autocmd file, review organization\n- Consolidate duplicate patterns across capture workflows\n- Add documentation/comments where logic is non-obvious\n- Review error handling consistency\n- Consider extracting shared utilities\n\nGoal: Make the codebase approachable for future modifications without deep context.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-27T17:35:54.678127-05:00","updated_at":"2025-12-27T17:35:54.678127-05:00","labels":["hammerspoon","nvim","phase-5","polish"]}
{"id":".dotfiles-plf","title":"Native msgpack-rpc client for nvim","description":"Implement a native Swift msgpack-rpc client to communicate with nvim directly over Unix socket, replacing the current shell-out approach.\n\n## Goals\n- Persistent socket connection to nvim (no process spawn per command)\n- Full access to nvim's 400+ API functions\n- Bidirectional communication: Shade → Nvim AND Nvim → Shade\n- Async notifications for buffer changes, saves, etc.\n\n## Non-Goals (for now)\n- Full UI rendering (that's what VimR does)\n- Replacing ghostty terminal emulation\n\n## Architecture\n```\nShade ←→ Unix Socket ←→ Nvim\n         (msgpack-rpc)\n\n~/.local/state/shade/nvim.sock\n```\n\n## Key Capabilities Unlocked\n1. Call any nvim API function directly\n2. Get return values from nvim\n3. Subscribe to buffer events (nvim_buf_attach)\n4. Know when user saves, changes buffers, etc.\n5. Execute Lua code in nvim context\n6. Read/write buffer content programmatically\n\n## Dependencies\n- MessagePack.swift (a2/MessagePack.swift) or manual encoding\n- Existing Unix socket infrastructure in Shade\n\n## References\n- Nvim API: https://neovim.io/doc/user/api.html\n- Msgpack-RPC spec: https://github.com/msgpack-rpc/msgpack-rpc/blob/master/spec.md\n- VimR NvimApi: https://github.com/qvacua/vimr/tree/master/NvimApi","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-01-07T15:50:50.44624-05:00","updated_at":"2026-01-08T09:46:50.942627-05:00","closed_at":"2026-01-08T09:46:50.942627-05:00","close_reason":"Closed"}
{"id":".dotfiles-plf.1","title":"Add MessagePack.swift dependency via SPM","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T15:51:59.712486-05:00","updated_at":"2026-01-07T16:40:13.29822-05:00","closed_at":"2026-01-07T16:40:13.29822-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-plf.1","depends_on_id":".dotfiles-plf","type":"parent-child","created_at":"2026-01-07T15:51:59.713126-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-plf.10","title":"Add resilience to nvim crashes and connection failures","description":"Ensure Shade handles nvim connection issues gracefully:\n\n## Scenarios to Handle\n- Nvim crashes while Shade is connected\n- Nvim socket disappears (process killed)\n- Nvim hangs/becomes unresponsive\n- Connection timeout during startup\n- Socket exists but nvim not responding\n\n## Required Behavior\n- Detect disconnection and update state\n- Auto-reconnect when nvim restarts\n- Don't block UI on connection issues\n- Clear error messages in logs\n- Graceful degradation (panel still works, just no RPC)\n\n## Implementation\n- Monitor socket for EOF/errors\n- Implement heartbeat or keepalive\n- Add connection state observable for UI feedback\n- Timeout long-running requests\n\n## Acceptance Criteria\n- Kill nvim while connected: Shade detects and logs, no crash\n- Restart nvim: Shade reconnects on next command\n- Hang nvim: Request times out, error logged, UI responsive","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T09:35:03.730534-05:00","updated_at":"2026-01-08T09:40:34.247603-05:00","closed_at":"2026-01-08T09:40:34.247603-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-plf.10","depends_on_id":".dotfiles-plf","type":"parent-child","created_at":"2026-01-08T09:35:03.731274-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-plf.2","title":"Implement Unix socket connection manager for nvim","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T15:52:00.330496-05:00","updated_at":"2026-01-07T16:46:22.014746-05:00","closed_at":"2026-01-07T16:46:22.014746-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-plf.2","depends_on_id":".dotfiles-plf","type":"parent-child","created_at":"2026-01-07T15:52:00.333338-05:00","created_by":"seth","metadata":"{}"},{"issue_id":".dotfiles-plf.2","depends_on_id":".dotfiles-plf.1","type":"blocks","created_at":"2026-01-07T15:52:08.777686-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-plf.3","title":"Implement msgpack-rpc protocol encoder/decoder","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T15:52:00.94768-05:00","updated_at":"2026-01-07T16:52:10.134967-05:00","closed_at":"2026-01-07T16:52:10.134967-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-plf.3","depends_on_id":".dotfiles-plf","type":"parent-child","created_at":"2026-01-07T15:52:00.967753-05:00","created_by":"seth","metadata":"{}"},{"issue_id":".dotfiles-plf.3","depends_on_id":".dotfiles-plf.1","type":"blocks","created_at":"2026-01-07T15:52:08.847247-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-plf.4","title":"Implement request/response handling with msgid correlation","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T15:52:01.545189-05:00","updated_at":"2026-01-07T16:59:44.112631-05:00","closed_at":"2026-01-07T16:59:44.112631-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-plf.4","depends_on_id":".dotfiles-plf","type":"parent-child","created_at":"2026-01-07T15:52:01.54872-05:00","created_by":"seth","metadata":"{}"},{"issue_id":".dotfiles-plf.4","depends_on_id":".dotfiles-plf.2","type":"blocks","created_at":"2026-01-07T15:52:08.920575-05:00","created_by":"seth","metadata":"{}"},{"issue_id":".dotfiles-plf.4","depends_on_id":".dotfiles-plf.3","type":"blocks","created_at":"2026-01-07T15:52:08.989644-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-plf.5","title":"Implement async notification subscription system","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T15:52:02.144288-05:00","updated_at":"2026-01-08T08:43:42.287542-05:00","closed_at":"2026-01-08T08:43:42.287542-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-plf.5","depends_on_id":".dotfiles-plf","type":"parent-child","created_at":"2026-01-07T15:52:02.146889-05:00","created_by":"seth","metadata":"{}"},{"issue_id":".dotfiles-plf.5","depends_on_id":".dotfiles-plf.4","type":"blocks","created_at":"2026-01-07T15:52:09.889984-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-plf.6","title":"Create high-level NvimAPI wrapper with typed methods","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T15:52:02.642145-05:00","updated_at":"2026-01-08T08:56:17.359225-05:00","closed_at":"2026-01-08T08:56:17.359225-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-plf.6","depends_on_id":".dotfiles-plf","type":"parent-child","created_at":"2026-01-07T15:52:02.642888-05:00","created_by":"seth","metadata":"{}"},{"issue_id":".dotfiles-plf.6","depends_on_id":".dotfiles-plf.4","type":"blocks","created_at":"2026-01-07T15:52:09.951767-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-plf.7","title":"Replace shell-out IPC handlers with native msgpack-rpc calls","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-07T15:52:03.294333-05:00","updated_at":"2026-01-08T09:29:05.641202-05:00","closed_at":"2026-01-08T09:29:05.641202-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-plf.7","depends_on_id":".dotfiles-plf","type":"parent-child","created_at":"2026-01-07T15:52:03.297203-05:00","created_by":"seth","metadata":"{}"},{"issue_id":".dotfiles-plf.7","depends_on_id":".dotfiles-plf.6","type":"blocks","created_at":"2026-01-07T15:52:10.09871-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-plf.8","title":"Implement nvim_buf_attach for buffer change notifications","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-07T15:52:03.88837-05:00","updated_at":"2026-01-08T09:46:33.304065-05:00","closed_at":"2026-01-08T09:46:33.304065-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-plf.8","depends_on_id":".dotfiles-plf","type":"parent-child","created_at":"2026-01-07T15:52:03.891098-05:00","created_by":"seth","metadata":"{}"},{"issue_id":".dotfiles-plf.8","depends_on_id":".dotfiles-plf.5","type":"blocks","created_at":"2026-01-07T15:52:10.166752-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-plf.9","title":"Validate memory and CPU efficiency of native RPC implementation","description":"Profile and validate that the native msgpack-rpc implementation is efficient:\n\n## Memory\n- Verify no memory leaks in socket connection lifecycle\n- Check buffer handling in stream decoding doesn't accumulate\n- Ensure proper cleanup on disconnect\n\n## CPU\n- Verify idle CPU usage is minimal when connected but inactive\n- Check that read source doesn't spin\n- Profile tick timer interaction with socket I/O\n\n## Tools\n- Instruments (Allocations, Time Profiler, Leaks)\n- Activity Monitor baseline comparison vs old shell-out approach\n\n## Acceptance Criteria\n- No memory growth over extended use (hours)\n- Idle CPU \u003c 1% when panel hidden\n- No regression vs shell-out approach","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T09:34:54.125197-05:00","updated_at":"2026-01-08T09:40:34.183989-05:00","closed_at":"2026-01-08T09:40:34.183989-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-plf.9","depends_on_id":".dotfiles-plf","type":"parent-child","created_at":"2026-01-08T09:34:54.125901-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-pqf","title":"Fix beads persistence - remove global .beads gitignore","description":"The global gitignore at ~/.dotfiles/home/git/gitignore lines 128-129 ignores the entire .beads/ directory:\n\n```\n.beads\n**/.beads\n```\n\nThis breaks beads persistence because:\n1. issues.jsonl (source of truth) is never committed\n2. Issues exist only in local SQLite DB\n3. Issues lost on fresh clone, machine switch, or .beads/ deletion\n\nThe Fix (Option A - Recommended):\nRemove lines 128-129 from ~/.dotfiles/home/git/gitignore\n\nThe .beads/.gitignore inside each repo already handles ignoring SQLite files, daemon files, etc. Only issues.jsonl, interactions.jsonl, config.yaml, and README.md would be tracked.\n\nIntended workflow:\n- Create issue → SQLite updated → Auto-export to issues.jsonl → git commit/push\n- Pull from remote → Auto-import from issues.jsonl → SQLite updated\n\nAfter fix: Run `bd sync` in repos to ensure JSONL files are current, then commit them.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T15:57:12.790633-05:00","updated_at":"2026-01-07T16:00:26.013396-05:00","closed_at":"2026-01-07T16:00:26.013396-05:00","close_reason":"Fixed by removing .beads and **/.beads from global gitignore at home/git/gitignore. Rebuild applied the change. Each repo's .beads/.gitignore handles ignoring SQLite/daemon files while tracking issues.jsonl."}
{"id":".dotfiles-pvi","title":"[Phase 1] Implement persistent nvim session with --remote","description":"Change scratchpad from spawning new nvim per-launch to single persistent session. First launch: nvim --listen /tmp/notes.sock. Subsequent: nvim --server ... --remote \u003cfile\u003e.","status":"closed","priority":1,"issue_type":"task","estimated_minutes":60,"created_at":"2025-12-26T10:35:59.156162-05:00","updated_at":"2025-12-26T12:51:24.113062-05:00","closed_at":"2025-12-26T12:51:24.113062-05:00","close_reason":"Implemented persistent nvim session with --listen/--server/--remote. Ghostty macOS fix discovered (use open -na instead of direct CLI).","labels":["hammerspoon","nvim","phase-1"]}
{"id":".dotfiles-qa3","title":"Shade should show on primary screen, not focused screen","description":"Currently Shade uses NSScreen.main (the screen with keyboard focus) for positioning. It should use the primary screen instead.\n\nConsider adding CLI args to configure this behavior:\n- --screen primary (default)\n- --screen focused\n- --screen \u003cname\u003e","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-08T15:47:12.183229-05:00","updated_at":"2026-01-08T16:22:09.399822-05:00","closed_at":"2026-01-08T16:22:09.399822-05:00","close_reason":"Implemented --screen flag (primary|focused), defaults to primary"}
{"id":".dotfiles-qji","title":"Context Gathering in Shade (Sub-Epic)","description":"Port context gathering from Hammerspoon to Shade, making Shade self-sufficient for capturing context from the frontmost app.\n\n## Background\nCurrently Hammerspoon orchestrates context gathering via:\n- `bin/get-selection` Swift script (Accessibility API)\n- `lib/interop/context.lua` (app type detection, browser JXA)\n- `lib/interop/nvim.lua` (nvim RPC for buffer info)\n- `lib/interop/shade.lua` (writes context.json)\n\n## Goal\nShade gathers context itself when quick capture is triggered, eliminating Hammerspoon as middleman.\n\n## Architecture\n```\nContextGatherer.swift\n├── AXUIElement → selectedText, windowTitle, bundleID\n├── JXABridge → browser URLs, selections  \n├── NvimAPI (existing!) → buffer info, selection\n└── AppTypeDetector → browser/terminal/editor/other\n```\n\n## Messages.app Note\nUser will use standard copy/paste for selection - no exotic clipboard monitoring needed.\n\n## Research Notes (Jan 2026)\n\n### Related Libraries Evaluated\n1. **AXSwift** (tmandry, 397 stars) - Swift wrapper for AX APIs. Good Observer API but synchronous-only. Used by Swindler and Hammerspoon2.\n2. **Swindler** (tmandry, 732 stars) - Window management with in-memory state cache. Key insight: caches all window states so reads are instant.\n3. **Hammerspoon2** (cmsj, 45 stars) - Swift rewrite using AXSwift internally. Confirms our architecture approach is sound.\n4. **AXorcist** (steipete, 133 stars) - Modern query-based AX automation. Elegant declarative element finding pattern worth adopting later.\n\n### Key Insights\n- None of these libraries handle JXA/AppleScript - our Process+osascript approach is correct\n- Swindler's in-memory caching pattern could help with rapid captures\n- AXorcist's declarative query pattern (`findElement(matching: [.role(.button), .title(\"Back\")])`) is cleaner than tree walking\n- Our AccessibilityHelper is comparable to AXSwift's core functionality\n","status":"closed","priority":3,"issue_type":"epic","created_at":"2026-01-08T10:48:19.138249-05:00","updated_at":"2026-01-08T12:16:54.611701-05:00","closed_at":"2026-01-08T12:16:54.611701-05:00","close_reason":"Closed"}
{"id":".dotfiles-qji.1","title":"Port get-selection Swift logic into Shade","description":"Port the existing `bin/get-selection` Swift script functionality directly into Shade.\n\n## Approach\nBuild from scratch using native Swift Accessibility framework - NOT porting Lua or shelling out.\n\n## Swift APIs to Use\n- `AXUIElementCreateSystemWide()` - Get system-wide element\n- `kAXFocusedUIElementAttribute` - Get focused element  \n- `kAXSelectedTextAttribute` - Get selected text (clipboard-free!)\n- `kAXTitleAttribute` - Get window title\n- `kAXDocumentAttribute` - Get browser URL (AXDocument)\n- `NSWorkspace.shared.frontmostApplication` - Get frontmost app\n\n## Target\nCreate `Sources/ContextGatherer/AccessibilityHelper.swift`:\n```swift\nimport ApplicationServices\nimport AppKit\n\nprotocol AccessibilityProviding {\n    func getFocusedElement() -\u003e AXUIElement?\n    func getSelectedText(from element: AXUIElement) -\u003e String?\n    func getWindowTitle(from app: NSRunningApplication) -\u003e String?\n    func getDocumentURL(from element: AXUIElement) -\u003e String?\n}\n\nclass AccessibilityHelper: AccessibilityProviding {\n    static let shared = AccessibilityHelper()\n    // Implementation...\n}\n```\n\n## Testing Strategy\n- Protocol abstraction (`AccessibilityProviding`) for mocking in tests\n- Unit tests for any data transformation logic\n- Integration tests (skipped in CI) that verify against real apps\n\n## Notes\n- Shade already requires Accessibility permissions (for GlobalHotkey CGEvent tap)\n- No new permissions needed\n- This is the foundation for all other context gathering","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T10:48:32.690095-05:00","updated_at":"2026-01-08T11:00:27.104661-05:00","closed_at":"2026-01-08T11:00:27.104661-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-qji.1","depends_on_id":".dotfiles-qji","type":"parent-child","created_at":"2026-01-08T10:48:32.690826-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-qji.2","title":"Add app type detection","description":"Port Hammerspoon's app type detection logic to Swift.\n\n## Current Implementation\nIn `lib/interop/context.lua`:\n- Browser detection via bundle ID patterns + AXDocument URL check\n- Terminal detection via bundle ID patterns\n- Neovim detection via nvim socket existence\n- Editor detection via bundle ID patterns\n\n## Bundle ID Patterns to Port\n```lua\n-- Browsers\n'com.brave.Browser', 'com.google.Chrome', 'com.apple.Safari', \n'company.thebrowser.Browser' (Arc), 'org.mozilla.firefox'\n\n-- Terminals  \n'net.kovidgoyal.kitty', 'com.mitchellh.ghostty', 'com.apple.Terminal',\n'com.googlecode.iterm2'\n\n-- Editors\n'com.microsoft.VSCode', 'com.apple.dt.Xcode'\n```\n\n## Target\n```swift\nenum AppType: String, Codable {\n    case browser, terminal, neovim, editor, other\n}\n\nclass AppTypeDetector {\n    static func detect(bundleID: String, windowTitle: String?, axDocument: String?) -\u003e AppType\n}\n```\n\n## Depends On\n- .dotfiles-qji.1 (AccessibilityHelper for bundleID, axDocument)","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-08T10:48:42.542145-05:00","updated_at":"2026-01-08T11:09:57.684744-05:00","closed_at":"2026-01-08T11:09:57.684744-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-qji.2","depends_on_id":".dotfiles-qji","type":"parent-child","created_at":"2026-01-08T10:48:42.542862-05:00","created_by":"seth","metadata":"{}"},{"issue_id":".dotfiles-qji.2","depends_on_id":".dotfiles-qji.1","type":"blocks","created_at":"2026-01-08T10:49:43.666274-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-qji.3","title":"Add JXA bridge for browser context","description":"Add ability to execute JXA (JavaScript for Automation) to get browser-specific context.\n\n## Current Implementation\nIn `lib/interop/context.lua`, uses `hs.osascript.javascript()`:\n\n### Chrome-based browsers:\n```javascript\nvar browser = Application('Brave Browser');\nvar win = browser.windows[0];\nvar tab = win.activeTab;\nreturn {\n    url: tab.url(),\n    title: tab.title(),\n    selection: browser.execute(tab, {javascript: 'window.getSelection().toString()'})\n};\n```\n\n### Safari:\n```javascript\nvar safari = Application('Safari');\nvar tab = safari.windows[0].currentTab;\nvar selection = safari.doJavaScript('window.getSelection().toString()', {in: tab});\nreturn { url: tab.url(), title: tab.name(), selection: selection };\n```\n\n## Swift Implementation\nUse `Process` + `osascript -l JavaScript` with async termination handler.\nThis approach confirmed by research - no Swift library handles JXA natively.\n\n### Key Implementation Details\n- Scripts return JSON for easy parsing\n- Use `withCheckedContinuation` + `terminationHandler` for async\n- Timeout via Task group race pattern\n- Safari uses different API (`doJavaScript` vs `execute`)\n- Firefox has NO in-page JS execution (selection will be nil)\n\n## Target API\n```swift\npublic final class JXABridge: Sendable {\n    public static let shared = JXABridge()\n    \n    public func getBrowserContext(\n        for browserInfo: BrowserInfo,\n        timeout: Duration = .seconds(2)\n    ) async -\u003e BrowserContext?\n}\n\npublic struct BrowserContext: Sendable {\n    public let url: String?\n    public let title: String?\n    public let selection: String?\n}\n```\n\n## Supported Browsers\n- Brave Browser (all variants) - Chromium API\n- Google Chrome (+ Canary) - Chromium API\n- Safari - Safari-specific API\n- Arc - Chromium API (needs testing)\n- Firefox - Limited (no tab script execution)\n\n## Areas of Concern\n1. Process.waitUntilExit() blocks - use terminationHandler instead\n2. Safari requires Automation permission (System Prefs prompt)\n3. Arc browser may have unusual window/tab structure\n4. JSON parsing needs to handle special characters in URLs/text\n\n## Research Notes\n- AXSwift/Swindler/Hammerspoon2/AXorcist all focus on AX APIs, none do JXA\n- Hammerspoon uses hs.osascript.javascript() which shells to osascript internally\n- Process+osascript is the correct and only approach\n\n## Depends On\n- .dotfiles-qji.2 (AppTypeDetector to know when to call this)\n","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-08T10:48:59.660953-05:00","updated_at":"2026-01-08T11:35:14.347496-05:00","closed_at":"2026-01-08T11:35:14.347496-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-qji.3","depends_on_id":".dotfiles-qji","type":"parent-child","created_at":"2026-01-08T10:48:59.661657-05:00","created_by":"seth","metadata":"{}"},{"issue_id":".dotfiles-qji.3","depends_on_id":".dotfiles-qji.2","type":"blocks","created_at":"2026-01-08T10:49:43.727878-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-qji.4","title":"Integrate nvim context via existing NvimAPI","description":"Wire up existing NvimAPI to context gathering.\n\n## Current State\nShade already has full nvim RPC! From `NvimAPI.swift`:\n- `getCurrentBuffer()`, `getBufferLines()`\n- `getCurrentWindow()`, `getWindowCursor()`\n- `eval()`, `execLua()`\n\n## What Hammerspoon Currently Gathers\n```lua\nlocal luaCode = [[\n  local buf = vim.api.nvim_get_current_buf()\n  local win = vim.api.nvim_get_current_win()\n  local pos = vim.api.nvim_win_get_cursor(win)\n  return vim.json.encode({\n    path = vim.api.nvim_buf_get_name(buf),\n    name = vim.fn.expand('%:t'),\n    filetype = vim.bo[buf].filetype,\n    modified = vim.bo[buf].modified,\n    line = pos[1],\n    col = pos[2] + 1\n  })\n]]\n```\n\nAlso visual selection via '\u003c and '\u003e marks.\n\n## Target\nAdd to `ShadeNvim.swift`:\n```swift\nstruct NvimContext {\n    let filePath: String?\n    let fileName: String?\n    let filetype: String?\n    let modified: Bool\n    let line: Int\n    let col: Int\n    let selection: String?  // Visual selection if available\n}\n\nfunc getContext() async throws -\u003e NvimContext\n```\n\n## Notes\n- This is mostly wiring - the hard RPC work is done\n- Visual selection only works if in/just exited visual mode","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-08T10:49:09.078619-05:00","updated_at":"2026-01-08T11:19:53.883042-05:00","closed_at":"2026-01-08T11:19:53.883042-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-qji.4","depends_on_id":".dotfiles-qji","type":"parent-child","created_at":"2026-01-08T10:49:09.079359-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-qji.5","title":"Add language detection","description":"Port Hammerspoon's language detection patterns to Swift.\n\n## Current Implementation\nIn `lib/interop/context.lua`, `detectLanguage()` uses:\n\n### 1. URL patterns\n```lua\ngithub.com/.+%.(%w+)$ → file extension\nstackoverflow.com → from code fences in selection\n```\n\n### 2. Code fence detection\n```lua\n^```(%w+) → extract language from markdown code fence\n```\n\n### 3. Shebang detection\n```lua\n^#!.*/bin/(%w+) → bash, python, ruby, etc.\n^#!.*/env%s+(%w+) → env-style shebangs\n```\n\n### 4. Filetype mapping\n```lua\nlua → lua, py → python, js → javascript, ts → typescript,\nrb → ruby, rs → rust, go → go, swift → swift, etc.\n```\n\n## Target\n```swift\nclass LanguageDetector {\n    static func detect(\n        selection: String?,\n        url: String?,\n        filetype: String?,\n        filePath: String?\n    ) -\u003e String?\n}\n```\n\n## Notes\n- Returns nil if no language detected (better than guessing)\n- Used for syntax highlighting in capture notes","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-08T10:49:18.093121-05:00","updated_at":"2026-01-08T11:17:41.233958-05:00","closed_at":"2026-01-08T11:17:41.233958-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-qji.5","depends_on_id":".dotfiles-qji","type":"parent-child","created_at":"2026-01-08T10:49:18.093791-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-qji.6","title":"Wire up context gathering to capture triggers","description":"Connect all context gathering components and trigger on capture.\n\n## Current Flow\n1. Hammerspoon receives Hyper+Shift+N\n2. Hammerspoon calls `context.getContext()`\n3. Hammerspoon writes `~/.local/state/shade/context.json`\n4. Hammerspoon sends `io.shade.note.capture` to Shade\n5. Shade opens nvim with capture template\n6. obsidian.nvim reads context.json for template substitution\n\n## New Flow\n1. Hammerspoon receives Hyper+Shift+N (or Shade via .dotfiles-141.10)\n2. Hammerspoon sends `io.shade.note.capture` to Shade\n3. **Shade gathers context** via ContextGatherer\n4. Shade writes `~/.local/state/shade/context.json`\n5. Shade opens nvim with capture template\n6. obsidian.nvim reads context.json (unchanged)\n\n## Target\n```swift\nclass ContextGatherer {\n    static func gather() async -\u003e CaptureContext\n}\n\n// In ShadeAppDelegate, on io.shade.note.capture:\nlet context = await ContextGatherer.gather()\nStateDirectory.shared.writeContext(context)\n// Then open capture note as before\n```\n\n## Components Used\n- AccessibilityHelper (.dotfiles-qji.1)\n- AppTypeDetector (.dotfiles-qji.2)\n- JXABridge (.dotfiles-qji.3)\n- ShadeNvim.getContext() (.dotfiles-qji.4)\n- LanguageDetector (.dotfiles-qji.5)\n\n## Depends On\nAll previous tasks in this epic","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T10:49:35.05566-05:00","updated_at":"2026-01-08T12:16:10.901523-05:00","closed_at":"2026-01-08T12:16:10.901523-05:00","close_reason":"Closed","dependencies":[{"issue_id":".dotfiles-qji.6","depends_on_id":".dotfiles-qji","type":"parent-child","created_at":"2026-01-08T10:49:35.056279-05:00","created_by":"seth","metadata":"{}"},{"issue_id":".dotfiles-qji.6","depends_on_id":".dotfiles-qji.1","type":"blocks","created_at":"2026-01-08T10:49:43.793964-05:00","created_by":"seth","metadata":"{}"},{"issue_id":".dotfiles-qji.6","depends_on_id":".dotfiles-qji.2","type":"blocks","created_at":"2026-01-08T10:49:43.857391-05:00","created_by":"seth","metadata":"{}"},{"issue_id":".dotfiles-qji.6","depends_on_id":".dotfiles-qji.3","type":"blocks","created_at":"2026-01-08T10:49:43.921248-05:00","created_by":"seth","metadata":"{}"},{"issue_id":".dotfiles-qji.6","depends_on_id":".dotfiles-qji.4","type":"blocks","created_at":"2026-01-08T10:49:43.983508-05:00","created_by":"seth","metadata":"{}"},{"issue_id":".dotfiles-qji.6","depends_on_id":".dotfiles-qji.5","type":"blocks","created_at":"2026-01-08T10:49:44.04652-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-qji.7","title":"[Future] Declarative element query API inspired by AXorcist","description":"Refactor element finding to use a declarative query pattern instead of manual tree walking.\n\n## Inspiration\nAXorcist (steipete/AXorcist, 133 stars) uses an elegant declarative pattern:\n\n```swift\nlet query = QueryCommand(\n    appIdentifier: \"com.apple.Safari\",\n    locator: AXLocator(criteria: [\n        AXCriterion(attribute: \"AXRole\", value: \"AXButton\"),\n        AXCriterion(attribute: \"AXTitle\", value: \"Back\")\n    ])\n)\n```\n\n## Proposed API for Shade\n```swift\n// Instead of manual tree walking:\nlet element = try await ax.findElement(\n    in: \"com.brave.Browser\",\n    matching: [\n        .role(.textField),\n        .identifier(\"url\", matching: .contains)\n    ]\n)\n\n// With fuzzy matching options:\nenum MatchType {\n    case exact\n    case contains      // case-insensitive substring\n    case regex\n    case prefix\n    case suffix\n}\n```\n\n## Benefits\n- More readable code\n- Easier to express complex queries\n- Better for debugging (can log the query)\n- Matches how AI agents think about UI elements\n\n## Implementation Notes\n- Could wrap our existing AccessibilityHelper\n- Add ElementSearch class with visitor pattern\n- Support early termination on first match\n- Consider depth limits for performance\n\n## References\n- https://github.com/steipete/AXorcist\n- Their ElementSearch and AXElementMatcher classes\n","status":"open","priority":4,"issue_type":"task","created_at":"2026-01-08T11:31:21.344817-05:00","updated_at":"2026-01-08T11:31:21.344817-05:00","dependencies":[{"issue_id":".dotfiles-qji.7","depends_on_id":".dotfiles-qji","type":"parent-child","created_at":"2026-01-08T11:31:21.345654-05:00","created_by":"seth","metadata":"{}"}]}
{"id":".dotfiles-qur","title":"Cache require() calls in notification hot paths","description":"In watchers/notification.lua, require('lib.notifications.db') and require('lib.notifications.menubar') are called inside handleNotification() on every notification. Move to module-level cache to reduce overhead.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T18:02:30.371012-05:00","updated_at":"2025-12-27T18:02:30.371012-05:00","labels":["hammerspoon","performance"]}
{"id":".dotfiles-r2c","title":"Add slide-down animation when showing Shade panel","description":"Animate the panel when showing/hiding:\n\n**Show animation (only when panel was hidden):**\n- Slide down from top of screen to centered position\n- Duration: ~0.25s, easeOut timing\n- Should NOT animate if panel is already visible (e.g., switching from daily to capture)\n\n**Hide animation:**\n- Fade out (opacity 1.0 → 0.0)\n- Duration: ~0.15s\n\n**When already visible (e.g., resize for different note type):**\n- No animation, or subtle fade/crossfade\n- Instant resize and re-center\n\nKey: Track visibility state to know whether to animate or not.","status":"open","priority":3,"issue_type":"feature","created_at":"2026-01-08T16:25:16.798501-05:00","updated_at":"2026-01-08T16:25:41.768837-05:00"}
{"id":".dotfiles-rrs","title":"Create workspace template for new repos","description":"Create reusable templates/scripts for enabling workspace workflows in any repo:\n\nComponents:\n1. **Init script** - Set up workspace-aware jj config for a repo\n   - Creates .jj-workspaces/ tracking directory (gitignored)\n   - Adds recommended jj config\n   - Sets up bead integration hooks\n\n2. **CLAUDE.md template section** - Copy-paste workspace rules\n   - AI agent workspace protocols\n   - jj workspace command reference\n   - Conflict resolution procedures\n\n3. **justfile targets** - Common workspace operations\n   - just ws-new $NAME\n   - just ws-list\n   - just ws-cleanup $NAME\n\n4. **CI/CD templates** - For workspace-aware CI\n   - GitHub Actions with workspace isolation\n   - Test matrix across workspaces\n\nLocation: Could be a separate repo or template directory in dotfiles.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-29T08:45:24.49844-05:00","updated_at":"2025-12-29T08:45:24.49844-05:00","labels":["dx","jj","template","workspace"],"dependencies":[{"issue_id":".dotfiles-rrs","depends_on_id":".dotfiles-20n","type":"blocks","created_at":"2025-12-29T08:45:24.504954-05:00","created_by":"daemon","metadata":"{}"}]}
{"id":".dotfiles-s7p","title":"Shift key combinations not passed to terminal/PTY","description":"## Bug Description\n\nShift key combinations fail in Shade's embedded terminal:\n- Cannot type `:` (Shift+;) to enter nvim command mode\n- Cannot type `O` (Shift+o) for new line above\n- All shifted characters appear to fail (?, \", {, etc.)\n\n## Works correctly in:\n- Regular nvim in Ghostty\n- Regular nvim in Kitty\n- Previously worked when Shade used Kitty as the terminal backend\n\n## Likely Cause\n\nShade's key event handling is not properly passing the Shift modifier to the PTY/terminal emulator. The issue is likely in how NSEvent key events are translated and written to the PTY.\n\n## Investigation Areas\n\n1. **Key event handling** - Check how `keyDown` events are processed\n   - Look for NSEvent handling in view controllers or custom views\n   - Check if `event.modifierFlags` includes `.shift` and if it's being used\n\n2. **Character translation** - The shifted character should come from `event.characters`, not manual shift handling\n   - `event.characters` = the actual typed character (already shift-aware)\n   - `event.charactersIgnoringModifiers` = the base key\n\n3. **PTY write path** - Verify the correct characters are being written to the PTY fd\n   - Add debug logging to see what bytes are actually sent\n\n4. **SwiftTerm or terminal emulator** - If using a library, check its key handling\n\n## Files to Investigate\n\n- Any `*ViewController.swift` or `*View.swift` with `keyDown` overrides\n- Terminal/PTY setup code\n- Any custom `NSTextInputClient` implementations\n\n## Test Case\n\n1. Launch Shade\n2. Open nvim (or just a shell)\n3. Try typing `:` - should fail (types `;` instead or nothing)\n4. Try typing `O` - should fail (types `o` instead or nothing)\n5. Try typing `?` - should fail","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-07T16:08:58.073974-05:00","updated_at":"2026-01-07T16:30:05.7797-05:00","closed_at":"2026-01-07T16:30:05.7797-05:00","close_reason":"Closed"}
{"id":".dotfiles-sj6","title":"[Phase 5] Add smooth toggle animations","description":"Slide-in/slide-out animations for notes window toggle. Make configurable and disable-able.","status":"closed","priority":3,"issue_type":"task","estimated_minutes":45,"created_at":"2025-12-26T10:35:59.769766-05:00","updated_at":"2025-12-30T09:14:09.351941-05:00","closed_at":"2025-12-30T09:14:09.351941-05:00","close_reason":"Window positioning and smooth toggle complete: centered float with explicit Kitty dimensions, separate instances for daily/capture notes. Visor animations deferred to separate task (.dotfiles-1zf).","labels":["hammerspoon","phase-5","polish"],"dependencies":[{"issue_id":".dotfiles-sj6","depends_on_id":".dotfiles-ca8","type":"blocks","created_at":"2025-12-26T10:35:59.7707-05:00","created_by":"daemon","metadata":"{}"},{"issue_id":".dotfiles-sj6","depends_on_id":".dotfiles-ckn","type":"blocks","created_at":"2025-12-26T20:54:09.66359-05:00","created_by":"daemon","metadata":"{}"}]}
{"id":".dotfiles-t5t","title":"Enable jj auto-update-stale configuration","description":"Add 'snapshot.auto-update-stale = true' to jj user config to reduce friction with stale workspace messages.\n\nWhy: When one workspace modifies a commit that another workspace has checked out, the second workspace becomes 'stale'. Without auto-update-stale, agents/developers must manually run 'jj workspace update-stale' which breaks flow.\n\nImplementation:\n- Add config to existing jj user config in dotfiles\n- Consider making this part of a jj config module for portability","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T08:44:13.446747-05:00","updated_at":"2025-12-29T10:28:00.38624-05:00","closed_at":"2025-12-29T10:28:00.38624-05:00","close_reason":"Added snapshot.auto-update-stale = true to home/programs/jujutsu.nix","labels":["config","jj","workspace"],"dependencies":[{"issue_id":".dotfiles-t5t","depends_on_id":".dotfiles-20n","type":"blocks","created_at":"2025-12-29T08:44:13.457311-05:00","created_by":"daemon","metadata":"{}"}]}
{"id":".dotfiles-t7f","title":"Shade: Shift key combinations not passed to terminal","description":"Shift key combinations fail in Shade's embedded terminal:\n- Cannot type ':' (Shift+;) to enter nvim command mode\n- Cannot type 'O' (Shift+o) for new line above\n- All shifted characters appear to fail (?, \", {, etc.)\n\nWorks correctly in:\n- Regular nvim in Ghostty\n- Regular nvim in Kitty\n- Previously worked when Shade used Kitty\n\nLikely cause: Shade's key event handling is not properly passing the Shift modifier to the PTY/terminal emulator.\n\nThis is blocking testing of the obsidian.nvim migration (.dotfiles-8nx.5).","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-07T16:07:12.179601-05:00","updated_at":"2026-01-09T11:38:06.707348-05:00","closed_at":"2026-01-09T11:38:06.707348-05:00"}
{"id":".dotfiles-u2l","title":"MegaNote Hammerspoon integration","description":"Integrate MegaNote (libghostty Swift app) with Hammerspoon for quick capture workflow.\n\nDone:\n- Created meganote.lua module with distributed notification IPC\n- Added Hyper+Shift+N binding for context-aware capture\n- Socket cleanup wrapper for nvim --listen\n- Smart toggle/launch lifecycle\n\nMegaNote auto-terminates when nvim exits, Hammerspoon relaunches on next capture.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T16:22:41.192571-05:00","updated_at":"2025-12-30T12:45:39.92267-05:00","closed_at":"2025-12-30T12:45:39.92267-05:00","close_reason":"Hammerspoon integration complete - meganote.lua module created, bindings updated","labels":["agent","workspace"]}
{"id":".dotfiles-u39","title":"Split lib/notifications/notifier.lua into smaller modules","description":"notifier.lua (978 lines) handles canvas creation, positioning, animation, overlay, app watching. Split into: notifier-canvas.lua (canvas building), notifier-position.lua (positioning logic), notifier-animation.lua (slide animations).","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-27T18:03:12.453317-05:00","updated_at":"2025-12-27T18:03:12.453317-05:00","labels":["architecture","hammerspoon","refactor"]}
{"id":".dotfiles-uho","title":"Reduce _G global state pollution","description":"Replace 7+ _G.* variables in notifier.lua with module-local M._state table. Also consolidate _G.C, _G.U, _G.N, _G.I, etc. in init.lua. Makes debugging easier and prevents name collisions.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T18:02:31.21514-05:00","updated_at":"2026-01-02T10:15:29.308955-05:00","closed_at":"2026-01-02T10:15:29.308955-05:00","close_reason":"Removed duplicate _G.Hypers init from bindings.lua (hyper.lua is source of truth). Removed 28 lines of dead code from iphonesimulator context (unused local functions calling non-existent _G.info/dbg/note/success). Intentional REPL globals (_G.Spike, _G.CleanupConsole) left in place.","labels":["code-quality","hammerspoon"]}
{"id":".dotfiles-vd5","title":"[Phase 1] Create bin/get-selection Swift script","description":"Create Swift script using macOS Accessibility API to get selected text without clipboard. Query kAXSelectedTextAttribute, return JSON with selection, app info, window title, and URL for browsers.","status":"closed","priority":1,"issue_type":"task","estimated_minutes":120,"created_at":"2025-12-26T10:35:59.055742-05:00","updated_at":"2025-12-26T11:07:25.286524-05:00","closed_at":"2025-12-26T11:07:25.286524-05:00","close_reason":"Swift script created and tested - browser, terminal detection working","labels":["accessibility","phase-1","swift"]}
{"id":".dotfiles-wg1","title":"Add type annotations to public Hammerspoon functions","description":"Many functions lack ---@param and ---@return annotations, reducing LSP usefulness. Priority files: utils.lua (most functions unannotated), notification.lua, notifier.lua. Use LuaLS annotation format.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-27T18:02:59.468479-05:00","updated_at":"2025-12-27T18:02:59.468479-05:00","labels":["documentation","hammerspoon"]}
{"id":".dotfiles-wl6","title":"Hammerspoon Config Cleanup \u0026 Refactoring","description":"Epic for cleaning up and refactoring the Hammerspoon configuration. Addresses memory leaks, code smells, anti-patterns, and maintainability issues identified in deep analysis. See child tasks for specific issues.","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-27T18:03:21.503178-05:00","updated_at":"2025-12-27T18:03:21.503178-05:00","labels":["epic","hammerspoon","refactor"]}
{"id":".dotfiles-wpc","title":"[Phase 2] Integrate selection.lua with capture workflow","description":"Replace clipboard-based context detection with selection.lua. Update lib/notes.lua and bindings.lua HYPER+shift+N flow.","status":"closed","priority":1,"issue_type":"task","estimated_minutes":45,"created_at":"2025-12-26T10:35:59.358579-05:00","updated_at":"2025-12-26T13:00:28.849405-05:00","closed_at":"2025-12-26T13:00:28.849405-05:00","close_reason":"Integrated selection.lua with capture workflow. Replaced clipboard-based fallback with Accessibility API via Swift script. Fixed getSync() event loop blocking bug.","labels":["hammerspoon","phase-2"],"dependencies":[{"issue_id":".dotfiles-wpc","depends_on_id":".dotfiles-d8h","type":"blocks","created_at":"2025-12-26T10:35:59.359376-05:00","created_by":"daemon","metadata":"{}"},{"issue_id":".dotfiles-wpc","depends_on_id":".dotfiles-pvi","type":"blocks","created_at":"2025-12-26T10:35:59.359902-05:00","created_by":"daemon","metadata":"{}"}]}
{"id":".dotfiles-x2o","title":"Exhaustive audit of AI skills/rules for comprehensive coverage","description":"## Context\n\nThe nix skill was updated to include comprehensive package management guidance after discovering Claude knew 'not to use brew install' but didn't know what to do instead. The skill now has:\n- Decision tree for package installation\n- Step-by-step verification commands\n- Temporary vs permanent installation patterns\n- Flake structure verification\n\n## Task\n\nAudit ALL other skills to ensure they have similar comprehensive coverage:\n\n### Skills to Audit\n- [ ] `jj` - Does it cover ALL common workflows? Edge cases?\n- [ ] `cli-tools` - Does fd/rg guidance cover all search patterns?\n- [ ] `smart-ntfy` - Is routing logic complete?\n- [ ] `image-handling` - Are all constraints documented?\n- [ ] `web-debug` - Chrome DevTools + Playwright patterns?\n- [ ] `shade` - IPC/RPC debugging complete?\n- [ ] `hs` - Hammerspoon patterns comprehensive?\n- [ ] `nvim` - Plugin/LSP patterns complete?\n\n### For Each Skill, Verify\n1. **Decision trees** - Clear 'if X then Y' guidance\n2. **Step-by-step commands** - Copy-pasteable examples\n3. **Verification steps** - How to confirm it worked\n4. **Error handling** - What to do when things fail\n5. **Edge cases** - Unusual scenarios covered\n\n### Rules/memory.text Audit\n- Tool Selection Matrix complete?\n- Skill Loading Requirements has all triggers?\n- Showstopping Violations comprehensive?\n\n## Success Criteria\nEvery skill should be 'trustworthy' - Claude should be able to follow it without guessing or asking user for help on common scenarios.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T09:55:10.579417-05:00","updated_at":"2026-01-09T10:44:39.811126-05:00","closed_at":"2026-01-09T10:44:39.811126-05:00","close_reason":"Comprehensive audit complete. All 9 skills expanded with decision trees, troubleshooting, and self-discovery patterns. memory.text updated with agents/commands documentation. Total expansion: ~3000 lines across all skills."}
{"id":"shade-ahf","title":"MLX Swift Integration: Native on-device LLM inference","status":"open","priority":1,"issue_type":"epic","created_at":"2026-01-09T13:17:30.604909-05:00","created_by":"seth","updated_at":"2026-01-09T13:17:30.604909-05:00"}
